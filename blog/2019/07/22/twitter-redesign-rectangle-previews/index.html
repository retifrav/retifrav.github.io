<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Rectangle previews after recent Twitter redesign | Declaration of VAR</title>
    <link rel="canonical" href="https://decovar.dev/blog/2019/07/22/twitter-redesign-rectangle-previews/" />

    <meta name="generator" content="Hugo 0.100.2" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link href="/favicon.png" rel="icon">

    <meta name="author" content="retif" />
    <meta name="description" content="" />

    <link rel="alternate" type="application/rss+xml" href="/index.xml" title="Declaration of VAR" />

    <meta property="og:title" content="Rectangle previews after recent Twitter redesign" />
<meta property="og:description" content="Twitter got a new design, and that broke our pictures - these geniuses made rectangle previews for everything, even for square pictures.






    
        
    
    


Fortunately there is a kinda workaround - to post GIFs instead of images, because GIFs don&rsquo;t get rectangle previews. Retarded problems - retarded solutions." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://retifrav.github.io/blog/2019/07/22/twitter-redesign-rectangle-previews/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2019-07-22T11:16:14+02:00" />
<meta property="article:modified_time" content="2019-07-22T11:16:14+02:00" />



    <link rel="stylesheet" href="https://retifrav.github.io/css/main.min.c1a9d5434fbba746ef09ebde219b0064b5d4318930fc8463f51550f13a0e1b54.css" />
    <link rel="stylesheet" href="/css/default.css" />
    <link rel="stylesheet" href="/css/post.css" />
    <link rel="stylesheet" href="/css/page.css" />
    <link rel="stylesheet" href="/css/comments.css" />

    <script src="/js/mark.js"></script>

    
    
  </head>
  <body>
    <div id="body-hat">
      <div id="title-block">
        <h1 id="blog-title"><a href="/">Declaration of VAR</a></h1>
        <p>and some other stuff</p>
      </div>
    </div>
    <div style="background-color:orange; padding:4px 16px; font-size:0.8em; text-align:center; font-style:italic;">
        On 19.05.2021 the website was moved to
        <a href="https://decovar.dev/blog/2019/07/22/twitter-redesign-rectangle-previews/" style="color:black; font-weight:bold;">
            https://decovar.dev/</a>. This is just a mirror now.
    </div>
    <div id="body-flex">
      <main class="app-container">
        
  <div id="main-container">
    <article class="post">
      <header class="post-header">
        <h1 class ="post-title">Rectangle previews after recent Twitter redesign</h1>
        <div class="post-meta">
          <div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg> 2019-07-22 11:16:14 &#43;0200</div>
          <div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg> 3 min read</div>
        </div>
      </header>
      <div class="post-content">
        <p>Twitter <a href="https://blog.twitter.com/en_us/topics/product/2019/introducing-a-new-Twitter-dot-com.html">got a new design</a>, and that broke our pictures - these geniuses made <strong>rectangle</strong> previews for everything, even for <strong>square</strong> pictures.</p>






    <video autoplay="yes"  loop="yes"  class="video">
        <source src="/blog/2019/07/22/twitter-redesign-rectangle-previews/video/twitter-working-new-design.mp4" type="video/mp4">
    </video>
    


<p>Fortunately there is a kinda workaround - to post GIFs instead of images, because GIFs don&rsquo;t get rectangle previews. Retarded problems - retarded solutions.</p>
<nav id="TableOfContents">
  <ul>
    <li><a href="#what-exactly-got-broken">What exactly got broken</a></li>
    <li><a href="#a-workaround">A workaround</a></li>
    <li><a href="#other-notes">Other notes</a></li>
  </ul>
</nav>
<h1 id="what-exactly-got-broken">What exactly got broken</h1>
<p>Here&rsquo;s how it was before the redesign:</p>
<div style="border:1px solid #ccc;">


    <img class="image-post" loading="lazy" src="/blog/2019/07/22/twitter-redesign-rectangle-previews/images/twitter-old-post.png" alt="Twitter, old design">

</div>
<p>And here&rsquo;s how it looks now:</p>
<div style="border:1px solid #ccc;">


    <img class="image-post" loading="lazy" src="/blog/2019/07/22/twitter-redesign-rectangle-previews/images/twitter-new-post.png" alt="Twitter, new design">

</div>
<p>Thank you very fucking much, Twitter, that&rsquo;s exactly what we wanted.</p>
<p>Just how the fuck did they come up with this idea? Have they seen any posts with images at all? Did they really think everybody would be okay with these crippled previews? Is everybody okay?</p>
<h1 id="a-workaround">A workaround</h1>
<p>Good news is that videos and GIFs are not affected, so those can still be square. And that&rsquo;s what we&rsquo;ll do - make GIFs from images.</p>
<p>In <a href="/blog/2017/11/24/csharp-dotnet-core-publish-twitter/">our case</a> it is not so retarded, because we actually have 2 images: the main picture with the poster and general ratings and another picture with detailed ratings.</p>
<p>Here&rsquo;s how you can join images into a GIF using FFmpeg:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>ffmpeg <span style="color:#f92672">-</span>r <span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">-</span>i <span style="color:#e6db74">&#34;concat:image-main.png|image-detailed.png&#34;</span> out<span style="color:#f92672">.</span>gif <span style="color:#f92672">-</span>y</span></span></code></pre></div>
<p>Calling that from C# can look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">string</span> pathToGIF = <span style="color:#e6db74">&#34;/tmp/deutschland.gif&#34;</span>,
</span></span><span style="display:flex;"><span>       pathToImageMain = <span style="color:#e6db74">&#34;/var/www/protvshows/images/deutschland-main.png&#34;</span>,
</span></span><span style="display:flex;"><span>       pathToImageDetailed = <span style="color:#e6db74">&#34;/var/www/protvshows/images/deutschland-detailed.png&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> process = <span style="color:#66d9ef">new</span> Process()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    StartInfo = <span style="color:#66d9ef">new</span> ProcessStartInfo
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        FileName = <span style="color:#e6db74">&#34;ffmpeg&#34;</span>,
</span></span><span style="display:flex;"><span>        Arguments = <span style="color:#e6db74">$&#34;-r 1/5 -i \&#34;</span>concat:{pathToImageMain}|{pathToImageDetailed}<span style="color:#960050;background-color:#1e0010">\</span><span style="color:#e6db74">&#34; {pathToGIF} -y&#34;</span>,
</span></span><span style="display:flex;"><span>        RedirectStandardOutput = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>        RedirectStandardError = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>        UseShellExecute = <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>        CreateNoWindow = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>process.Start();
</span></span><span style="display:flex;"><span>process.WaitForExit();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// in case of FFmpeg you can&#39;t rely on process.StandardError.ReadToEnd()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// actually you can, but you don&#39;t want to</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (File.Exists(pathToGIF))
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// you can now upload the file to Twitter</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// also don&#39;t forget to delete it just in case</span></span></span></code></pre></div>
<p>It actually would be much better to upload videos instead of GIFs, but uploading a video to Twitter is a bit more complex than uploading a GIF (<em>which still counts as an image, hence no changes in the code</em>), and <strike>I didn&rsquo;t have time to deal with it. Maybe later.</strike> <a href="/blog/2019/08/22/twitter-chunked-upload-video/">that is</a> how it is done.</p>
<h1 id="other-notes">Other notes</h1>
<p>Along the way I discovered a different kind of issue.</p>
<p>According to Twitter documentation about <a href="https://developer.twitter.com/en/docs/basics/response-codes.html">response codes</a>, this is the format of returning errors:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;errors&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Sorry, that page does not exist&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;code&#34;</span>: <span style="color:#ae81ff">34</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>But here&rsquo;s what I actually got in response to one of my requests when I tried to upload a video as an image:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;request&#34;</span>: <span style="color:#e6db74">&#34;/1.1/media/upload.json&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;error&#34;</span>: <span style="color:#e6db74">&#34;media type unrecognized.&#34;</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Doesn&rsquo;t really match the documented structure, does it? Also this dot at the end is just cute.</p>
<p>I wanted to report it, but Twitter&rsquo;s <a href="https://twittercommunity.com">forum</a> doesn&rsquo;t let you to register there without authorizing it to use your Twitter account, so it can go fuck itself.</p>
      </div>
    </article>
    <div><div id="tags">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line>
</svg>
          <a class="tag" href="https://retifrav.github.io/tags/web/">web</a><a class="tag" href="https://retifrav.github.io/tags/fail/">fail</a><a class="tag" href="https://retifrav.github.io/tags/dotnet/">dotnet</a></div><hr class="comments-divider"/>
      <div id="comments">
      
          <script>
  var id =  25 ;

  if (id)
  {
    let url = "https://github.com/retifrav/retifrav.github.io/issues/".concat(id);
    let api_url = "https://api.github.com/repos/retifrav/retifrav.github.io/issues/".concat(id, "/comments");
    
    var commentsDiv = document.getElementById("comments");

    let xhr = new XMLHttpRequest();
    xhr.responseType = "json";
    xhr.open("GET", api_url);
    xhr.setRequestHeader("Accept", "application/vnd.github.v3.html+json");
    xhr.send();

    xhr.onload = function()
    {
      if (xhr.status != 200)
      {
        let errorText = document.createElement("p");
        errorText.innerHTML = "<i>Comments for this post yet are not opened yet (or you have GitHub scripts disabled).</i>";
        commentsDiv.appendChild(errorText);
      }
      else
      {
        let comments = xhr.response;

        let mainHeader = document.createElement("h2");
        mainHeader.innerHTML = "Comments: ".concat(comments.length);
        commentsDiv.appendChild(mainHeader);

        let issueLink = document.createElement("p");
        issueLink.innerHTML = "<i>You can leave a comment using this <a href='".concat(url, "'>GitHub issue</a>.</i>");
        commentsDiv.appendChild(issueLink);
        
        comments.forEach(function(comment)
        {
            let commentContent = document.createElement("div");
            commentContent.setAttribute('class', 'gh-comment')
            commentContent.innerHTML = "".concat(
                "<div class='gh-header'>",
                  "<img src='", comment.user.avatar_url, "' />",
                  "<div style='margin:auto 0;'>",
                    "<b><a class='gh-username' href='", comment.user.html_url, "'>", comment.user.login, "</a></b>",
                    " commented at <em>", new Date(comment.created_at), "</em>",
                  "</div>",
                "</div>",
                "<div class='gh-body'>",
                  comment.body_html,
                "</div>"
            );
            commentsDiv.appendChild(commentContent);
        });
      }
    };

    xhr.onerror = function()
    {
      let errorText = document.createElement("p");
      errorText.innerHTML = "<i>Some error loading comments.</i>";
      commentsDiv.appendChild(errorText);
    };
  }
</script>

      
      </div>
    </div>
  </div>

        <div id="footer">
          <div>
              2014-2022,
              <a href="/about/">retif</a>
          </div>
          <div><a href="/about/#licenses">CC BY-SA 4.0 / GPLv3</a></div>
        </div>
      </main>
      <div class="app-header">
        <a id="avatar" href="/about"><img class="app-header-avatar" src="/images/avatar.png" /></a>
        <iframe src="https://github.com/sponsors/retifrav/button"
            height="35" style="border:0;"
            title="You can sponsor me">
        </iframe>
        
        <div class="sidebar-section">
            <input id="search-query" placeholder="Search in titles and summaries" />
        </div>
        <div id="search-results" style="display:none;"></div>
        <div id="sidebars">
            <div id="telegram" class="sidebar-section">
              <script async src="https://telegram.org/js/telegram-widget.js?5"
                  data-telegram-post="decovar/306" data-width="100%" data-userpic="false">
              </script>
            </div>
            <div class="sidebar-section">
              <h3>Feeds</h3>
              <a href="/index.xml" title="Subscribe to RSS"><img src="/images/rss.png" width="50px"></a>
              <a style="margin-left: 5px;" href="https://t.me/decovar" title="Telegram channel"><img src="/images/telegram.png" width="50px"></a>
            </div>
            <div class="sidebar-section">
                <h3>Stuff</h3>
                <ul class="sidebar-list">
                    <li><a href="/stuff/kakoi-jvotne-vi-kysaiti/index.html">КАКОИ ЖВОТНЕ ВЫ КУСАИТИ?</a></li>
                </ul>
            </div>
            <div class="sidebar-section">
                <h3>Top</h3>
                <ul class="sidebar-list">
                    <li><a href="/top/cider">Cider</a></li>
                </ul>
            </div>
            <div id="social-networks" class="sidebar-section">
              <h3>Social networks</h3>
              <div style="font-family:Courier New;">
                  Zuck: <i>Yeah so if you ever need info about anyone at Harvard</i><br/>
                  Zuck: <i>Just ask</i><br/>
                  Zuck: <i>I have over 4,000 emails, pictures, addresses, SNS</i><br/>
                  smb: <i>What? How'd you manage that one?</i><br/>
                  Zuck: <i>People just submitted it.</i><br/>
                  Zuck: <i>I don't know why.</i><br/>
                  Zuck: <i>They "trust me"</i><br/>
                  Zuck: <i>Dumb fucks</i>
              </div>
            </div>
            <div class="sidebar-section">
              <h3>Tags</h3>
              <ul style="list-style-type:none; padding:0; margin:0;">
                  
                  <li><a href="/tags/web">web (64)</a></li>
                  
                  <li><a href="/tags/fail">fail (39)</a></li>
                  
                  <li><a href="/tags/dotnet">dotnet (36)</a></li>
                  
                  <li><a href="/tags/qt">qt (32)</a></li>
                  
                  <li><a href="/tags/review">review (27)</a></li>
                  
                  <li><a href="/tags/devops">devops (24)</a></li>
                  
                  <li><a href="/tags/linux">linux (24)</a></li>
                  
                  <li><a href="/tags/macos">macos (23)</a></li>
                  
                  <li><a href="/tags/windows">windows (18)</a></li>
                  
                  <li><a href="/tags/mestuff">mestuff (16)</a></li>
                  
                  <li><a href="/tags/movies">movies (15)</a></li>
                  
                  <li><a href="/tags/tractor">tractor (14)</a></li>
                  
                  <li><a href="/tags/norway">norway (13)</a></li>
                  
                  <li><a href="/tags/irl">irl (12)</a></li>
                  
                  <li><a href="/tags/telegram">telegram (12)</a></li>
                  
                  <li><a href="/tags/python">python (11)</a></li>
                  
                  <li><a href="/tags/soft">soft (10)</a></li>
                  
                  <li><a href="/tags/travel">travel (10)</a></li>
                  
                  <li><a href="/tags/applescript">applescript (9)</a></li>
                  
                  <li><a href="/tags/embedded">embedded (9)</a></li>
                  
                  <li><a href="/tags/piracy">piracy (9)</a></li>
                  
                  <li><a href="/tags/octopress">octopress (8)</a></li>
                  
                  <li><a href="/tags/banks">banks (7)</a></li>
                  
                  <li><a href="/tags/cmake">cmake (7)</a></li>
                  
                  <li><a href="/tags/cpp">cpp (7)</a></li>
                  
                  <li><a href="/tags/ios">ios (7)</a></li>
                  
                  <li><a href="/tags/apple">apple (6)</a></li>
                  
                  <li><a href="/tags/games">games (6)</a></li>
                  
                  <li><a href="/tags/javascript">javascript (6)</a></li>
                  
                  <li><a href="/tags/photo">photo (6)</a></li>
                  
                  <li><a href="/tags/sql">sql (6)</a></li>
                  
                  <li><a href="/tags/hugo">hugo (4)</a></li>
                  
                  <li><a href="/tags/russia">russia (4)</a></li>
                  
                  <li><a href="/tags/wordpress">wordpress (4)</a></li>
                  
                  <li><a href="/tags/android">android (3)</a></li>
                  
                  <li><a href="/tags/tv">tv (3)</a></li>
                  
                  <li><a href="/tags/usa">usa (3)</a></li>
                  
                  <li><a href="/tags/azure">azure (2)</a></li>
                  
                  <li><a href="/tags/tvos">tvos (2)</a></li>
                  
                  <li><a href="/tags/unsolved">unsolved (2)</a></li>
                  
                  <li><a href="/tags/books">books (1)</a></li>
                  
                  <li><a href="/tags/ffmpeg">ffmpeg (1)</a></li>
                  
                  <li><a href="/tags/ldap">ldap (1)</a></li>
                  
                  <li><a href="/tags/music">music (1)</a></li>
                  
                  <li><a href="/tags/privacy">privacy (1)</a></li>
                  
                  <li><a href="/tags/science">science (1)</a></li>
                  
                  <li><a href="/tags/vr">vr (1)</a></li>
                  
              </ul>
            </div>
        </div>
      </header>
    </div>

    <script src="/js/search.js"></script>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-53340325-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag("js", new Date());
      gtag("config", "UA-53340325-1");
    </script>

    
    
  </body>
</html>
