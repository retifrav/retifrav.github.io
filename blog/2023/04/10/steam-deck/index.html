<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Steam Deck | Declaration of VAR</title>
    <link rel="canonical" href="https://decovar.dev/blog/2023/04/10/steam-deck/" />

    <meta name="generator" content="Hugo 0.115.4" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link href="/favicon.png" rel="icon">

    <meta name="author" content="retif" />
    <meta name="description" content="Steam Deck - a happiness that can be bought with money. Windows-only games and applications magically running in a GNU/Linux environment. A handheld gaming device with fantastic controls and unprecedented freedom of doing whatever you&#39;d like." />

    <link rel="alternate" type="application/rss+xml" href="/index.xml" title="Declaration of VAR" />

    <meta property="og:title" content="Steam Deck" />
<meta property="og:description" content="Steam Deck - a happiness that can be bought with money. Windows-only games and applications magically running in a GNU/Linux environment. A handheld gaming device with fantastic controls and unprecedented freedom of doing whatever you&#39;d like." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://retifrav.github.io/blog/2023/04/10/steam-deck/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2023-04-10T14:24:31+02:00" />
<meta property="article:modified_time" content="2023-04-10T14:24:31+02:00" />


    <link rel="stylesheet" href="https://retifrav.github.io/css/main.min.c1a9d5434fbba746ef09ebde219b0064b5d4318930fc8463f51550f13a0e1b54.css" />
    <link rel="stylesheet" href="/css/default.css" />
    <link rel="stylesheet" href="/css/post.css" />
    <link rel="stylesheet" href="/css/page.css" />
    <link rel="stylesheet" href="/css/comments.css" />

    <script src="/js/mark.js"></script>

    
    
  </head>
  <body>
    <div id="body-hat">
      <div id="title-block">
        <h1 id="blog-title"><a href="/">Declaration of VAR</a></h1>
        <p>and some other stuff</p>
      </div>
    </div>
    <div style="background-color:orange; padding:4px 16px; font-size:0.8em; text-align:center; font-style:italic;">
        On 19.05.2021 the website was moved to
        <a href="https://decovar.dev/blog/2023/04/10/steam-deck/" style="color:black; font-weight:bold;">
            https://decovar.dev/</a>. This is just a mirror now.
    </div>
    <div id="body-flex">
      <main class="app-container">
        
  <div id="main-container">
    <article class="post">
      <header class="post-header">
        <h1 class ="post-title">Steam Deck</h1>
        <div class="post-meta">
          <div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg> 2023-04-10 14:24:31 &#43;0200</div>
          <div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg> 113 min read</div>
        </div>
      </header>
      <div class="post-content">
        <p>If you play games (<em>actual games, not <a href="https://files.decovar.dev/public/blog/steam-deck/drake-no-games.mp4">press-X-to-win blurry movies</a></em>), then undoubtly you have heard about <a href="https://steamdeck.com/">Steam Deck</a>. If you haven&rsquo;t, then you can probably just go watch some more of your favorite titles on PS/Xbox/Switch/whatsthename instead of reading this wall of text.</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-deck-space-rangers-screenshot.jpg" alt="Steam Deck, Космические рейнджеры">

<p>Yes, I&rsquo;ve got my very own Steam Deck too. And as many have already said, it does exceed all the expectations (<em>and then some</em>).</p>
<nav id="TableOfContents">
  <ul>
    <li><a href="#how-did-i-get-it">How did I get it</a>
      <ul>
        <li><a href="#purchasing-steam-deck-in-us-store-from-outside-us">Purchasing Steam Deck in US store from outside US</a></li>
        <li><a href="#ordering-and-waiting-for-delivery">Ordering and waiting for delivery</a>
          <ul>
            <li><a href="#delivery-chronology">Delivery chronology</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#differences-between-models">Differences between models</a>
      <ul>
        <li><a href="#about-the-storage">About the storage</a>
          <ul>
            <li><a href="#x2-or-x4">x2 or x4</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#how-does-it-look">How does it look</a></li>
    <li><a href="#hardware">Hardware</a>
      <ul>
        <li><a href="#controls">Controls</a>
          <ul>
            <li><a href="#trackpads">Trackpads</a></li>
            <li><a href="#gyroscope">Gyroscope</a></li>
          </ul>
        </li>
        <li><a href="#speakers-and-sound">Speakers and sound</a></li>
        <li><a href="#screen">Screen</a>
          <ul>
            <li><a href="#mouse-and-keyboard-input">Mouse and keyboard input</a></li>
          </ul>
        </li>
        <li><a href="#battery">Battery</a>
          <ul>
            <li><a href="#charging">Charging</a></li>
            <li><a href="#using-a-powerbank">Using a powerbank</a></li>
            <li><a href="#battery-storage-mode">Battery storage mode</a></li>
          </ul>
        </li>
        <li><a href="#thermals-and-cooling">Thermals and cooling</a></li>
      </ul>
    </li>
    <li><a href="#steamos">SteamOS</a>
      <ul>
        <li><a href="#about-the-os">About the OS</a></li>
        <li><a href="#desktopgaming-mode">Desktop/Gaming mode</a></li>
        <li><a href="#proton">Proton</a>
          <ul>
            <li><a href="#how-to-run-an-application-with-proton">How to run an application with Proton</a></li>
          </ul>
        </li>
        <li><a href="#filesystem">Filesystem</a>
          <ul>
            <li><a href="#proton-prefixes">Proton prefixes</a></li>
            <li><a href="#screenshots">Screenshots</a></li>
            <li><a href="#controller-layouts">Controller layouts</a></li>
            <li><a href="#backup-script">Backup script</a></li>
          </ul>
        </li>
        <li><a href="#shader-cache">Shader cache</a>
          <ul>
            <li><a href="#pre-caching-updates">Pre-caching updates</a></li>
          </ul>
        </li>
        <li><a href="#sleep-suspend-and-resume">Sleep, suspend and resume</a></li>
        <li><a href="#ssh-access">SSH access</a></li>
        <li><a href="#monitoring-the-temperature">Monitoring the temperature</a></li>
        <li><a href="#disabling-file-indexer">Disabling file indexer</a></li>
        <li><a href="#firewall">Firewall</a>
          <ul>
            <li><a href="#nextdns">NextDNS</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#steam-input">Steam Input</a>
      <ul>
        <li><a href="#virtual-menus">Virtual menus</a></li>
        <li><a href="#action-sets">Action Sets</a></li>
        <li><a href="#community-layouts">Community layouts</a></li>
      </ul>
    </li>
    <li><a href="#games-from-steam-store">Games from Steam store</a>
      <ul>
        <li><a href="#aperture-desk-job">Aperture Desk Job</a></li>
        <li><a href="#witcher-3">Witcher 3</a></li>
        <li><a href="#black-mesa">Black Mesa</a></li>
        <li><a href="#doom-3-bfg">DooM 3 BFG</a></li>
        <li><a href="#civilization-v">Civilization V</a></li>
        <li><a href="#space-rangers">Space Rangers</a></li>
      </ul>
    </li>
    <li><a href="#installing-non-steam-stuff">Installing non-Steam stuff</a>
      <ul>
        <li><a href="#applications">Applications</a>
          <ul>
            <li><a href="#flatpak">Flatpak</a>
              <ul>
                <li><a href="#ungoogled-chromium">Ungoogled Chromium</a></li>
                <li><a href="#kodi">Kodi</a></li>
                <li><a href="#mpv">mpv</a></li>
                <li><a href="#obs-studio">OBS Studio</a></li>
              </ul>
            </li>
            <li><a href="#homebrew">Homebrew</a></li>
          </ul>
        </li>
        <li><a href="#games">Games</a>
          <ul>
            <li><a href="#civilization-vi">Civilization VI</a>
              <ul>
                <li><a href="#posters-backgrounds-logos-icons">Posters, backgrounds, logos, icons</a></li>
                <li><a href="#community-controller-layout">Community controller layout</a></li>
                <li><a href="#removing-a-non-steam-game">Removing a non-Steam game</a></li>
              </ul>
            </li>
            <li><a href="#batman-arkham-knight">Batman Arkham Knight</a>
              <ul>
                <li><a href="#figuring-out-why-a-game-does-not-launch">Figuring out why a game does not launch</a></li>
              </ul>
            </li>
            <li><a href="#heroes-of-might-and-magic-3">Heroes of Might and Magic 3</a></li>
            <li><a href="#diablo-ii-resurrected">Diablo II Resurrected</a>
              <ul>
                <li><a href="#savegame-path-change-after-proton-update">Savegame path change after Proton update</a></li>
              </ul>
            </li>
            <li><a href="#other-games">Other games</a>
              <ul>
                <li><a href="#emulators">Emulators</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#problems">Problems</a>
      <ul>
        <li><a href="#gui-issues">GUI issues</a>
          <ul>
            <li><a href="#crash-on-keyboard-shortcut">Crash on keyboard shortcut</a></li>
          </ul>
        </li>
        <li><a href="#pin-lock-screen-doesnt-appear-immediately">Pin-lock screen doesn&rsquo;t appear immediately</a></li>
        <li><a href="#sd-card-formatting">SD card formatting</a></li>
        <li><a href="#moving-a-game-tofrom-sd-card">Moving a game to/from SD card</a>
          <ul>
            <li><a href="#losing-savegames">Losing savegames</a></li>
            <li><a href="#content-file-locked">Content file locked</a></li>
          </ul>
        </li>
        <li><a href="#on-screen-keyboard-issues">On-screen keyboard issues</a></li>
        <li><a href="#content-servers-unreachable">Content servers unreachable</a></li>
        <li><a href="#charging-issues">Charging issues</a>
          <ul>
            <li><a href="#slow-charger">Slow charger</a></li>
            <li><a href="#doesnt-start-charging">Doesn&rsquo;t start charging</a></li>
          </ul>
        </li>
        <li><a href="#low-powered-200400-mhz-mode">Low-powered 200/400 MHz mode</a></li>
        <li><a href="#things-you-can-do-to-cause-more-problems">Things you can do to cause more problems</a></li>
      </ul>
    </li>
    <li><a href="#steam-dock">Steam Dock</a>
      <ul>
        <li><a href="#connecting-to-external-display-or-tv">Connecting to external display or TV</a></li>
      </ul>
    </li>
    <li><a href="#showcasing-steam-deck-on-your-steam-profile">Showcasing Steam Deck on your Steam profile</a></li>
    <li><a href="#overall">Overall</a></li>
  </ul>
</nav>
<h1 id="how-did-i-get-it">How did I get it</h1>
<p>This entire section is unlikely to be of interest for many, so I&rsquo;d probably recommend to skip it. It is here mostly for myself to document the torture of waiting and overcoming &ldquo;logistics&rdquo; troubles.</p>
<p>Ever since I had learned about Steam Deck existence somewhere in summer of 2021, I&rsquo;ve been dreaming about getting it. <a href="https://valvesoftware.com/">Valve</a> has quite a reputation in my eyes, and so even I knew almost nothing about Steam Deck, except for its advertisement, I immediately believed that this is going to be a great device for gaming and was willing to pay for it right on the spot.</p>
<p>But that wasn&rsquo;t quite possible to do when they began selling it on the 25th of February 2022 (<em>the next day after Russia started an actual war against Ukraine - a horribly coincidencial timing, it was like news from a different universe</em>), because of two reasons:</p>
<ol>
<li>You couldn&rsquo;t just buy it, as stock units availability was limited, and there was already a queue of several months of reservations;</li>
<li>I live in Norway, and Steam Deck still <a href="https://help.steampowered.com/en/faqs/view/339C-BC5C-3D89-53D9">isn&rsquo;t available</a> for purchase there (<em>and probably never will be, just like <a href="https://store.steampowered.com/valveindex">Valve Index</a></em>).</li>
</ol>
<p>Nevertheless, I was waiting and waiting for something to change, and eventually something did: in October 2022 Steam Deck became available for purchasing <a href="https://store.steampowered.com/news/app/1675180/view/3283711072069270523">without reservations</a>. That triggered me to finally do something instead of just waiting for Valve to start selling it in Norway, and since I have friends in US, I&rsquo;ve come up with an idea to order it to their home address, and then pick it up on my next visit to US, which I already had planned in the next months. Worst case, they could&rsquo;ve sent it to me with DHL or something. And of course, if I had friends in any of the EU countries (<em>Sweden would be the best in this case</em>), it would&rsquo;ve been even easier/faster.</p>
<p>Another option was to use some &ldquo;proxy&rdquo; forward-delivery service, which provides a delivery address in US and forwards the package to you into another country, and if I didn&rsquo;t have friends in US, I would probably use one of those.</p>
<h2 id="purchasing-steam-deck-in-us-store-from-outside-us">Purchasing Steam Deck in US store from outside US</h2>
<p>So, how does one purchase something in Steam&rsquo;s US store, when one&rsquo;s account belongs to a different region (<em>Norway, in my case</em>)? Well, one just does not. Your account needs to belong to US region, and you need to have a US bank card, which is a show-stopper for many (<em>but fortunately I <a href="/blog/2016/04/05/wells-fargo-account/">did have one</a></em>).</p>
<p>Okay then, I decided to create a new Steam account in US region and purchase Steam Deck from it. My first attempt was without VPN, and surely enough Steam auto-detected my country to be Norway. There is a dropdown list with countries, where you can select US, but in the end you&rsquo;ll still get Norway, which you won&rsquo;t be able to change. Someone might say, but you can change the region to US, just purchase something in US dollars, and I know about that, but actually this is a kinda Catch-22 situation, because when I was trying to add my US bank card, it was redirecting me to a page saying that to change the region I need to purchase something using the currency of that region, and when I was trying to add my US bank card in order to do so, it was redirecting me to a page saying that&hellip; and so on. So that attempt failed.</p>
<p>Next attempt was to create an account through VPN which was set to use a US server, but Steam gave me an error right away, saying that I need to disconnect from VPN and try again, so they do detect VPNs. Just in case I also tried to create a virtual machine in Azure in US region and <a href="https://github.com/retifrav/scraps/blob/master/_linux/IKEv2-VPN-StrongSwan/macos-ios-windows-certificate.md">set-up a VPN</a> connection through it, hoping that self-made server most certainly isn&rsquo;t in their list of known VPN&rsquo;s, but I still got an error message about detected VPN, so apparently they are blocking entire Azure (<em>and probably also AWS, Digital Ocean and others</em>) IP range too.</p>
<p>It is very unlikely that Valve can detect all possible VPNs on the planet, so you may find a VPN that hasn&rsquo;t been &ldquo;blown&rdquo; yet, but I just gave up at that point.</p>
<p>And then I realized that I don&rsquo;t have to create a new account, I can just &ldquo;migrate&rdquo; my current account! It is quite hilarious that I haven&rsquo;t thought about this right from the beginning, but actually I&rsquo;ve read somewhere in Steam terms and conditions that it is not allowed to move your account to a region where you are not really living, so probably one might want to think about this before risking one&rsquo;s main Steam account.</p>
<p>Anyway, to change the region in an existing Steam account you need to buy something using the currency of that region. I tried to do that by purchasing <a href="https://store.steampowered.com/app/539720/Razortron_2000/">Razortron 2000</a> (<em>because it costed 0.28 USD at the moment</em>) using my US bank card, but it still didn&rsquo;t let me change the country from Norway. I almost despaired, but then I tried to do the same via VPN, and for this operation it didn&rsquo;t give me the VPN error! Fucking finally, after that the region of my Steam account changed to US.</p>
<p>Apparently, I could&rsquo;ve tried the same on my very first attempt with a freshly created account, and probably then I could&rsquo;ve broken the cursed circle of Catch-22 redirections. The only difference would be that for the absolutely new accounts Steam seems to set a minimum threshold of 5.00 USD purchase. Anyway, luckily I don&rsquo;t need to test that theory.</p>
<p>It is allowed to change the region once per three months, and I will probably return my account back to Norway after that cooldown. I would like to keep it in US, but I&rsquo;m a little scared of getting a ban for not actually living in US (<em>if that is really a thing</em>). I am also somewhat concerned that performing such region-switching trickery to purchase Steam Deck was already against Valve&rsquo;s rules/ToS.</p>
<p>Speaking about terms and conditions, one thing for sure - I won&rsquo;t be able to return my Steam Deck for repairment/replacement, should anything happen to it, at least not directly I won&rsquo;t.</p>
<h2 id="ordering-and-waiting-for-delivery">Ordering and waiting for delivery</h2>
<p>I decided to buy Steam Deck 512 GB model (<em>more on that <a href="#differences-between-models">later</a></em>) and also <a href="#steam-dock">Steam Dock</a>. Added both to the shopping card, total amount with taxes was 813 USD:</p>
<ul>
<li>subtotal: 738.00 USD</li>
<li>tax: 75.64 USD</li>
<li>total: 813.64 USD</li>
</ul>
<p>Clicked on payment, but it didn&rsquo;t succeed, because my US bank (<em>Wells Fargo</em>) blocked the operation. That got me worried for a minute, but it turned out to be just a security measure, probably because I&rsquo;ve never used this card for buying anything on Steam, and to lift the restriction I only needed to call the bank and approve the operation through a robot (<em>didn&rsquo;t even need to talk to an actual person</em>). And some minutes later I also got an automatic e-mail from the bank describing the situation and suggesting to approve the operation by merely clicking on the provided link, but I&rsquo;ve already settled this via the phone by then.</p>
<p>Since the first operation was already blocked, Steam wasn&rsquo;t letting me to proceed with the payment, so I had to click on editing the payment method, save it without changes and try again. This time the payment succeeded, and I got a confirmation e-mail:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/shipment/order-confirmation.png" alt="Steam Deck order confirmation">

<p>After that if you&rsquo;d like to check your order status you can do it in your Steam account <a href="https://store.steampowered.com/account/history/">purchase history</a>: there will be a link called &ldquo;<em>View Shipment Details</em>&rdquo; in the table row with your Steam Deck order.</p>
<h3 id="delivery-chronology">Delivery chronology</h3>
<ul>
<li>2022-11-23 (<em>0 days</em>):
<ul>
<li>placed the order;</li>
</ul>
</li>
<li>2022-11-24 (<em>1 day</em>):
<ul>
<li>status <a href="./images/shipment/shipment-details.png">changed</a> from <code>Payment Processed</code> to <code>Packed</code>;</li>
</ul>
</li>
<li>2022-11-25 (<em>2 days</em>):
<ul>
<li>status changed to <code>Shipped</code> (<em>probably it was on <code>Picked up</code> for some time too, but I haven&rsquo;t noticed</em>);</li>
<li>got an <a href="./images/shipment/order-tracking-links.png">e-mail</a> with tracking;</li>
</ul>
</li>
<li>2022-11-26 (<em>3 days</em>):
<ul>
<li>FedEx tracking says that both packages &ldquo;<em>left FedEx origin facility CAROL STREAM, IL</em>&rdquo;, also both <a href="./images/shipment/fedex-1-shipment-registration.png">are showing</a> in the application;</li>
<li>and Steam Deck <a href="./images/shipment/fedex-3-deck-in-transit.png">turned out</a> to be <code>In Transit</code>, apparently already from one of the previous days;</li>
</ul>
</li>
<li>2022-11-29 (<em>6 days</em>):
<ul>
<li>Steam Dock first <a href="./images/shipment/fedex-2-dock-out-for-delivery.png">changed</a> to <code>In Transit</code>, then to <code>Out For Delivery</code> and then later that day it was <a href="./images/shipment/fedex-4-dock-delivered.png">delivered</a>. Delivery time window was set to 09:05-11:40, but in fact it was delivered at 12:31, and push notification arrived in the application another 30 minutes later. By the way, just look at this atrocious <a href="./images/shipment/fedex-5-dock-delivery-photo.png">delivery photo</a>. Here&rsquo;s a <a href="./images/shipment/fedex-6-dock-delivery-log.png">full log</a> with the weight (<em>0.91 kg</em>);</li>
<li>Steam Deck hasn&rsquo;t arrived yet. So yeah, even though I purchased both of them in one order, delivery dates turned out to be <a href="./images/shipment/fedex-7-only-dock-delivered.png">different</a>;</li>
</ul>
</li>
<li>2022-12-01 (<em>8 days</em>):
<ul>
<li>Steam Deck <a href="./images/shipment/fedex-8-deck-delivered.png">got delivered</a>. Here&rsquo;s a <a href="./images/shipment/fedex-9-deck-delivery-log.png">full log</a> with the weight (<em>1.81 kg</em>).</li>
</ul>
</li>
</ul>
<p>Thus, the total time from the day I placed the order till both <a href="./images/shipment/fedex-10-both-delivered.png">Dock and Deck</a> got delivered was 8 days, which is pretty good. But of course in my case that was just the delivery to my friends home, and I still needed to go to USA and pick it up from them, which happenned only some weeks later.</p>
<p>So, overall, it is not a very easy/quick procedure for a non-US resident:</p>
<ul>
<li>need to have a US bank card;</li>
<li>need to have friends or someone living in US to be able to use their address for delivery;</li>
<li>need to somehow fetch the package from friends.</li>
</ul>
<p>And even though I have my Steam Deck now, I still would very much like Valve to start selling it in Norway. At the very least so I could send it for repairment, if anything happens.</p>
<h1 id="differences-between-models">Differences between models</h1>
<p>From the moment Steam Deck sales started in 2022 and up until now there have been 3 models available for purchasing:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-deck-models.png" alt="Steam Deck models">

<p>There are some more differences than what&rsquo;s listed on the website, and you most definitely have already read about those <a href="https://overkill.wtf/which-steam-deck-should-you-get/">all around the internet</a>, but I&rsquo;ll still make a comparison table of my own:</p>
<div style="overflow-x:auto;">
    <table class="table">
        <thead>
            <tr>
                <th></th>
                <th>Steam Deck 64</th>
                <th>Steam Deck 256</th>
                <th>Steam Deck 512</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th>Storage space</th>
                <td>64 GB</td>
                <td>256 GB</td>
                <td>512 GB</td>
            </tr>
            <tr>
                <th>System disk (2230 M.2)</th>
                <td>eMMC<br>(PCIe Gen 2)</td>
                <td>NVMe SSD<br>(PCIe Gen 3)</td>
                <td><u>high-speed</u> NVMe SSD<br>(PCIe Gen 3)</td>
            </tr>
            <tr>
                <th>Screen</th>
                <td>-</td>
                <td>-</td>
                <td>anti-glare etched glass</td>
            </tr>
            <tr>
                <th>Case</th>
                <td>white logo, black zip handlers, black insides</td>
                <td>white logo, black zip handlers, black insides</td>
                <td><u>blue</u> logo, <u>white</u> zip handlers, <u>gray insides</u>, different fabric (<i>of insides?</i>)</td>
            </tr>
            <tr>
                <th>Accessories</th>
                <td>-</td>
                <td>-</td>
                <td>microfiber cleaning tissue, poach for charger</td>
            </tr>
            <tr>
                <th>Steam profile bundle</th>
                <td>-</td>
                <td>yes</td>
                <td>yes</td>
            </tr>
            <tr>
                <th>Additional virtual keyboard skin</th>
                <td>-</td>
                <td>-</td>
                <td>yes</td>
            </tr>
            <tr>
                <th>Price</th>
                <td>399 USD</td>
                <td>529 USD</td>
                <td>649 USD</td>
            </tr>
        </tbody>
    </table>
</div>
<p>There is apparently also an exclusive <a href="./images/steam-deck-valve-employees.jpg">transparent model with a white case</a>, which supposedly was given out internally to Valve employees on Christmas, although that might be just a rumor. But if it does exist, its hardware is probably the same as in stock models.</p>
<p>Full technical specifications for all the models are published <a href="https://store.steampowered.com/steamdeck#SaleSection_24468">here</a>.</p>
<p>The most important conclusion to make from this table is that the performance in terms of CPU / RAM / GPU is the same across all 3 models. Except for the disk read/write(<em>?</em>) speed difference, which might be negligible.</p>
<p>This means that one can just purchase the cheapest 64 GB model and get the absolutely same gaming performance, which essentialy is the only thing that matters, as the rest is just cosmetics. Except for the anti-glare screen, which can probably make a difference in certain scenarios.</p>
<h2 id="about-the-storage">About the storage</h2>
<p>Let&rsquo;s talk about the storage then, since performance-wise all 3 models are the same. Basically the choice comes down to how much available storage space you&rsquo;d like to have on the system disk. Arguably that isn&rsquo;t very important either, as Steam Deck has a slot for microSD cards, so you can buy a 64 GB Steam Deck and a 1 TB card and you&rsquo;ll have plenty of space.</p>
<p>Actually, you will most likely buy a card in any case, and for example I purchased a 512 GB card (<em><a href="https://amazon.com/gp/product/B09X7C2GBC">SanDisk Extreme 512 GB</a> for 51 USD</em>) even before I ordered my Steam Deck. I can assure you, getting Steam Deck 64 GB model and no card is absolutely not a viable option, because free disk space will flow away like water through your fingers. Hell, it is not rare nowadays when even a single game can occupy more than 100 GB of space.</p>
<p>And even you did get a card, and let&rsquo;s say it has a capacity of 9000 terabytes, you still probably will regret having a system disk with only 64 GB:</p>
<ul>
<li>one reason is the ever-growing <a href="#shader-cache">shader cache</a>, which will eat away gigabytes in an uncontrollable manner;</li>
<li>second reason, which might not be important for everyone, is using Steam Deck as a &ldquo;regular&rdquo; PC, which involves storing various files, installing additional software, some (<em>all</em>) of which you wouldn&rsquo;t want to store anywhere but on the system disk (<em>development tools and libraries, CLI utilities, applications, etc</em>).</li>
</ul>
<p>So yeah, 64 GB model is probably only suitable for those who intend to use their Steam Deck for nothing but games. Which is probably the case for majority of users, actually.</p>
<p>Read/write speed-wise, SSD is definitely faster than a microSD card, so your games will load faster from SSD. But the difference isn&rsquo;t that big to matter much, for example here&rsquo;s a <a href="https://youtu.be/i8rNxYxtF5M">comparison</a> of Portal 2 load times.</p>
<p>Another option which some might consider is to still get the 64 GB model but replace the default 64 GB disk with a 512 GB / 1 TB disk purchased separately. While this most certainly works and lets you save quite some money (<em>Steam Deck 64 GB model plus 1TB SSD can end up being cheaper than Steam Deck 512 GB model</em>), I most certainly wouldn&rsquo;t do that, as I am not brave enough to disassemble my Steam Deck, plus Valve itself does not recommend to perform such an operation (<em>more about reasons for that <a href="#thermals-and-cooling">later</a></em>).</p>
<h3 id="x2-or-x4">x2 or x4</h3>
<p>The 256/512 GB SSD can be PCIe Gen 3 of either <code>x2</code> or <code>x4</code> variation/model. Valve says that &ldquo;<em>in our testing, we did not see any impact to gaming performance between x2 and x4</em>&rdquo;, which of course means that <code>x4</code> is so much better. But how can you check which one you got?</p>
<p>The disk model is specified on your Steam Deck <a href="https://store.steampowered.com/account/hardwareused">components page</a>, and I have Kingston <code>OM3PDP3512B-A01</code>. Device Viewer application reports the same. But how to check whether it&rsquo;s <code>x2</code> or <code>x4</code>? The <a href="https://kingston.com/en/embedded/design-in-ssd">Kingston website</a> doesn&rsquo;t even have this model in the list:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/kingston-2230-ssd-models.png" alt="Kingston 2230 SSD models" style="border:1px solid black;">

<p>But fear not, you can get check that using <a href="https://reddit.com/r/SteamDeck/comments/w5guzg/is_kingston_oem3pdp3512ba01_x2_or_x4/ih88sll/">the following command</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>$ sudo lspci -s 01:00 -vv | grep &#39;controller\|Width&#39;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>01:00.0 Non-Volatile memory controller: Kingston Technology Company, Inc. OM3PDP3 NVMe SSD (rev 01) (prog-if 02 [NVM Express])
</span></span><span style="display:flex;"><span>        LnkCap:    Port #1, Speed 8GT/s, Width x4, ASPM L1, Exit Latency L1 unlimited
</span></span><span style="display:flex;"><span>        LnkSta:    Speed 8GT/s, Width x4</span></span></code></pre></div>
<p>So I got <code>x4</code>.</p>
<h1 id="how-does-it-look">How does it look</h1>
<p>Here are some photos of Steam Deck itself, as if you haven&rsquo;t seen enough of those already:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/photos/steam-deck-deadpool-front.jpg" alt="Deadpool holding Steam Deck">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/photos/steam-deck-deadpool-top.jpg" alt="Deadpool holding Steam Deck">

</p>
<p>Accessories included with 512 GB model:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/photos/steam-deck-case-closed.jpg" alt="Steam Deck 512 GB case closed">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/photos/steam-deck-case-open.jpg" alt="Steam Deck 512 GB case open">

</p>
<p>The case is of a very high quality. If it was sold separately, it could easily cost 50 USD but likely more, so it is very generous to provide this one included.</p>
<p>The cleaning tissue is a nice to have kind of thing, and pouch can be used for putting something (<em>a charger</em>) into it and stucking it under the strap on the backside of the case - there is a kinda pocket-cave there.</p>
<p>There is also a 45 W charger included, and since it&rsquo;s a US plug, I needed to use an adapter (<em>not a converter, because Steam Deck (like any other modern device) supports both 120 and 220/230/240 V</em>):</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/photos/steam-deck-charger-adapter.jpg" alt="Steam Deck charger and adapter">

<p>Here are also photos with everything plus iPhone XR and Apple Watch for size comparison:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/photos/steam-deck-iphone-xr.jpg" alt="Steam Deck and iPhone XR">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/photos/steam-deck-dock-iphone-xr-watch.jpg" alt="Steam Deck, iPhone XR, Apple Watch and Steam Deck">

</p>
<p>So it really is rather big, like you wouldn&rsquo;t believe that a portable device can be that big. I mean, it&rsquo;s not fat, but it is long. Valve did need to pack a lot of things inside, so I guess the size is justified. You certainly cannot put it in your pocket, and so a backpack is probably the only way to take out with you (<em>it will occupy even more space being in the case</em>). And now, a couple of months later, I got used to it so I barely remember that it looked big to me first.</p>
<p>The weight might not seem like much, but it is noticable, and for instance if you&rsquo;ll be playing lying on your back and holding it above, your wrists will get numb/tired in about 20 minutes, so you&rsquo;ll need to change positions (<em>at least some positions for you to change, hehe</em>).</p>
<h1 id="hardware">Hardware</h1>
<p>I won&rsquo;t be talking about CPU/GPU characteristics like clock speed, cache size and so on. Quite honestly, these numbers don&rsquo;t tell me much, the main metric for me is that it is capable of running all my games, and it does that better than my desktop PC (<em>which was a gaming one, when I assembled it some years ago</em>).</p>
<h2 id="controls">Controls</h2>
<p>As far as build quality goes, everything seems to be very well done. Buttons and triggers are super nice and pleasant to click/push/trigger. The device feels great in your hands, all the controls are convenient to reach. I reckon, a lot of thought and experimentation went into designing this layout to make it feel that great. <a href="https://cdn.cloudflare.steamstatic.com/steamdeck/images/press/book/steamDeck_booklet_EN.pdf">Here</a> (<em>page 23</em>) you can take a look at some prototypes Valve went through.</p>
<p>Like some mentioned, the 4 back buttons are somewhat more difficult to reach and are more stiff/harder to press comparing to other buttons, but only at first. I got used to them very fast and really cannot complain. Either way, it is super useful to have 4 additional buttons.</p>
<p>Thumbsticks/joysticks are good, but in addition to just being good they also have &ldquo;capacitive touch&rdquo;, meaning that they generate input events when you just touch them without moving or pressing, which adds even more customization capabilities to the <a href="#steam-input">Steam Input</a>.</p>
<h3 id="trackpads">Trackpads</h3>
<p>Trackpads (<em>or touchpads</em>) are just outright great. Very nice precision, pleasant feedback (<em>amazing feature on its own</em>), and also they have a sort of inertia when you can kinda throw the mouse pointer in some direction and it will continue moving for some more even though you&rsquo;ve already lifted your finger. That is so extremely satisfying, you need to try it out yourself, it&rsquo;s hard to describe with words.</p>
<p>I&rsquo;ve seen some people writing about how it would be better if Steam Deck did not have trackpads. I, for one, absolutely cannot imagine using Steam Deck without trackpads. For starters, typing on the virtual keyboard without them is ten times slower.</p>
<p>Without trackpads lots of games would take a severe hit in convenience and comfort of playing, as you cannot position the mouse pointer (<em>aim, look around, etc</em>) that precisely with joysticks, not to mention the lack of feedback and inertia movement. And when it comes to <a href="#steam-input">Steam Input</a>, trackpads are a huge asset for using <a href="#virtual-menus">virtual menus</a>.</p>
<p>In Desktop mode they are just god-send, you can operate desktop environment without having an actual mouse connected. They don&rsquo;t entirely compensate the lack of mouse, but it gets very close to it. In addition, there are some nice (<em>and again, extremely satisfying</em>) gestures like circular movement on the left trackpad for scrolling.</p>
<p>Seriously, one needs to be mentally challenged to desire Steam Deck not to have trackpads.</p>
<h3 id="gyroscope">Gyroscope</h3>
<p>There is also a gyroscope, which you can use for precise aiming in first-person shooters or elsewhere.</p>
<p>I&rsquo;ve tried it, and does indeed seem to let you aiming very precise, which is something console gamers never had. One just cannot play Counter-Strike with a gamepad on the same level as with keyboard and mouse. But to clarify, while you are likely to aim better than an average gamepad player, you are still very unlikely to get as good as a keyboard/mouse player.</p>
<p>I am still getting used to it, as it requires some training, especially when you want your character to shoot while moving. But I can certainly say that it is a useful feature, and for instance I wouldn&rsquo;t be able play games like <a href="#black-mesa">Black Mesa</a> having nothing but joysticks for aiming.</p>
<p>One other thing to mention here is that you won&rsquo;t be able to use gyroscope in a moving car and maybe also on some other means of transport. It is just too good in being a gyroscope: all that movement will transform into your input, making the aiming/camera trajectory unpredictable. Might be obvious, but caught me by surprise on my first car trip with Steam Deck.</p>
<h2 id="speakers-and-sound">Speakers and sound</h2>
<p>The speakers are loud enough, I never needed to set the level to more than 60-70%. The sound quality is good, at least it is so to my peasant hearing. If anything, perhaps it could have some more bass.</p>
<p>You can also connect headphones/speakers via 3.5 jack or Bluetooth. So far I&rsquo;ve tried Bluetooth and it works fine with my <a href="/blog/2017/07/17/bose-qc35/">Bose QuietComfort 35</a> and Apple AirPods Pro.</p>
<p>Some people complain about sound lagging when using Bluetooth-connected headphones, and yes, there is some latency. It&rsquo;s not bad, but noticable, especially when I sort gems in stash in <a href="#diablo-ii-resurrected">Diablo II</a>. Some also complain about problems with microphones on their headsets, but that I haven&rsquo;t tested yet.</p>
<p>Aside from speakers Steam Deck has its own microphone (<em>&ldquo;dual microphone array&rdquo;</em>) too, but I haven&rsquo;t tested that either.</p>
<h2 id="screen">Screen</h2>
<p>The screen isn&rsquo;t too big, especially given its rather huge bezels. But you will be holding it quite close to your face, so it will be fine.</p>
<p>The resolution is 1280x800 and refresh rate is 60 Hz (<em>meaning maximum 60 FPS in games</em>). Having such not a very big resolution is one of the reasons how the device is capable of running even the most recent games that are rather demanding.</p>
<p>Having a such a not very big screen naturally results in difficulties with reading text. That of course depends on the game, and some games even take care of handling text readability specifically for Steam Deck, but most of the games do not. I found it especially challenging to read text in XCOM 2 and Witcher 3 games.</p>
<p>There is a screen magnifier shortcut, but it isn&rsquo;t very convenient to use and the magnification isn&rsquo;t very much helpful either. Well, it isn&rsquo;t really a disadvantage of Steam Deck, just something inevitable. Besides, making a bigger screen would naturally make the overall device even bigger and also increase the power consumption.</p>
<p>The screen is a touchscreen - something I absolutely did not expect. I would say, it is a very nice capability to have, and in some cases it was really useful, but in general I think it&rsquo;s rather useless, and the actual touch experience/responsiveness/sensitivity is quite far from iPad&rsquo;s, so Steam Deck could probably do without having a touchscreen at all (<em>and that would probably also make it a little bit cheaper</em>).</p>
<p>As for the picture quality, some say it is mediocre and suggest installing certain plugins such as <a href="https://github.com/libvibrant/vibrantDeck">Vibrant Deck</a> to control the colors saturation. I personally do not think that the picture quality is mediocre, it looks totally fine to me.</p>
<h3 id="mouse-and-keyboard-input">Mouse and keyboard input</h3>
<p>Quite naturally, there is no mouse and there is no keyboard.</p>
<p>However, the mouse input is very well covered:</p>
<ul>
<li>you can use trackpads;</li>
<li>you can use joysticks;</li>
<li>you can use touchscreen;</li>
<li>you can connect an actual wired/wireless mouse.</li>
</ul>
<p>For the keyboard though you have only 2 options:</p>
<ul>
<li>you can call for on-screen virtual keyboard and type on it using either of the mouse inputs listed above plus arrow keys;</li>
<li>you can connect an actual wired/wireless keyboard.</li>
</ul>
<p>The on-screen keyboard I&rsquo;d like to say some more about:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/on-screen-keyboard.jpg" alt="Steam Deck on-screen keyboard">

<p>I saw people criticizing it, and there is some truth to that criticism, especially when it starts to act crazy in Desktop mode by constantly showing/disappearing when some input field gets focused, and it cannot decide where it should trigger on that or not. But I&rsquo;ve seen a number of virtual keyboard on various devices, and in my opinion this is one among the best.</p>
<p>&hellip;As long as you don&rsquo;t use touchscreen for typing, as it certainly isn&rsquo;t on the level of iPad/iPhone-like experience. Well, that was is expected, as who has better touchscreens than Apple devices anyway.</p>
<p>Where the virtual keyboard does its best is when you are typing on it using trackpads: it&rsquo;s a little bit hard to explain, but it&rsquo;s kind of a &ldquo;relative&rdquo; typing, where every coordinate on a trackpad is nearing certain keyboard button, and each trackpad is responsible for its half of the keyboard, so you can type with both hands and somewhat reuse your &ldquo;keyboard muscle memory&rdquo;. You won&rsquo;t get as high typing speed as you have on a physical keyboard, but it will still be very decent and rather convenient too.</p>
<p>And anyway, it&rsquo;s not often when you need to type some text in a game (<em>depends on the game, of course</em>). So far I mostly needed it only in Desktop mode when a physical keyboard wasn&rsquo;t nearby.</p>
<p>What&rsquo;s surprising is that there is no way to input functional keys (<em>F1, F2, F3 and so on</em>), Ctrl and ESC key. This possibility will likely be added later, but how come it hasn&rsquo;t been already added, neither initially nor after the whole year since the release date? Can it really be that no one needs these keys?</p>
<h2 id="battery">Battery</h2>
<p>Long story short and taking the worst case: demanding games can run the battery down from 100% to 0% in about 1.5 hours (<em>or less!</em>). For instance, here&rsquo;s a screenshot of <a href="https://store.steampowered.com/bundle/7118/">XCOM 2</a> running at maximum graphics settings:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/xcom2-mangohud.jpg" alt="XCOM 2 power consumption on Steam Deck">

<p>As you can see, the battery is being drained for 24 W in average (<em>can go up to 26 W</em>), and roughly that means losing about 1% of charge per minute, so 100% charged battery would last for about 100 minutes of gameplay. In this particular test I launched the game when Steam Deck was charged to 90%, and 85 minutes (<em>01:25</em>) later the battery was at 3% level.</p>
<p>Admittedly, that&rsquo;s not a whole lot of play-time, but it is still a good enough result for me. The fact alone that I can play such games not on my desktop gaming PC but on the go is already amazing. Plus I&rsquo;m <a href="#using-a-powerbank">using a powerbank</a>, so this doesn&rsquo;t bother me much.</p>
<p>While we are here, these performance metrics in the top-left corner are shown by a special overlay called <a href="https://github.com/flightlessmango/MangoHud">MangoHud</a>, which is seamlessly integrated into Gaming mode and can be called-up in every game.</p>
<p>Coming back, that 1.5 hours playtime really is <u>one of the worst cases</u>, and in general the battery can easily last for 2-4 hours (<em>or even more</em>) with less demanding games.</p>
<p>To prolong the battery life you can adjust certain performance settings. First of all, you can lower down the graphics in the game&rsquo;s own settings. Secondly, there are several performance settings available via the global system overlay that shows up when you press 3-dots button.</p>
<p>One such setting is a FPS limiter: you can cap it at 40 FPS, and that alone brings a significant increase of playtime. Having 40 FPS in a game on a screen of this size is totally fine for me, so I set it globally for all the games. By the way, that is why the MangoHud metrics always show 40 FPS on all my screenshots later in the text.</p>
<p>There are other settings too:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-deck-performance-settings.jpg" alt="Steam Deck performance settings">

<p>The actual effect of applying these I can&rsquo;t say anything about, because I haven&rsquo;t tried anything except the FPS limit, and that already seems to do a good enough job for me.</p>
<p>Lowering the screen brightness helps too, but that would be in expense of your eyes health, so that might not be worth it.</p>
<h3 id="charging">Charging</h3>
<p>If you are to use any other charger aside from the original one, do note that you&rsquo;d need a charger that is capable of outputting at least 40 W. Also, speaking about charging, there is no way to tell the charging level when the screen is off, because the only indicator you have is the moonlight LED near the USB-C port, and it doesn&rsquo;t have any states really. I did notice though that it turns off eventually, and all the times that happened the battery level reached 100%, so maybe that is the indication.</p>
<p>To charge Steam Deck from 0% to 100% using the original charger, it takes around 2-3 hours. I haven&rsquo;t measured the exact time, but it really isn&rsquo;t a fast process. The slowest part is the last 20% (<em>from 80% to 100%</em>).</p>
<h3 id="using-a-powerbank">Using a powerbank</h3>
<p>Like I said, the battery can discharge in less than 2 hours while you are playing. And from the sofa where I&rsquo;m playing on it is not very convenient (<em>and too disruptive</em>) to stand up and go to the charging spot every 2 hours. As for travels, there the charging problem will likely become more of a problem than inconvenience.</p>
<p>So I decided to get a powerbank, one capable of outputting 40 W or more. Having googled for what&rsquo;s available on the market, I soon enough discovered this beautiful thing - <a href="https://anker.com/products/a1289">Anker 737 Power Bank</a>. Fucking beautiful, and powerful too. Probably the best powerbank that money could buy as of now.</p>
<p>It has a capacity of 24 000 mAh, which is enough to fully charge Steam Deck from 0% to 100% and then there will be still enough power to charge it for at least 50% - so in total 150% / 1.5 full charges.</p>
<p>As for the output, it can do unfuckingbelievable 140 W, which is an overkill for Steam Deck needs (<em>not in a sense that it&rsquo;s harmful</em>), because it can draw maximum 45 W. According to the values shown on the powerbank display (<em>don&rsquo;t know how precise those are</em>), Steam Deck draws about 25 W when it is turned off / in sleep mode:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/anker-737-steam-deck-off.jpg" alt="Anker 737 charging Steam Deck turned off">

<p>When it is charged to a level above 80%, it starts drawing something like 15 W, and then on the level above 90% it drops to about 5 W.</p>
<p>But when it is being charged while running a game, then consumption goes to about 41 W:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/anker-737-steam-deck-on.jpg" alt="Anker 737 charging Steam Deck while runnung a game">

<p>I&rsquo;ve never seen it drawing 45 W, as specification says it could.</p>
<p>All that power, however, doesn&rsquo;t go &ldquo;unpunished&rdquo;:</p>
<ul>
<li>it is quite a heavy and bulky thing, which you cannot just put into your pocket, probably only in a backpack. That&rsquo;s totally fine for my scenario of playing from sofa, plus you&rsquo;d need a backpack to carry Steam Deck itself anyway;</li>
<li>you&rsquo;d need an equally powerful charger to charge the powerbank fast enough, probably <a href="https://anker.com/products/a2148">Anker 737 Charger</a> would be the best (<em>and bloody expensive</em>) fit. I use my MacBook Pro&rsquo;s 87W charger, and that one charges it from 0% to 100% in about 1 hour.</li>
</ul>
<h3 id="battery-storage-mode">Battery storage mode</h3>
<p>Turning on your out-of-the-box Steam Deck for the very first time requires you to have it connected to power, and there is even a dedicated leaflet about that in the box:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/plug-in-leaflet.jpg" alt="Steam Deck, plug-in leaflet">

<p>Apparently this is because devices are shipped with so-called &ldquo;Battery storage mode&rdquo; enabled, and only connecting it to power will disable it. In other words, you cannot turn on your brand new Steam Deck without connecting a charger.</p>
<p>Here&rsquo;s a quote from the <a href="https://help.steampowered.com/en/faqs/view/69E3-14AF-9764-4C28">FAQ</a> (<em>there are no anchors on that page</em>) with some more details and also instructions how to enable Battery storage mode if needed:</p>
<blockquote>If you won't be using your Steam Deck for a while and would like to place it back into storage mode to increase long term battery health, you can use the following steps to do so:
<ul>
<li>Power the Steam Deck down normally (choose Shut Down from the Power menu)</li>
<li>Hold down the Volume+ button and press the power button. The Steam Deck should boot into the BIOS menu</li>
<li>Using the D-Pad and A to select, navigate to &ldquo;Setup Utility&rdquo;</li>
<li>Navigate to the Power Menu</li>
<li>Choose Battery storage mode, and confirm</li>
</ul>
<p>You should see the Steam Deck power off, and the power LED will blink three times to confirm battery storage mode has been activated.</p>
<p>To wake your Steam Deck from storage mode, plug in the provided power supply and power it on normally.</blockquote></p>
<h2 id="thermals-and-cooling">Thermals and cooling</h2>
<p>I never had Steam Deck being uncomfortably hot under any load. It is always just warm, no matter how stressful the load is. For instance, I <a href="#monitoring-the-temperature">monitored the temperature</a> during a project compilation with all cores being loaded at 100%, and it never went higher than 84°C, while the device body was just warm and not uncomfortable to hold. At the same time, you don&rsquo;t even reach the hottest spot on the device body, unless you explicitly touch it.</p>
<p>From <a href="https://youtu.be/NeQH__XVa64">this video</a> you can learn that Valve engineers gave some serious thought towards device thermals and the way it is cooled. Yet, you can find all sorts of geniuses on the internet who think they know better, suggesting various ideas for &ldquo;improving&rdquo; the thermals, which I would certainly not recommend to follow.</p>
<p>For the same reasons (<em>not messing with the original thoroughly designed cooling setup</em>) I don&rsquo;t think it is such a splendid idea to &ldquo;upgrade&rdquo; the SSD, which is also what Valve is advising against. But of course we all know better, they only say that to sell you the most expensive 512 GB model, deceitful bastards.</p>
<p>The fan isn&rsquo;t as loud as some claim it to be. Being under the maximum workload, it produces a quite okay noize level. Moreover, if you&rsquo;re playing a game, then you&rsquo;ll have game sounds and music, which would make the fan noize even less noticable, so for me it is certainly not loud enough to be irritating/annoying.</p>
<p>Yet, when people discovered that Steam Deck units might have different fans, produced by either Delta or Huaying, a new religion has been started immediately, in which it is believed that Huaying fan is better / less noizy. I have a Delta fan (<em>according to the <a href="https://store.steampowered.com/account/hardwareused">components page</a></em>) and, like I said, I cannot complain about the fan noize. If you&rsquo;d like to know more about Delta/Huaying hysteria, here&rsquo;s a <a href="https://youtu.be/G2EEtzhsr2s">very detailed video</a> about that.</p>
<h1 id="steamos">SteamOS</h1>
<h2 id="about-the-os">About the OS</h2>
<p><a href="https://en.wikipedia.org/wiki/SteamOS">SteamOS</a> version 3.x is GNU/Linux distribution based on <a href="https://en.wikipedia.org/wiki/Arch_Linux">Arch Linux</a>.</p>
<p>Here&rsquo;s what <a href="https://github.com/dylanaraps/neofetch">neofetch</a> reports for me:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ neofetch
</span></span><span style="display:flex;"><span>              .,,,,.                  deck@HOSTNAME
</span></span><span style="display:flex;"><span>        .,&#39;onNMMMMMNNnn&#39;,.            -----------
</span></span><span style="display:flex;"><span>     .&#39;oNMANKMMMMMMMMMMMNNn&#39;.         OS: SteamOS Holo x86_64
</span></span><span style="display:flex;"><span>   .&#39;ANMMMMMMMXKNNWWWPFFWNNMNn.       Host: Jupiter 1
</span></span><span style="display:flex;"><span>  ;NNMMMMMMMMMMNWW&#39;&#39; ,.., &#39;WMMM,      Kernel: 5.13.0-valve36-1-neptune
</span></span><span style="display:flex;"><span> ;NMMMMV+##+VNWWW&#39; .+;&#39;&#39;:+, &#39;WMW,     Uptime: 10 days, 19 hours, 2 mins
</span></span><span style="display:flex;"><span>,VNNWP+######+WW,  +:    :+, +MMM,    Packages: 924 (pacman), 172 (brew), 12 (flatpak)
</span></span><span style="display:flex;"><span>&#39;+#############,   +.    ,+&#39; +NMMM    Shell: bash 5.1.16
</span></span><span style="display:flex;"><span>  &#39;*#########*&#39;     &#39;*,,*&#39; .+NMMMM.   Resolution: 800x1280
</span></span><span style="display:flex;"><span>     `&#39;*###*&#39;          ,.,;###+WNM,   Terminal: /dev/pts/0
</span></span><span style="display:flex;"><span>         .,;;,      .;##########+W    CPU: AMD Custom APU 0405 (8) @ 2.800GHz
</span></span><span style="display:flex;"><span>,&#39;,.         &#39;;  ,+##############&#39;    GPU: AMD ATI AMD Custom GPU 0405
</span></span><span style="display:flex;"><span> &#39;###+. :,. .,; ,###############&#39;     Memory: 2813MiB / 14818MiB
</span></span><span style="display:flex;"><span>  &#39;####.. `&#39;&#39; .,###############&#39;
</span></span><span style="display:flex;"><span>    &#39;#####+++################&#39;
</span></span><span style="display:flex;"><span>      &#39;*##################*&#39;
</span></span><span style="display:flex;"><span>         &#39;&#39;*##########*&#39;&#39;
</span></span><span style="display:flex;"><span>              &#39;&#39;&#39;&#39;&#39;&#39;</span></span></code></pre></div>
<p>Interesting that it detects screen orientation as vertical (<em><code>800x1280</code></em>). And I actually saw some bugreports where SteamOS would boot-up having vertical screen orientation.</p>
<p>The username is <code>deck</code>, it has <code>sudo</code> privileges but no password, so you&rsquo;ll need to set it with <code>passwd</code>.</p>
<h2 id="desktopgaming-mode">Desktop/Gaming mode</h2>
<p>Steam Deck, or rather SteamOS, has two modes:</p>
<ul>
<li>Desktop - usual <a href="https://kde.org/plasma-desktop/">KDE Plasma</a> desktop environment;</li>
<li>Gaming - a kind of dedicated/isolated fullscreen environment called <a href="https://wiki.archlinux.org/title/Gamescope">Gamescope</a>.</li>
</ul>
<p>Gaming mode is the default mode that you get on the device start. It has everything you need to play games, it is all about playing games: navigation with gamepad controls, intuitive layout and full <a href="#steam-input">Steam Input</a> support. Nothing gives out that this is a GNU/Linux machine. All you see is a nice, intuitive and (<em><a href="#gui-issues">not entirely</a>, but mostly</em>) polished gaming device.</p>
<p>Aside from playing your games, you can buy new ones right there in the store:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-deck-store.jpg" alt="Steam Deck, store">

<p>and even redeem Steam keys:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-deck-redeem-code.jpg" alt="Steam Deck, redeeming Steam key">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-deck-redeemed-code.jpg" alt="Steam Deck, redeemed Steam key">

</p>
<p>I reckon, the majority of users will never even see the Desktop mode, they probably won&rsquo;t ever suspect that Steam Deck is not just a gaming device (<em>&ldquo;video game machine&rdquo;, as Valve called inside the package</em>).</p>
<p>Looking at other consoles, such a setup is like a breath of fresh air. If I don&rsquo;t want to know anything about these scary Linux things, then I don&rsquo;t need to, I can just play games in Gaming mode forever. But if I do, then I can simply switch to Desktop mode and get an actual proper GNU/Linux desktop environment with a freedom of doing everything I&rsquo;d like to (<em>including fucking up the system entirely</em>).</p>
<p>Here&rsquo;s a <a href="https://youtu.be/a0gEIeFgDX0">good video</a> with more technical details about Gaming/Desktop modes. Here&rsquo;s also another <a href="https://youtu.be/UUh2qtjZu4E">interesting overview</a>, with some criticism too, and some of the problems they mentioned have been already fixed in later SteamOS updates.</p>
<h2 id="proton">Proton</h2>
<p>With the SteamOS being a GNU/Linux OS, one would think that it&rsquo;s not a whole lot of games that you can play on it then. But that assumption would be wrong. I did read about Valve <a href="https://steamcommunity.com/games/221410/announcements/detail/1696055855739350561">working</a> on something based on <a href="https://winehq.org">Wine</a> some years ago, but I certainly didn&rsquo;t expect that thing to magically run all the Windows-only games.</p>
<p>The thing is called <a href="https://github.com/ValveSoftware/Proton">Proton</a>. Being based on Wine, it provides a set of Windows libraries and a Windows-like directory structure for a game (<em>or an application</em>) to find all the required Windows API functions and be able to run like it is Windows environment, while it is actually a GNU/Linux host. In addition, Proton further extends Wine&rsquo;s capabilities with various improvements specifically for 3D performance in games, and it does it so well that some report better performance in games running on SteamOS through Proton than the same games running in actual Windows environment.</p>
<p>Here&rsquo;s a <a href="https://youtube.com/watch?v=Pfsb4M7swbE">good video</a> talking about Proton with much more details.</p>
<p>It&rsquo;s really unbelievable how good the Proton is. All the Windows-only games that I&rsquo;ve tried to run so far are running just fine. On a GNU/Linux host! The amount of effort that went into both Proton and Wine to make this happen must have been huge.</p>
<p>I should probably mention that games with convoluted anti-cheat software for playing online or/and additional anti-piracy components will most likely not work, but that would be a limitation of this particular anti-cheat/anti-piracy crap. The same games being &ldquo;<em>freed</em>&rdquo; (<em>if you know what I mean</em>) from all this nonsense will most probably run fine (<em>except for obviously not being able to play online on official servers</em>).</p>
<p>There is an unofficial list of Proton-supported games called <a href="https://protondb.com">ProtonDB</a> and there is also an official Valve&rsquo;s listing called <a href="https://steamdeck.com/en/verified">Deck Verified</a>. I find both of these being almost equally useless for me. Like I said, all the games I&rsquo;ve tried (<em>so far</em>) run just fine on Steam Deck, despite some of them being labeled as &ldquo;<em>unsupported</em>&rdquo; in either one or both of these listings, so what is the point of them then.</p>
<p>But to be fair, ProtonDB is not as useless as Deck Verified list, because it has comments on game pages, and there people share actually useful tips, such as CLI launch options or specific Proton versions for getting better compatibility/performance out of a particular game.</p>
<p>Lastly, Proton isn&rsquo;t an exclusive technology of Steam Deck / SteamOS. If you have a GNU/Linux distribution as your main OS, you can install Steam and Proton on it and get a probably even more powerful (<em>although not portable</em>) gaming station without the need to dual-boot to Windows to play some games or run some Windows-only applications.</p>
<h3 id="how-to-run-an-application-with-proton">How to run an application with Proton</h3>
<p>Just like with <a href="https://github.com/retifrav/scraps/blob/master/_linux/wine.md">Wine</a>, you can use Proton for launching Windows applications/games on a GNU/Linux host (<em>such as Steam OS on Steam Deck</em>). It requires setting some more environment variables, but the principle is the same.</p>
<p>To clarify just in case, this is not about launching a game through Steam, but about running it with Proton directly from CLI.</p>
<p>For the sake of experiment, let&rsquo;s not use Steam&rsquo;s default Proton, instead I&rsquo;ll take <a href="https://github.com/GloriousEggroll/proton-ge-custom#native">Proton GE</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>$ wget https://github.com/GloriousEggroll/proton-ge-custom/releases/download/GE-Proton8-4/GE-Proton8-4.tar.gz
</span></span><span style="display:flex;"><span>$ tar -xf ./GE-Proton8-4.tar.gz -C ~/.steam/root/compatibilitytools.d/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ tree -L 2 ~/.steam/root/compatibilitytools.d/
</span></span><span style="display:flex;"><span>/home/deck/.steam/root/compatibilitytools.d/
</span></span><span style="display:flex;"><span>└── GE-Proton8-4
</span></span><span style="display:flex;"><span>    ├── compatibilitytool.vdf
</span></span><span style="display:flex;"><span>    ├── filelock.py
</span></span><span style="display:flex;"><span>    ├── files
</span></span><span style="display:flex;"><span>    ├── LICENSE
</span></span><span style="display:flex;"><span>    ├── LICENSE.OFL
</span></span><span style="display:flex;"><span>    ├── PATENTS.AV1
</span></span><span style="display:flex;"><span>    ├── proton
</span></span><span style="display:flex;"><span>    ├── proton_3.7_tracked_files
</span></span><span style="display:flex;"><span>    ├── protonfixes
</span></span><span style="display:flex;"><span>    ├── __pycache__
</span></span><span style="display:flex;"><span>    ├── toolmanifest.vdf
</span></span><span style="display:flex;"><span>    ├── user_settings.sample.py
</span></span><span style="display:flex;"><span>    └── version</span></span></code></pre></div>
<p>With <a href="#diablo-ii-resurrected">Diablo II Resurrected</a> as an example, a command for running the game will be:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ <span style="color:#a6e22e">STEAM_COMPAT_CLIENT_INSTALL_PATH</span><span style="color:#f92672">=/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>steam<span style="color:#f92672">/</span>steam \
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">STEAM_COMPAT_DATA_PATH</span><span style="color:#f92672">=/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>steamapps<span style="color:#f92672">/</span>compatdata<span style="color:#f92672">/</span><span style="color:#ae81ff">2718988064</span> \
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>compatibilitytools<span style="color:#f92672">.</span>d<span style="color:#f92672">/</span><span style="color:#a6e22e">GE</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Proton8</span><span style="color:#f92672">-</span><span style="color:#ae81ff">4</span><span style="color:#f92672">/</span>proton waitforexitandrun \
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">/</span>run<span style="color:#f92672">/</span>media<span style="color:#f92672">/</span>mmcblk0p1<span style="color:#f92672">/</span>games<span style="color:#f92672">/</span>diablo<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">-</span>resurrected<span style="color:#f92672">/</span>D2R<span style="color:#f92672">.</span>exe <span style="color:#f92672">-</span>launch</span></span></code></pre></div>
<p>here:</p>
<ul>
<li><code>STEAM_COMPAT_CLIENT_INSTALL_PATH</code> - looks like Proton can&rsquo;t be used completely independent from Steam, so you need to have Steam client installed in the system;</li>
<li><code>STEAM_COMPAT_DATA_PATH</code> - an equivalent for <code>WINEPREFIX</code> variable, and <code>2718988064</code> value is my <a href="#proton-prefixes">Proton prefix</a> path ID for the game, so yours is likely to be different;
<ul>
<li>if you don&rsquo;t yet have a prefix for the game, create it first (<em>with <code>winecfg</code> from your current Proton installation</em>);</li>
</ul>
</li>
<li><code>waitforexitandrun</code> is a <a href="https://github.com/GloriousEggroll/proton-ge-custom/blob/dc67f6a51b578e6ba3659600db2f50646a112887/proton#L1853">verb</a> (<em>command</em>) for Proton script (<em>you can probably replace it with <code>run</code></em>);</li>
<li><code>-launch</code> - CLI argument(s) for the game/application.</li>
</ul>
<p>That is also (<em>almost</em>) the same what Steam itself executes behind the scenes when you launch a game from Steam client. You can get a full command chain with <code>ps</code> when the game is running (<em><code>ps aux | grep &quot;SteamLaunch AppId=&quot;</code></em>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>ubuntu12_32<span style="color:#f92672">/</span>reaper <span style="color:#a6e22e">SteamLaunch</span> <span style="color:#a6e22e">AppId</span><span style="color:#66d9ef">=</span><span style="color:#ae81ff">2718988064</span> \
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">--</span> <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>ubuntu12_32<span style="color:#f92672">/</span>steam<span style="color:#f92672">-</span>launch<span style="color:#f92672">-</span>wrapper \
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">--</span> <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>steamapps<span style="color:#f92672">/</span>common<span style="color:#f92672">/</span><span style="color:#a6e22e">SteamLinuxRuntime_sniper</span><span style="color:#f92672">/</span><span style="color:#a6e22e">_v2</span><span style="color:#f92672">-</span>entry<span style="color:#f92672">-</span>point <span style="color:#f92672">--</span>verb<span style="color:#66d9ef">=</span>waitforexitandrun \
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">--</span> <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>compatibilitytools<span style="color:#f92672">.</span>d<span style="color:#f92672">/</span><span style="color:#a6e22e">GE</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Proton8</span><span style="color:#f92672">-</span><span style="color:#ae81ff">4</span><span style="color:#f92672">/</span>proton waitforexitandrun \
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">/</span>run<span style="color:#f92672">/</span>media<span style="color:#f92672">/</span>mmcblk0p1<span style="color:#f92672">/</span>games<span style="color:#f92672">/</span>diablo<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">-</span>resurrected<span style="color:#f92672">/</span>D2R<span style="color:#f92672">.</span>exe <span style="color:#f92672">-</span>launch</span></span></code></pre></div>
<!--This variant actually seems to improve the game's performance, because I got lower framerate in the same game running with "bare" Proton without all these wrappers.-->
<h2 id="filesystem">Filesystem</h2>
<p>Important paths of the system are read-only (<em>that can be disabled, though</em>), but of course there are writable paths too, at the very least because games need to store your saves and settings somewhere. User also needs to be able to store his documents/data and install additional applications and non-Steam games, which wouldn&rsquo;t be possible if the entire filesystem was read-only.</p>
<p>So the user home folder is writable:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ cd ~
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ pwd
</span></span><span style="display:flex;"><span>/home/deck
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ ls -l .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">2</span> deck deck   <span style="color:#ae81ff">4096</span> Jan <span style="color:#ae81ff">22</span> 21:55 Desktop
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">2</span> deck deck   <span style="color:#ae81ff">4096</span> Jan <span style="color:#ae81ff">27</span> 18:13 Documents
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">3</span> deck deck   <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">24</span> 18:27 Downloads
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">2</span> deck deck   <span style="color:#ae81ff">4096</span> Jan <span style="color:#ae81ff">22</span> 21:55 Music
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">3</span> deck deck   <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">24</span> 11:46 Pictures
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">2</span> deck deck   <span style="color:#ae81ff">4096</span> Jan <span style="color:#ae81ff">22</span> 21:55 Public
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">2</span> deck deck   <span style="color:#ae81ff">4096</span> Jan <span style="color:#ae81ff">22</span> 21:55 Templates
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">2</span> deck deck   <span style="color:#ae81ff">4096</span> Jan <span style="color:#ae81ff">22</span> 21:55 Videos</span></span></code></pre></div>
<p>It is also important to note that home folder contents remain untouched between OS updates. I know, it would be crazy if it was otherwise, but I still was somewhat worried about that when I first heard that SteamOS will have read-only parts and will be wiping out &ldquo;some things&rdquo; with every system update.</p>
<p>The partitions layout is unusual:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ sudo fdisk -l
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Disk /dev/nvme0n1: 476.94 GiB, <span style="color:#ae81ff">512110190592</span> bytes, <span style="color:#ae81ff">1000215216</span> sectors
</span></span><span style="display:flex;"><span>Disk model: KINGSTON OM3PDP3512B-A01
</span></span><span style="display:flex;"><span>Units: sectors of <span style="color:#ae81ff">1</span> * 512 <span style="color:#f92672">=</span> <span style="color:#ae81ff">512</span> bytes
</span></span><span style="display:flex;"><span>Sector size <span style="color:#f92672">(</span>logical/physical<span style="color:#f92672">)</span>: <span style="color:#ae81ff">512</span> bytes / <span style="color:#ae81ff">512</span> bytes
</span></span><span style="display:flex;"><span>I/O size <span style="color:#f92672">(</span>minimum/optimal<span style="color:#f92672">)</span>: <span style="color:#ae81ff">512</span> bytes / <span style="color:#ae81ff">512</span> bytes
</span></span><span style="display:flex;"><span>Disklabel type: gpt
</span></span><span style="display:flex;"><span>Disk identifier: SOME-ID
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Device            Start        End   Sectors   Size Type
</span></span><span style="display:flex;"><span>/dev/nvme0n1p1     <span style="color:#ae81ff">2048</span>     <span style="color:#ae81ff">133119</span>    <span style="color:#ae81ff">131072</span>    64M EFI System
</span></span><span style="display:flex;"><span>/dev/nvme0n1p2   <span style="color:#ae81ff">133120</span>     <span style="color:#ae81ff">198655</span>     <span style="color:#ae81ff">65536</span>    32M Microsoft basic data
</span></span><span style="display:flex;"><span>/dev/nvme0n1p3   <span style="color:#ae81ff">198656</span>     <span style="color:#ae81ff">264191</span>     <span style="color:#ae81ff">65536</span>    32M Microsoft basic data
</span></span><span style="display:flex;"><span>/dev/nvme0n1p4   <span style="color:#ae81ff">264192</span>   <span style="color:#ae81ff">10749951</span>  <span style="color:#ae81ff">10485760</span>     5G Linux root <span style="color:#f92672">(</span>x86-64<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>/dev/nvme0n1p5 <span style="color:#ae81ff">10749952</span>   <span style="color:#ae81ff">21235711</span>  <span style="color:#ae81ff">10485760</span>     5G Linux root <span style="color:#f92672">(</span>x86-64<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>/dev/nvme0n1p6 <span style="color:#ae81ff">21235712</span>   <span style="color:#ae81ff">21759999</span>    <span style="color:#ae81ff">524288</span>   256M Linux variable data
</span></span><span style="display:flex;"><span>/dev/nvme0n1p7 <span style="color:#ae81ff">21760000</span>   <span style="color:#ae81ff">22284287</span>    <span style="color:#ae81ff">524288</span>   256M Linux variable data
</span></span><span style="display:flex;"><span>/dev/nvme0n1p8 <span style="color:#ae81ff">22284288</span> <span style="color:#ae81ff">1000215175</span> <span style="color:#ae81ff">977930888</span> 466.3G Linux home
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Disk /dev/mmcblk0: 476.71 GiB, <span style="color:#ae81ff">511868665856</span> bytes, <span style="color:#ae81ff">999743488</span> sectors
</span></span><span style="display:flex;"><span>Units: sectors of <span style="color:#ae81ff">1</span> * 512 <span style="color:#f92672">=</span> <span style="color:#ae81ff">512</span> bytes
</span></span><span style="display:flex;"><span>Sector size <span style="color:#f92672">(</span>logical/physical<span style="color:#f92672">)</span>: <span style="color:#ae81ff">512</span> bytes / <span style="color:#ae81ff">512</span> bytes
</span></span><span style="display:flex;"><span>I/O size <span style="color:#f92672">(</span>minimum/optimal<span style="color:#f92672">)</span>: <span style="color:#ae81ff">512</span> bytes / <span style="color:#ae81ff">512</span> bytes
</span></span><span style="display:flex;"><span>Disklabel type: gpt
</span></span><span style="display:flex;"><span>Disk identifier: ANOTHER-ID
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Device         Start       End   Sectors   Size Type
</span></span><span style="display:flex;"><span>/dev/mmcblk0p1  <span style="color:#ae81ff">2048</span> <span style="color:#ae81ff">999741439</span> <span style="color:#ae81ff">999739392</span> 476.7G Linux filesystem</span></span></code></pre></div>
<p>As I understood it, system partitions have &ldquo;doubles&rdquo; for so-called A/B updates - to be able to rollback to previous working OS version, in case the new version has some breaking bugs or just failed to install correctly.</p>
<p>The <code>/dev/mmcblk0</code> partition is my SD-card.</p>
<p>Here&rsquo;s also <code>df</code> output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ df <span style="color:#f92672">-</span>h
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Filesystem</span>      <span style="color:#a6e22e">Size</span>  <span style="color:#a6e22e">Used</span> <span style="color:#a6e22e">Avail</span> <span style="color:#a6e22e">Use</span><span style="color:#f92672">%</span> <span style="color:#a6e22e">Mounted</span> on
</span></span><span style="display:flex;"><span>devtmpfs        <span style="color:#ae81ff">7.2</span>G     <span style="color:#ae81ff">0</span>  <span style="color:#ae81ff">7.2</span>G   <span style="color:#ae81ff">0</span><span style="color:#f92672">%</span> <span style="color:#f92672">/</span>dev
</span></span><span style="display:flex;"><span>tmpfs           <span style="color:#ae81ff">7.3</span>G  <span style="color:#ae81ff">2.0</span>G  <span style="color:#ae81ff">5.4</span>G  <span style="color:#ae81ff">27</span><span style="color:#f92672">%</span> <span style="color:#f92672">/</span>dev<span style="color:#f92672">/</span>shm
</span></span><span style="display:flex;"><span>tmpfs           <span style="color:#ae81ff">2.9</span>G  <span style="color:#ae81ff">9.9</span>M  <span style="color:#ae81ff">2.9</span>G   <span style="color:#ae81ff">1</span><span style="color:#f92672">%</span> <span style="color:#f92672">/</span>run
</span></span><span style="display:flex;"><span><span style="color:#f92672">/</span>dev<span style="color:#f92672">/</span>nvme0n1p5  <span style="color:#ae81ff">5.0</span>G  <span style="color:#ae81ff">3.3</span>G  <span style="color:#ae81ff">1.5</span>G  <span style="color:#ae81ff">69</span><span style="color:#f92672">%</span> <span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">/</span>dev<span style="color:#f92672">/</span>nvme0n1p7  <span style="color:#ae81ff">230</span>M   <span style="color:#ae81ff">41</span>M  <span style="color:#ae81ff">173</span>M  <span style="color:#ae81ff">20</span><span style="color:#f92672">%</span> <span style="color:#f92672">/</span><span style="color:#66d9ef">var</span>
</span></span><span style="display:flex;"><span>overlay         <span style="color:#ae81ff">230</span>M   <span style="color:#ae81ff">41</span>M  <span style="color:#ae81ff">173</span>M  <span style="color:#ae81ff">20</span><span style="color:#f92672">%</span> <span style="color:#f92672">/</span>etc
</span></span><span style="display:flex;"><span><span style="color:#f92672">/</span>dev<span style="color:#f92672">/</span>nvme0n1p8  <span style="color:#ae81ff">466</span>G  <span style="color:#ae81ff">378</span>G   <span style="color:#ae81ff">89</span>G  <span style="color:#ae81ff">82</span><span style="color:#f92672">%</span> <span style="color:#f92672">/</span>home
</span></span><span style="display:flex;"><span>tmpfs           <span style="color:#ae81ff">7.3</span>G  <span style="color:#ae81ff">5.5</span>M  <span style="color:#ae81ff">7.3</span>G   <span style="color:#ae81ff">1</span><span style="color:#f92672">%</span> <span style="color:#f92672">/</span>tmp
</span></span><span style="display:flex;"><span><span style="color:#f92672">/</span>dev<span style="color:#f92672">/</span>mmcblk0p1  <span style="color:#ae81ff">469</span>G  <span style="color:#ae81ff">292</span>G  <span style="color:#ae81ff">177</span>G  <span style="color:#ae81ff">63</span><span style="color:#f92672">%</span> <span style="color:#f92672">/</span>run<span style="color:#f92672">/</span>media<span style="color:#f92672">/</span>mmcblk0p1
</span></span><span style="display:flex;"><span>tmpfs           <span style="color:#ae81ff">1.5</span>G  <span style="color:#ae81ff">6.5</span>M  <span style="color:#ae81ff">1.5</span>G   <span style="color:#ae81ff">1</span><span style="color:#f92672">%</span> <span style="color:#f92672">/</span>run<span style="color:#f92672">/</span>user<span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span></span></span></code></pre></div>
<p>So right now I have 89 GB left on system disk and 177 GB on SD-card.</p>
<p>The Steam itself is installed here:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ tree -d -L <span style="color:#ae81ff">1</span> /home/deck/.local/share/Steam/
</span></span><span style="display:flex;"><span>├── appcache
</span></span><span style="display:flex;"><span>├── bin
</span></span><span style="display:flex;"><span>├── clientui
</span></span><span style="display:flex;"><span>├── compatibilitytools.d
</span></span><span style="display:flex;"><span>├── config
</span></span><span style="display:flex;"><span>├── controller_base
</span></span><span style="display:flex;"><span>├── depotcache
</span></span><span style="display:flex;"><span>├── friends
</span></span><span style="display:flex;"><span>├── graphics
</span></span><span style="display:flex;"><span>├── legacycompat
</span></span><span style="display:flex;"><span>├── linux32
</span></span><span style="display:flex;"><span>├── linux64
</span></span><span style="display:flex;"><span>├── logs
</span></span><span style="display:flex;"><span>├── music
</span></span><span style="display:flex;"><span>├── package
</span></span><span style="display:flex;"><span>├── public
</span></span><span style="display:flex;"><span>├── resource
</span></span><span style="display:flex;"><span>├── servers
</span></span><span style="display:flex;"><span>├── steam
</span></span><span style="display:flex;"><span>├── steamapps
</span></span><span style="display:flex;"><span>├── steamui
</span></span><span style="display:flex;"><span>├── tenfoot
</span></span><span style="display:flex;"><span>├── ubuntu12_32
</span></span><span style="display:flex;"><span>├── ubuntu12_64
</span></span><span style="display:flex;"><span>└── userdata</span></span></code></pre></div>
<p>The most interesting folder is <code>/home/deck/.local/share/Steam/steamapps/</code> - that is where Steam games are installed and also where <a href="#proton-prefixes">Proton prefixes</a> are stored (<em>for both Steam and non-Steam games and applications</em>).</p>
<h3 id="proton-prefixes">Proton prefixes</h3>
<p>Each game has a <a href="#proton">Proton</a> prefix created for it in <code>/home/deck/.local/share/Steam/steamapps/compatdata/STEAM-APP-ID/</code>. Every prefix has its own Windows environment (<em>or an &ldquo;emulation&rdquo; of it</em>): system libraries, registry and other usual files and folders like <code>Program Files</code>, <code>Documents</code> and so on.</p>
<p>For Steam games the <code>STEAM-APP-ID</code> value is known, you can get it either from the game&rsquo;s Steam store URL or from <a href="https://steamdb.info">SteamDB</a>. For non-Steam games the <code>STEAM-APP-ID</code> is not known beforehand and is generated using some hashing function, making it difficult to find the game&rsquo;s Proton prefix path. If you have just installed the game, then you can sort the list of Proton prefixes by date, and the last one will likely be the one created for this game:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ ls <span style="color:#f92672">-</span>ltr <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>steamapps<span style="color:#f92672">/</span>compatdata<span style="color:#f92672">/</span></span></span></code></pre></div>
<p>But if you need to find the prefix path days/weeks/months later, when you installed some more games after that one, then it you really are screwed. I would reckon, there must be some dictionary somewhere, because Steam does now which prefix path is for which game, but I couldn&rsquo;t find where this information is stored.</p>
<p>For example, I needed to find Proton prefix path for <a href="#civilization-vi">Civilization VI</a>. First I tried to parse <code>~/.local/share/Steam/userdata/YOUR-ACCOUNT-ID/config/shortcuts.vdf</code> (<em><a href="https://developer.valvesoftware.com/wiki/Add_Non-Steam_Game">VDF</a></em>) using this <a href="https://github.com/ValvePython/vdf">Python library</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> vdf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;./shortcuts.vdf&#34;</span>, <span style="color:#e6db74">&#34;rb&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    d <span style="color:#f92672">=</span> vdf<span style="color:#f92672">.</span>binary_loads(f<span style="color:#f92672">.</span>read())
</span></span><span style="display:flex;"><span>    print(vdf<span style="color:#f92672">.</span>dumps(d, pretty<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>))</span></span></code></pre></div>
<p>The file contains some useful information:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;appid&#34;</span> <span style="color:#e6db74">&#34;-937784833&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;AppName&#34;</span> <span style="color:#e6db74">&#34;Civilization VI&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Exe&#34;</span> <span style="color:#e6db74">&#34;\&#34;/run/media/mmcblk0p1/games/civilization-vi/Base/Binaries/Win64Steam/CivilizationVI_DX12.exe\&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;StartDir&#34;</span> <span style="color:#e6db74">&#34;\&#34;/run/media/mmcblk0p1/games/civilization-vi/Base/Binaries/Win64Steam/\&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;icon&#34;</span> <span style="color:#e6db74">&#34;/home/deck/Pictures/steamgrid/civilization-vi/icon.ico&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;ShortcutPath&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;LaunchOptions&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;IsHidden&#34;</span> <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;AllowDesktopConfig&#34;</span> <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;AllowOverlay&#34;</span> <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;OpenVR&#34;</span> <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Devkit&#34;</span> <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;DevkitGameID&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;DevkitOverrideAppID&#34;</span> <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;LastPlayTime&#34;</span> <span style="color:#e6db74">&#34;1680625818&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;FlatpakAppID&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;tags&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span></span></span></code></pre></div>
<p>but <code>-937784833</code> value is not a real ID, at least it is not what I could use to find the game prefix in <code>compatdata</code>.</p>
<p>Then I found a suggestion to create a Desktop shortcut for the game in Steam, and I did, but again, the ID provided there is not the one from <code>compatdata</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#a6e22e">$ less /home/deck/Desktop/Civilization\ VI.desktop</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[Desktop Entry]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Name</span><span style="color:#f92672">=</span><span style="color:#e6db74">Civilization VI</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Comment</span><span style="color:#f92672">=</span><span style="color:#e6db74">Play this game on Steam</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Exec</span><span style="color:#f92672">=</span><span style="color:#e6db74">steam steam://rungameid/14418988885323284480</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Icon</span><span style="color:#f92672">=</span><span style="color:#e6db74">steam_icon_14418988885323284480</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Terminal</span><span style="color:#f92672">=</span><span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Type</span><span style="color:#f92672">=</span><span style="color:#e6db74">Application</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Categories</span><span style="color:#f92672">=</span><span style="color:#e6db74">Game;</span></span></span></code></pre></div>
<p>So what I had to do is to check every motherfucking single folder inside <code>compatdata</code> until I found the one that contained <code>./pfx/drive_c/users/steamuser/Documents/My\ Games/Sid\ Meier's\ Civilization\ VI</code>, so the Proton prefix path for Civilization IV in my case was <code>/home/deck/.local/share/Steam/steamapps/compatdata/3357182463/</code>.</p>
<p>Out of curiosity, I tried searching for the <code>3357182463</code> value in files:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ grep <span style="color:#f92672">--</span>include<span style="color:#f92672">=\*.{</span>vdf<span style="color:#f92672">,</span>json<span style="color:#f92672">,</span>txt<span style="color:#f92672">}</span> <span style="color:#f92672">-</span>irn <span style="color:#f92672">~/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span> <span style="color:#f92672">-</span>e <span style="color:#e6db74">&#34;3357182463&#34;</span></span></span></code></pre></div>
<p>but that didn&rsquo;t result in anything useful. Then, following someone&rsquo;s good advice, I launched the game and looked for its ID in the <code>ps</code> output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ ps aux <span style="color:#f92672">|</span> grep <span style="color:#ae81ff">3357182463</span>
</span></span><span style="display:flex;"><span>deck      <span style="color:#ae81ff">120827</span>  <span style="color:#ae81ff">0.0</span>  <span style="color:#ae81ff">0.0</span>  <span style="color:#ae81ff">28116</span>  <span style="color:#ae81ff">5556</span> <span style="color:#f92672">?</span>        S    <span style="color:#ae81ff">12</span><span style="color:#66d9ef">:</span><span style="color:#960050;background-color:#1e0010">50</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#66d9ef">:</span><span style="color:#960050;background-color:#1e0010">00</span> <span style="color:#66d9ef">/home/deck/.local/share/Steam/ubuntu12_32/reaper</span> <span style="color:#66d9ef">SteamLaunch</span> <span style="color:#66d9ef">AppId</span><span style="color:#f92672">=</span><span style="color:#ae81ff">3357182463</span> <span style="color:#f92672">--</span> <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>ubuntu12_32<span style="color:#f92672">/</span>steam<span style="color:#f92672">-</span>launch<span style="color:#f92672">-</span>wrapper <span style="color:#f92672">--</span> <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>steamapps<span style="color:#f92672">/</span>common<span style="color:#f92672">/</span><span style="color:#a6e22e">SteamLinuxRuntime_soldier</span><span style="color:#f92672">/</span><span style="color:#a6e22e">_v2</span><span style="color:#f92672">-</span>entry<span style="color:#f92672">-</span>point <span style="color:#f92672">--</span>verb<span style="color:#66d9ef">=</span>waitforexitandrun <span style="color:#f92672">--</span> <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>steamapps<span style="color:#f92672">/</span>common<span style="color:#f92672">/</span><span style="color:#a6e22e">Proton</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">Experimental</span><span style="color:#f92672">/</span>proton waitforexitandrun <span style="color:#f92672">/</span>run<span style="color:#f92672">/</span>media<span style="color:#f92672">/</span>mmcblk0p1<span style="color:#f92672">/</span>games<span style="color:#f92672">/</span>civilization<span style="color:#f92672">-</span>vi<span style="color:#f92672">/</span><span style="color:#a6e22e">Base</span><span style="color:#f92672">/</span><span style="color:#a6e22e">Binaries</span><span style="color:#f92672">/</span><span style="color:#a6e22e">Win64Steam</span><span style="color:#f92672">/</span><span style="color:#a6e22e">CivilizationVI_DX12</span><span style="color:#f92672">.</span>exe</span></span></code></pre></div>
<p>And there it fucking was! So there is at least one alternative to going through all the folders inside <code>compatdata</code> - you can launch the game and grep for <code>steam-launch-wrapper</code> or <code>&quot;SteamLaunch AppId=&quot;</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ ps aux <span style="color:#f92672">|</span> grep <span style="color:#e6db74">&#34;SteamLaunch AppId=&#34;</span></span></span></code></pre></div>
<p>Of course, an even better alternative would be to get the hashing function that generates these IDs for non-Steam games (<em>if those aren&rsquo;t just random values</em>), but sadly I haven&rsquo;t found it yet. Well, I found <a href="https://gaming.stackexchange.com/a/386883/131033">this answer</a> and made the following script out of it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> pathlib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> binascii
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pycrc.algorithms
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getSteamShortcutID</span>(executablePath, applicationName, bigPicture<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>):
</span></span><span style="display:flex;"><span>    exeAndName <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join((executablePath, applicationName))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> bigPicture:
</span></span><span style="display:flex;"><span>        generatedID <span style="color:#f92672">=</span> binascii<span style="color:#f92672">.</span>crc32(str<span style="color:#f92672">.</span>encode(exeAndName)) <span style="color:#f92672">|</span> <span style="color:#ae81ff">0x80000000</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> generatedID
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        algorithm <span style="color:#f92672">=</span> pycrc<span style="color:#f92672">.</span>algorithms<span style="color:#f92672">.</span>Crc(
</span></span><span style="display:flex;"><span>            width<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span>,
</span></span><span style="display:flex;"><span>            poly<span style="color:#f92672">=</span><span style="color:#ae81ff">0x04C11DB7</span>,
</span></span><span style="display:flex;"><span>            reflect_in<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>            xor_in<span style="color:#f92672">=</span><span style="color:#ae81ff">0xffffffff</span>,
</span></span><span style="display:flex;"><span>            reflect_out<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>            xor_out<span style="color:#f92672">=</span><span style="color:#ae81ff">0xffffffff</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        top32 <span style="color:#f92672">=</span> algorithm<span style="color:#f92672">.</span>bit_by_bit(exeAndName) <span style="color:#f92672">|</span> <span style="color:#ae81ff">0x80000000</span>
</span></span><span style="display:flex;"><span>        full64 <span style="color:#f92672">=</span> (top32 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">32</span>) <span style="color:#f92672">|</span> <span style="color:#ae81ff">0x02000000</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> str(full64)</span></span></code></pre></div>
<p>But I still couldn&rsquo;t get the <code>3357182463</code> value:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># that prints 3368690363</span>
</span></span><span style="display:flex;"><span>print(
</span></span><span style="display:flex;"><span>    getSteamShortcutID(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">/run/media/mmcblk0p1/games/civilization-vi/Base/Binaries/Win64Steam/CivilizationVI_DX12.exe</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Civilization VI&#34;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># that prints 3878048937</span>
</span></span><span style="display:flex;"><span>print(
</span></span><span style="display:flex;"><span>    getSteamShortcutID(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;/run/media/mmcblk0p1/games/civilization-vi/Base/Binaries/Win64Steam/CivilizationVI_DX12.exe&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Civilization VI&#34;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div>
<p>Then I realized that the moment when prefix was created I was running the game installer, not the game yet, so of course the values were different, so I tried these instead:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># that prints 2946059079</span>
</span></span><span style="display:flex;"><span>print(
</span></span><span style="display:flex;"><span>    getSteamShortcutID(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">/home/deck/Downloads/civilization-vi/installer/civ6-setup.exe</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;civ6-setup.exe&#34;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># that prints 3987467170</span>
</span></span><span style="display:flex;"><span>print(
</span></span><span style="display:flex;"><span>    getSteamShortcutID(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;/home/deck/Downloads/civilization-vi/installer/civ6-setup.exe&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;civ6-setup.exe&#34;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div>
<p>but still didn&rsquo;t get that value. Just to make sure that I didn&rsquo;t have different paths back then, I&rsquo;ve added a new non-Steam game (<em>DirectX installer</em>) and immediately checked what prefix ID it got in <code>compatdata</code> - it was <code>3529560334</code>. The record in <code>shortcuts.vdf</code> was as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;appid&#34;</span> <span style="color:#e6db74">&#34;-765406962&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;AppName&#34;</span> <span style="color:#e6db74">&#34;directx_Jun2010_redist.exe&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Exe&#34;</span> <span style="color:#e6db74">&#34;\&#34;/home/deck/Downloads/soft/directx_Jun2010_redist.exe\&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;StartDir&#34;</span> <span style="color:#e6db74">&#34;/home/deck/Downloads/soft/&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;icon&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;ShortcutPath&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;LaunchOptions&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;IsHidden&#34;</span> <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;AllowDesktopConfig&#34;</span> <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;AllowOverlay&#34;</span> <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;OpenVR&#34;</span> <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Devkit&#34;</span> <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;DevkitGameID&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;DevkitOverrideAppID&#34;</span> <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;LastPlayTime&#34;</span> <span style="color:#e6db74">&#34;1680876341&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;FlatpakAppID&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;tags&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div>
<p>But even now I couldn&rsquo;t get the right value! Look:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># that prints 3607144885</span>
</span></span><span style="display:flex;"><span>print(
</span></span><span style="display:flex;"><span>    getSteamShortcutID(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">/home/deck/Downloads/soft/directx_Jun2010_redist.exe</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;directx_Jun2010_redist.exe&#34;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># that prints 2731245913</span>
</span></span><span style="display:flex;"><span>print(
</span></span><span style="display:flex;"><span>    getSteamShortcutID(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;/home/deck/Downloads/soft/directx_Jun2010_redist.exe&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;directx_Jun2010_redist.exe&#34;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div>
<p>Moreover, I removed it from Steam, removed the prefix folder and added the absolutely same executable as a non-Steam game again. And it got a different ID - this time <code>3589718663</code>! Fucking hell, I give up. It probably uses more components for generating the hash, maybe a timestamp or something, but I am <a href="https://gaming.stackexchange.com/q/402316/131033">out of ideas</a>.</p>
<p>So the only way to get the right ID is to <code>grep</code> the <code>ps</code> output. Or write it down right after the prefix is created.</p>
<h3 id="screenshots">Screenshots</h3>
<p>The screenshots you make in Gaming mode are saved to <code>/home/deck/.local/share/Steam/userdata/YOUR-ACCOUNT-ID/760/remote/SOME-OTHER-ID/screenshots/</code>. In particular, the screenshots of the Gaming GUI itself are stored in <code>/home/deck/.local/share/Steam/userdata/YOUR-ACCOUNT-ID/760/remote/7/screenshots/</code>.</p>
<p>For Steam games the <code>SOME-OTHER-ID</code> value matches the Steam App ID, but for non-Steam games it&rsquo;s rather random, as far as I can tell. For example, I found that Civilization VI got the ID <code>3357182463</code>, but its screenshots are located under a different ID: <code>/home/deck/.local/share/Steam/userdata/YOUR-ACCOUNT-ID/760/remote/1739263/screenshots/</code>. I have no idea how I could&rsquo;ve known this ID other then from checking every folder and viewing the screenshots.</p>
<p>Finally, the screenshots you make in Desktop mode with <a href="https://apps.kde.org/spectacle/">Spectacle</a> are saved to <code>/home/deck/Pictures/</code>.</p>
<h3 id="controller-layouts">Controller layouts</h3>
<p>I needed to find where controller layouts are saved to, so I could to make backups of the ones I&rsquo;ve created. In addition to that, one might want to share layouts as files and download layouts shared by other people without using Steam UI.</p>
<p>I started looking for the files named <code>controller_configuration.vdf</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ find <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span> <span style="color:#f92672">-</span>iname <span style="color:#e6db74">&#34;controller_configuration.vdf&#34;</span></span></span></code></pre></div>
<p>That gave me two places:</p>
<ul>
<li><code>/home/deck/.local/share/Steam/userdata/YOUR-ACCOUNT-ID/config/controller_configs/apps/0/ANOTHER-ID/YET-ANOTHER-ID</code> - here, as I understand, every <code>YET-ANOTHER-ID</code> contains the layouts that I exported as <code>New Template</code>;</li>
<li><code>/home/deck/.local/share/Steam/steamapps/workshop/content/DIFFERENT-ID/AND-ANOTHER-ID</code> - here are those that I exported as <code>New Personal Save</code>.</li>
</ul>
<p>That second path with personal saves contains a lot of different <code>AND-ANOTHER-ID</code> (<em>and these are not Steam App IDs</em>), so it will be difficult to find layouts for a particular game. In addition, some of the filenames here are not <code>controller_configuration.vdf</code> but <code>SOME-ID-legacy.bin</code>.</p>
<p>Fortunately, there is a file with the mapping for Steam App ID values or game titles: <code>/home/deck/.local/share/Steam/steamapps/common/Steam Controller Configs/YOUR-ACCOUNT-ID/config/configset_controller_neptune.vdf</code>. Aside from that, you can also get the <code>AND-ANOTHER-ID</code> value by openning Layout Details of the selected layout in Gaming mode UI.</p>
<p>That path (<code>/.../Steam Controller Configs/YOUR-ACCOUNT-ID/config/</code>) is also used for saving controller layouts that you create yourself by modifying default templates.</p>
<p>So there you have it. You can now make backup copies of your layouts, upload the files somewhere to share with others and download layouts shared by others.</p>
<p>The backups have proven to be useful very soon. I tried to play <a href="#diablo-ii-resurrected">Diablo II</a> on <a href="#connecting-to-external-display-or-tv">TV</a> and switched to the DualSense gamepad layout, which apparently did something rather unexpected, because when I undocked and tried to select my layout again, it was no loger available. Looks like it was gone from the <code>workshop</code> folder, which apparently matters for some reasons. Good thing that I had a backup, and also I still had the layout available in <code>/home/deck/.local/share/Steam/steamapps/common/Steam Controller Configs/YOUR-ACCOUNT-ID/config/diablo ii resurrected/controller_neptune.vdf</code>, so I copied it to <code>workshop</code> (<em>according to the mapping in <code>configset_controller_neptune.vdf</code></em>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ cp <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    <span style="color:#e6db74">&#34;/home/deck/.local/share/Steam/steamapps/common/Steam Controller Configs/YOUR-ACCOUNT-ID/config/diablo ii resurrected/controller_neptune.vdf&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    /home/deck/.local/share/Steam/steamapps/workshop/content/DIFFERENT-ID/ANOTHER-DIFFERENT-ID/LONG-ID_legacy.bin</span></span></code></pre></div>
<p>and then I got my layout back, but now I am confused about having more than one path where layouts are. Which one is actually used when I make changes in the layouts that I created? To find out, I did a quick test: edited one command name in the layout and checked which of the files have changed. The one that got this change was <code>/.../Steam Controller Configs/YOUR-ACCOUNT-ID/config/diablo ii resurrected/controller_neptune.vdf</code>, while the one in <code>workshop</code> hasn&rsquo;t changed. So what is the point of having that one there?</p>
<p>I also thought it&rsquo;ll be a good idea to put my layouts <a href="https://github.com/retifrav/steam-deck-controller-layouts">under version control</a>, since they are just plain text files.</p>
<h3 id="backup-script">Backup script</h3>
<p>Sooner or later you&rsquo;d want to backup certain things: savegames, configs, controller layouts, screenshots, a list of installed packages and so on. To do that you&rsquo;ll need to find the paths to all these things, and once you do, you&rsquo;ll probably also want to automate the process.</p>
<p>I&rsquo;ve come up with the following script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>brew --version &gt; /dev/null
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $? -ne <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;[ERROR] You haven&#39;t activated Homebrew environment&#34;</span> &gt;&amp;<span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>archName<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;backup-</span><span style="color:#66d9ef">$(</span>date +%Y%m%d-%H%M%S<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>workingdir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/home/deck/backups/</span>$archName<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>mkdir -p $workingdir
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pathToSteam<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/home/deck/.local/share/Steam&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>declare -a thingsToCopy<span style="color:#f92672">=(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># files</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;/home/deck/.bash_profile&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># folders</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#/home/deck/Pictures</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SECONDS<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[STATUS] 1/3 Saving a list of installed Homebrew packages
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>brew bundle dump --file $workingdir/home.brewfile
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[STATUS] 2/3 Copying files
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># copy</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>thingsToCopy[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>   echo <span style="color:#e6db74">&#34;- copying [</span>$i<span style="color:#e6db74">]...&#34;</span>
</span></span><span style="display:flex;"><span>   cp -r <span style="color:#e6db74">&#34;</span>$i<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$workingdir<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[STATUS] 3/3 Packing stuff
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># scripts</span>
</span></span><span style="display:flex;"><span>tar -czf $workingdir/scripts.tar.gz /home/deck/bin/*.sh
</span></span><span style="display:flex;"><span><span style="color:#75715e"># pictures</span>
</span></span><span style="display:flex;"><span>tar -czf $workingdir/pictures.tar.gz /home/deck/Pictures
</span></span><span style="display:flex;"><span><span style="color:#75715e"># screenshots</span>
</span></span><span style="display:flex;"><span>tar -czf $workingdir/screenshots.tar.gz <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>pathToSteam<span style="color:#e6db74">}</span><span style="color:#e6db74">/userdata/YOUR-ACCOUNT-ID/760&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Diablo II Resurrected</span>
</span></span><span style="display:flex;"><span>tar -czf $workingdir/diablo-2-resurrected.tar.gz <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>pathToSteam<span style="color:#e6db74">}</span><span style="color:#e6db74">/steamapps/compatdata/STEAM-APP-ID/pfx/drive_c/users/steamuser/Documents/Diablo II Resurrected/Save/&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>pathToSteam<span style="color:#e6db74">}</span><span style="color:#e6db74">/steamapps/common/Steam Controller Configs/YOUR-ACCOUNT-ID/config/diablo ii resurrected/controller_neptune.vdf&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Space Rangers</span>
</span></span><span style="display:flex;"><span>tar -czf $workingdir/space-rangers.tar.gz <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>pathToSteam<span style="color:#e6db74">}</span><span style="color:#e6db74">/steamapps/compatdata/214730/pfx/drive_c/users/steamuser/Documents/spacerangershd/&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>pathToSteam<span style="color:#e6db74">}</span><span style="color:#e6db74">/steamapps/common/Steam Controller Configs/YOUR-ACCOUNT-ID/config/214730/controller_neptune.vdf&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>duration<span style="color:#f92672">=</span>$SECONDS
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;---
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Total time: </span><span style="color:#66d9ef">$((</span>$duration <span style="color:#f92672">/</span> <span style="color:#ae81ff">60</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">60</span><span style="color:#66d9ef">))</span><span style="color:#e6db74"> hours, </span><span style="color:#66d9ef">$((</span>$duration <span style="color:#f92672">/</span> <span style="color:#ae81ff">60</span> <span style="color:#f92672">%</span> <span style="color:#ae81ff">60</span><span style="color:#66d9ef">))</span><span style="color:#e6db74"> minutes and </span><span style="color:#66d9ef">$((</span>$duration <span style="color:#f92672">%</span> <span style="color:#ae81ff">60</span><span style="color:#66d9ef">))</span><span style="color:#e6db74"> seconds&#34;</span></span></span></code></pre></div>
<p>Note that paths to savegames, settings and other things within the game&rsquo;s Proton profix might change on the next Proton update, like it happened for me with <a href="#savegame-path-change-after-proton-update">Diablo II and Proton 8</a>.</p>
<h2 id="shader-cache">Shader cache</h2>
<p><a href="https://youtu.be/ZZJ4lUOnuZA">This video</a> will most probably tell about shaders and pre-compiled shader cache better than me.</p>
<p>But here&rsquo;s also my (<em>much less detailed</em>) interpretation. A shader is a visual effect, such as lighting/shadows/materials applied to an object in a game. But it&rsquo;s not a static file/asset which could be distributed together with other assets/resources of the game. It is actually a set of commands to be executed/compiled on a GPU on the target device, and the result of this execution will be different for different GPUs.</p>
<p>The compilation of shaders naturally takes some computing time, and it happens when you are actually playing the game (<em>or on its launch</em>), which results in freezes/stutters in the game, for example when you enter a new area/location. Once compiled, shaders are cached locally on disk, so the next time you enter this same area/location you won&rsquo;t get freezes/stutters.</p>
<p>Another thing to say about shader cache is that it occupies quite a lot of space on your system disk (<em>yes, it has to be on system disk, and it is not advisable to symlink this location to SD card</em>). You can check for yourself how much exactly:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ du <span style="color:#f92672">-</span>hs <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>steam<span style="color:#f92672">/</span>steam<span style="color:#f92672">/</span>steamapps<span style="color:#f92672">/</span>shadercache<span style="color:#f92672">/</span></span></span></code></pre></div>
<p>To see the cache size per game, add the game&rsquo;s Steam App ID to that path. By the way, that&rsquo;s how you can check that your non-Steam game do actually produce shader cache too. For instance my <a href="#diablo-ii-resurrected">Diablo II Resurrected</a> has generated 132 MB of caches over a month of playing.</p>
<h3 id="pre-caching-updates">Pre-caching updates</h3>
<p>Since all the Steam Decks on the planet have the same GPU, wouldn&rsquo;t it be a great idea to pre-compile shaders for games just once and distribute this pre-compiled cache across all the Steam Decks over the internet in a form of Steam game updates, so those devices wouldn&rsquo;t need to waste their computing power on compiling the same shaders themselves.</p>
<p>The idea sounds great, but I can&rsquo;t say how useful it really is, because I have been playing quite a number of <a href="#games">non-Steam games</a>, which obviously do not benefit from distributed pre-compiled shader cache, and I didn&rsquo;t experience any noticable issues due to the lack of pre-compiled shaders. It&rsquo;s fine for me to let shaders compile during my playtime for the first time, I don&rsquo;t even notice when it happens, and once they are compiled I still get the cache and will benefit from having it going forward.</p>
<p>What I can say about the idea of distributing pre-compiled cache is that it is rather annoying to be constantly receiving those pre-caching updates. I mean, what is this madness with Skyrim, as I get an &ldquo;update&rdquo; for it every couple of days (<em>or even several times per day</em>):</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/shader-cache/skyrim-pre-caching-update-1.jpg" alt="Steam Deck, Skyrim pre-caching update">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/shader-cache/skyrim-pre-caching-update-2.jpg" alt="Steam Deck, Skyrim pre-caching update">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/shader-cache/skyrim-pre-caching-update-3.jpg" alt="Steam Deck, Skyrim pre-caching update">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/shader-cache/skyrim-pre-caching-update-4.jpg" alt="Steam Deck, Skyrim pre-caching update">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/shader-cache/skyrim-pre-caching-update-5.jpg" alt="Steam Deck, Skyrim pre-caching update">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/shader-cache/skyrim-pre-caching-update-6.jpg" alt="Steam Deck, Skyrim pre-caching update">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/shader-cache/skyrim-pre-caching-update-7.jpg" alt="Steam Deck, Skyrim pre-caching update">

</p>
<p>And every time I get these I have the same version of SteamOS, same drivers, same game version, same everything (<em>except for maybe Proton Experimental version?</em>). So what is it so new about shaders in this game (<em>which has been released several years ago</em>) that I need to get updates for it every week?</p>
<p>Some games shader updates are obscenely big, so the lads with metered internet connection are screwed:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/shader-cache/resident-evil-2-pre-caching-update.jpg" alt="Steam Deck, Resident Evil 2 pre-caching update">

<p>And some updates are just hilarious: what could be possibly new about <a href="#civilization-v">Civilization V</a> shaders, as the game was released in 2010 and I installed it more than a month ago:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/shader-cache/civilization-v-pre-caching-update.jpg" alt="Steam Deck, Resident Evil 2 pre-caching update">

<p>Yeah, as far as I can tell, for me this distributed shader cache doesn&rsquo;t seem to bring more value than it brings annoyance:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/shader-cache/time-for-shader-updates.jpg" alt="Steam Deck, time for pre-caching updates">

<p>So I personally would like to be able to disable this feature of &ldquo;pre-caching updates&rdquo;.</p>
<h2 id="sleep-suspend-and-resume">Sleep, suspend and resume</h2>
<p>I did not expect this to work (<em>didn&rsquo;t even know that Steam Deck will have this feature</em>), but it does. You can press the power button while playing a game, and Steam Deck will go to sleep (<em>you can also connect it to charger meanwhile</em>). Then, some time later, you press the power button again, Steam Deck wakes up, and you can continue playing your game from where you left it.</p>
<p>Very convenient and useful feature. I imagine, it was very hard to properly implement too.</p>
<p>Some games, however, do have certain issues related to that. For instance, XCOM 2 being resumed like this gets echoing/lagging effect for any sounds in the game, which you can only get rid of by restarting the game, which renders the whole sleep functionality somewhat useless - it&rsquo;s no joy to continue playing with the sound beeing messed up like this. On the bright side, so far XCOM 2 is the only game in which I got this behaviour, so it could be that it&rsquo;s actually the game&rsquo;s fault.</p>
<h2 id="ssh-access">SSH access</h2>
<p>You would most definitely want to establish SSH connection to your Steam Deck. The procedure is nothing special, all the steps are the same as with any other GNU/Linux host.</p>
<p>Generate a key on the machine from which you&rsquo;ll be connecting to Steam Deck:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ cd <span style="color:#f92672">~/.</span>ssh
</span></span><span style="display:flex;"><span>$ ssh<span style="color:#f92672">-</span>keygen <span style="color:#f92672">-</span>t ed25519 <span style="color:#f92672">-</span>a <span style="color:#ae81ff">100</span> <span style="color:#f92672">-</span>C <span style="color:#e6db74">&#34;YOUR-NAME@YOUR-MACHINE&#34;</span></span></span></code></pre></div>
<p>Call it whatever you like, for example <code>steamdeck</code>, no need to set a password. Add a new section to <code>~/.ssh/config</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">Host</span> steamdeck
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">HostName</span> <span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1.10</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">IdentityFile</span> <span style="color:#f92672">~/.</span>ssh<span style="color:#f92672">/</span>steamdeck
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">User</span> deck</span></span></code></pre></div>
<p>The <code>192.168.1.10</code> IP address is just an example, you of course need to set yours there. And for it to persist between Steam Deck reboots you&rsquo;ll need to reserve it in your router DHCP settings with your Steam Deck&rsquo;s MAC address. By the way, if you&rsquo;d want to be able to connect to it via either Ethernet or Wi-Fi, then obviously you&rsquo;ll need to reserve 2 IP addresses (<em>one per MAC address</em>) and to have 2 sections in <code>~/.ssh/config</code>, for example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">Host</span> steamdeck
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">HostName</span> <span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1.10</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">IdentityFile</span> <span style="color:#f92672">~/.</span>ssh<span style="color:#f92672">/</span>steamdeck
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">User</span> deck
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Host</span> steamdeck<span style="color:#f92672">-</span>wifi
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">HostName</span> <span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1.11</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">IdentityFile</span> <span style="color:#f92672">~/.</span>ssh<span style="color:#f92672">/</span>steamdeck
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">User</span> deck</span></span></code></pre></div>
<p>Switch to Desktop mode on your Steam Deck. Add the contents of <code>~/.ssh/steamdeck.pub</code> file from your machine (<em>public SSH key</em>) to <code>~/.ssh/authorized_keys</code> file on Steam Deck. Since you don&rsquo;t have a connection established to your Steam Deck yet, you can save the key as a text file and transfer it to Steam Deck on SD-card. Alternatively, if you have a web-server, just put the file there and fetch it on Steam Deck with cURL:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ curl <span style="color:#f92672">-</span>O <span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1.111</span><span style="color:#f92672">/</span>key
</span></span><span style="display:flex;"><span>$ cat <span style="color:#f92672">./</span>key <span style="color:#f92672">&gt;&gt;</span> <span style="color:#f92672">~/.</span>ssh<span style="color:#f92672">/</span>authorized_keys
</span></span><span style="display:flex;"><span>$ rm <span style="color:#f92672">./</span>key
</span></span><span style="display:flex;"><span>$ echo <span style="color:#e6db74">&#34;And also remove the file from web-server&#34;</span></span></span></code></pre></div>
<p>Check that SSH service settings on Steam Deck do not allow using passwords, so SSH key is the only way to authenticate a connection:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ sudo nano <span style="color:#f92672">/</span>etc<span style="color:#f92672">/</span>ssh<span style="color:#f92672">/</span>sshd_config</span></span></code></pre></div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">PasswordAuthentication</span> no
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PermitEmptyPasswords</span> no
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ChallengeResponseAuthentication</span> no</span></span></code></pre></div>
<p>And then you can finally start the SSH service on Steam Deck:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ sudo systemctl start sshd<span style="color:#f92672">.</span>service</span></span></code></pre></div>
<p>Now you can connect to your Steam Deck via SSH from your machine (<em>replace <code>steamdeck</code> with whatever you called it in your <code>~/.ssh/config</code></em>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ ssh steamdeck</span></span></code></pre></div>
<p>Surely enough, now you can also transfer files to/from it using any SFTP client (<em><a href="https://filezilla-project.org/download.php">FileZilla</a>, <a href="https://panic.com/transmit/">Transmit</a>, <a href="https://cyberduck.io">Cyberduck</a>, etc</em>), which is probably the main reason why you wanted to establish SSH access to your Steam Deck in the first place.</p>
<p>It&rsquo;s probably also worth to mention that it doesn&rsquo;t matter whether your Steam Deck is in Desktop or Gaming mode - you can still connect to it, as long as SSH service is running.</p>
<p>The SSH service will be running until the next system reboot (<em>switching Desktop/Gaming mode doesn&rsquo;t count</em>), because the service isn&rsquo;t set to auto-start. I would recommend to keep it that way, and ideally you&rsquo;d also stop the service once you&rsquo;ve done everything you needed to do over SSH. Yes, it is inconvenient, and next time you&rsquo;ll need to connect via SSH you&rsquo;ll have to open Terminal/Konsole and start the service again, but I think it&rsquo;s a good security precaution.</p>
<h2 id="monitoring-the-temperature">Monitoring the temperature</h2>
<p>You can monitor the device temperature (<em>and other metrics</em>) with <code>sensors</code> command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ watch sensors</span></span></code></pre></div>
<p>I used that to see how compiling from sources goes, and here&rsquo;s what <code>sensors</code> were reporting during 100% load on all 4/8 CPU cores for a period of time:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>amdgpu-pci-0400
</span></span><span style="display:flex;"><span>Adapter: PCI adapter
</span></span><span style="display:flex;"><span>vddgfx:       15.00 mV
</span></span><span style="display:flex;"><span>vddnb:       669.00 mV
</span></span><span style="display:flex;"><span>edge:         +83.0°C
</span></span><span style="display:flex;"><span>slowPPT:      16.17 W  <span style="color:#f92672">(</span>cap <span style="color:#f92672">=</span>  15.00 W<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>fastPPT:      16.17 W  <span style="color:#f92672">(</span>cap <span style="color:#f92672">=</span>  15.00 W<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BAT1-acpi-0
</span></span><span style="display:flex;"><span>Adapter: ACPI interface
</span></span><span style="display:flex;"><span>in0:           8.75 V
</span></span><span style="display:flex;"><span>curr1:       706.00 mA
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>jupiter-isa-0000
</span></span><span style="display:flex;"><span>Adapter: ISA adapter
</span></span><span style="display:flex;"><span>PD Contract Voltage:  15.00 V
</span></span><span style="display:flex;"><span>System Fan:          <span style="color:#ae81ff">5674</span> RPM
</span></span><span style="display:flex;"><span>Battery Temp:         +33.0°C
</span></span><span style="display:flex;"><span>PD Contract Current:   3.00 A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nvme-pci-0100
</span></span><span style="display:flex;"><span>Adapter: PCI adapter
</span></span><span style="display:flex;"><span>Composite:    +49.9°C  <span style="color:#f92672">(</span>low  <span style="color:#f92672">=</span>  -0.1°C, high <span style="color:#f92672">=</span> +84.8°C<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#f92672">(</span>crit <span style="color:#f92672">=</span> +94.8°C<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>acpitz-acpi-0
</span></span><span style="display:flex;"><span>Adapter: ACPI interface
</span></span><span style="display:flex;"><span>temp1:        +84.0°C  <span style="color:#f92672">(</span>crit <span style="color:#f92672">=</span> +105.0°C<span style="color:#f92672">)</span></span></span></code></pre></div>
<p>It never went higher than 84°C temperature. For comparison, my MacBook Pro (<em>15-inch, 2018</em>) during compilation of the same project becomes so damn hot (<em>about 99°C</em>) that you can&rsquo;t touch it.</p>
<h2 id="disabling-file-indexer">Disabling file indexer</h2>
<p>At some point I noticed that a process called <code>/usr/lib/baloo_file_extractor</code> loads the CPU (<em>at least one of the cores</em>) to almost 100%. I googled for it, and that process turned out to be <a href="https://community.kde.org/Baloo">Baloo</a> file indexer.</p>
<p>Well, I don&rsquo;t usually rely on system indexers, so I don&rsquo;t need a useless process wasting my CPU time and the battery charge along with it. Plus I saw some people reporting how extensively it performs read/write disk operations, which probably can reduce the SSD / SD card resource.</p>
<p>First I disabled it in system settings:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/system-settings-file-search.png" alt="KDE, System Settings, File Search">

<p>And then I also disabled its service just in case:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ sudo balooctl disable
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Disabling</span> and stopping the <span style="color:#a6e22e">File</span> <span style="color:#a6e22e">Indexer</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ sudo balooctl status
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Baloo</span> is currently disabled<span style="color:#f92672">.</span> <span style="color:#a6e22e">To</span> enable<span style="color:#f92672">,</span> please run balooctl enable</span></span></code></pre></div>
<h2 id="firewall">Firewall</h2>
<p>It would be really great to have a firewall like <a href="https://obdev.at/products/littlesnitch/index.html">Little Snitch</a> to block outgoing network connections to Take Two, Ubisoft, EA and other spying scumbags, and in general to have control over my network traffic.</p>
<p>But sadly that&rsquo;s a common problem concerning all GNU/Linux distributions - there just isn&rsquo;t one. Setting up <a href="https://en.wikipedia.org/wiki/Iptables">iptables</a> rules is no joy at all, as it&rsquo;s nowhere close to the convenience of Little Snitch.</p>
<h3 id="nextdns">NextDNS</h3>
<p>For now I have only set-up <a href="https://nextdns.io/?from=ykzu58c8">NextDNS</a> (<em>the link is referral</em>) with some blacklists. Here&rsquo;s a related <a href="https://github.com/nextdns/nextdns/issues/741">feature request</a> with instructions for installing a client, but I did it via <code>systemd-resolved</code> instead:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#a6e22e">$ sudo nano /etc/systemd/resolved.conf</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[Resolve]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">DNS</span><span style="color:#f92672">=</span><span style="color:#e6db74">45.90.28.0#deviceName-profileID.dns.nextdns.io</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">DNS</span><span style="color:#f92672">=</span><span style="color:#e6db74">2a07:a8c0::#deviceName-profileID.dns.nextdns.io</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">DNS</span><span style="color:#f92672">=</span><span style="color:#e6db74">45.90.30.0#deviceName-profileID.dns.nextdns.io</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">DNS</span><span style="color:#f92672">=</span><span style="color:#e6db74">2a07:a8c1::#deviceName-profileID.dns.nextdns.io</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">DNSOverTLS</span><span style="color:#f92672">=</span><span style="color:#e6db74">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">$ sudo systemctl daemon-reload</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">$ sudo systemctl restart systemd-resolved</span></span></span></code></pre></div>
<p>That is most certainly not a replacement for a proper firewall, but at least it is something to more or less restrict anal probing.</p>
<h1 id="steam-input">Steam Input</h1>
<p>It is great when a game has a gamepad support, you can just launch the game and play. But many games don&rsquo;t have it, they only support playing with mouse and keyboard, so you would have really hard time playing those games on Steam Deck without physical mouse and keyboard connected.</p>
<p>You would, but you will not - you will have great time, thanks to Steam Input. Shortly saying, it&rsquo;s an ability to customize inputs (<em>of which Steam Deck has a fucking lot</em>) in a so-called &ldquo;controller layout&rdquo; for the purposes of a particular game. In other words, it is possible to assign &ldquo;regular&rdquo; keyboard/mouse/etc inputs to Steam Deck buttons/joysticks/trackpads/etc:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-preview.jpg" alt="Steam Deck, Steam Input, Controller layout preview">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/binding-options-keyboard.jpg" alt="Steam Deck, Steam Input, Controller binding options, keyboard">

</p>
<p>Here&rsquo;s a <a href="https://steamcommunity.com/sharedfiles/filedetails/?id=2804823261">very detailed guide</a> about controller layouts.</p>
<p>For example, here&rsquo;s how I made my own layout for playing <a href="#diablo-ii-resurrected">Diablo II Resurrected</a>. First, buttons:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-buttons-1.jpg" alt="Steam Deck, Steam Input, Controller layout, buttons">

</p>
<p>Bumpers are cycling active skills and back grips are convenient for drinking potions from the belt:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-buttons-2.jpg" alt="Steam Deck, Steam Input, Controller layout, buttons">

</p>
<p>DPad:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-dpad.jpg" alt="Steam Deck, Steam Input, Controller layout, DPad">

<p>Triggers are responsible for mouse clicks:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-triggers.jpg" alt="Steam Deck, Steam Input, Controller layout, triggers">

<p>Left joystick provides 4 more key bindings and right joystick shows a virtual menu:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-joysticks-1.jpg" alt="Steam Deck, Steam Input, Controller layout, joysticks">

<p>&hellip;actually, left joystick provides 6 more bindings:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-joysticks-2.jpg" alt="Steam Deck, Steam Input, Controller layout, joysticks">

<p>Right trackpad controls the mouse movement and left trackpad shows another virtual menu:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-trackpads.jpg" alt="Steam Deck, Steam Input, Controller layout, trackpads">

<h2 id="virtual-menus">Virtual menus</h2>
<p>When I first saw virtual menus, I couldn&rsquo;t believe that mere mortals were allowed to have these:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-virtual-menus.jpg" alt="Steam Deck, Steam Input, virtual menus">

<p>Basically, you can compose lists of commands and call-up these lists in-game via special overlays, like so:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/virtual-menu-radial.jpg" alt="Steam Deck, Steam Input, radial virtual menu">

<p>This radial menu shows up when I touch the right joystick. In that menu I have 6 more buttons for various things that I don&rsquo;t need all that often:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-virtual-menu-radial.jpg" alt="Steam Deck, Steam Input, radial virtual menu">

<p>Every menu item can have an icon (<em>and with colors too</em>):</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-virtual-menu-item-customization.jpg" alt="Steam Deck, Steam Input, virtual menu item customization">

<p>Another type of menu you can create is a touch menu. This one shows up when I put my finger on the left trackpad:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/virtual-menu-touch.jpg" alt="Steam Deck, Steam Input, touch virtual menu">

<p>As you can guess, this one gives me F1-F12 keys to assign to my character skills:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/controller-layout-virtual-menu-touch.jpg" alt="Steam Deck, Steam Input, touch virtual menu">

<p>By default the game has only F1-F8 keys bound, but you can bind more in the game settings:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/diablo-ii-resurrected-controls.jpg" alt="Steam Deck, Steam Input, Diablo II Resurrected controls">

<p>Absolutely fantastic feature.</p>
<h2 id="action-sets">Action Sets</h2>
<p>When you run out of buttons, you can start creating so-called Action Sets - a kinda different variations within the same layout, each having it&rsquo;s own collection of bindings and virtual menus. This was incredibly useful when I was making a controller layout for <a href="#space-rangers">Space Rangers</a>, because I needed different bindings for different game modes (<em>space flights, black holes and planetary battles</em>):</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/action-sets.jpg" alt="Steam Deck, Steam Input, Action Sets">

<p>For instance, in the <code>Space</code> set the <code>A</code> button is bound to <code>Spacebar</code> key, while in <code>Black hole</code> set the same button is bound to <code>Arrow Up</code>/<code>↑</code> key. Switching between sets is done via a virtual menu bound to right joystick touch event:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-input/space-rangers-action-sets-menu.jpg" alt="Steam Deck, Steam Input, Space Rangers Action Sets menu">

<p>And even that is not all, as there are also layers in Actions Set, there are sub-commands, controls can have different behaviours, it is possible to adjust sensitivity, feedback strength and&hellip; I jizzed in my pants.</p>
<h2 id="community-layouts">Community layouts</h2>
<p>Aside from &ldquo;official&rdquo; layouts provided by game developers, a game might also have so-called community layouts - those created by regular players like yourself, who did bother to create a custom layout and share it with everyone.</p>
<p>Community layouts are tied to the game&rsquo;s Steam App ID, so they are only discoverable for Steam games. But there will be a <a href="#community-controller-layout">more detailed section</a> about that later, with Civilization VI as an example of using a community layout for pirated game added as a non-Steam game.</p>
<h1 id="games-from-steam-store">Games from Steam store</h1>
<p>Finally, we get to talk about games.</p>
<p>There is not that much interesting to tell about about games available in Steam store, as you just (<em>purchase and</em>) install them and play. You will also get some additional convenience things:</p>
<ul>
<li>there will be a Proton version pre-set;</li>
<li>you will be getting <a href="#pre-caching-updates">pre-compiled shader cache</a> (<em>which I would rather not</em>);</li>
<li>you will have a collection of official/community <a href="#community-layouts">layouts</a> available to choose from;</li>
<li>the game will have all the graphical assets (<em>poster, background, logo, icon, etc</em>) already set;</li>
<li>the playtime statistics will be recorded (<em>unless you are playing without internet connection</em>);</li>
<li>achievements will work (<em>syncing next time you get online, if you are playing without internet connection</em>);</li>
<li>Steam Cloud savegames syncing will work (<em>in games that support that</em>);</li>
<li>the game you play will be visible to your friends;</li>
<li>the games will be listed among Games on Storage tab in Settings, so you will be able to see the space they occupy and will be able to move them to/from SD card in Gaming mode;</li>
<li>probably some other smaller conveniences.</li>
</ul>
<p>Again, I&rsquo;d like to note that the (<em>ongoing</em>) effort of making lots of Windows-only games to just work out of the box in a GNU/Linux environment must have been incredibly tremendous. A lot of games really do just work! And not only that, some games actually have a native GNU/Linux build, so you don&rsquo;t need Proton for running them, but hilariously enough you can get a better performance if you run a Windows version of that game through Proton instead of running its native GNU/Linux build.</p>
<p>Below I&rsquo;d like to leave some comments about a couple of games in particular.</p>
<h2 id="aperture-desk-job">Aperture Desk Job</h2>
<p><a href="https://store.steampowered.com/app/1902490/">That</a> is likely the first game you&rsquo;ll install and play on Steam Deck, because it&rsquo;s more or less a tutorial for Steam Deck. It get&rsquo;s you familiar with the available controls and introduces you to the gyro-based aiming.</p>
<p>The game is not very demanding and should run on full battery for about 2.5 hours (<em>although you&rsquo;ll finish it faster than that</em>):</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/aperture-desk-job-mangohud.jpg" alt="Steam Deck, Aperture Desk Job, MangoHud metrics">

<h2 id="witcher-3">Witcher 3</h2>
<p>Just as I was unpacking my Steam Deck, <a href="https://store.steampowered.com/app/292030/">Witcher 3</a> got the <a href="https://store.steampowered.com/news/app/292030/view/3642879552277333733">next-gen update</a>. I first tried to launch it on my desktop PC with NVIDIA 1660 SUPER card, and the performance was total shit even with all the graphics settings set to absolute minimum.</p>
<p>So I didn&rsquo;t expect it to even launch on Steam Deck, and was already considering installing the pre-next-gen version, but decided to try the next-gen anyway and&hellip; not only in launches (<em>the DirectX 12 variant</em>), but it runs so much better than on my PC, I could play it just fine.</p>
<p>I absolutely did not expect Steam Deck hardware to be that powerful. I mean, yeah, I assembled my PC about 8 years ago (<em>from the top components for that time</em>), and the only upgrade I had was a couple of years ago - got 1660 SUPER card and added more RAM to raise it to 16 GB for playing <a href="/blog/2021/01/02/steam-vr-screenshots/">Half-Life Alyx</a> - but still, it&rsquo;s <a href="./images/steam-vr-performance-test-results.png">not the weakest PC</a> in the world, and yet Steam Deck outperforms it so easily.</p>
<p>Of course, the game draws a lot of power and runs the battery from 100% to 0% in less than two hours, but that&rsquo;s fine:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/witcher-3/witcher-3-mangohud.jpg" alt="Steam Deck, Witcher 3 MangoHud metrics">

<p>What&rsquo;s not fine is that sometimes it crashes everything into something that seems like a system reboot or at least a Gamescope relaunch.</p>
<p>But anyway, great experience overall, and I&rsquo;ve finally finished the game for 100%:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/witcher-3/witcher-3-achievements.png" alt="Witcher 3 100%">

<p>By the way, here&rsquo;s a <a href="https://youtube.com/watch?v=HpIwB7jLwxs">comparison</a> of Witcher 3 running on Steam Deck versus Nintendo Switch.</p>
<h2 id="black-mesa">Black Mesa</h2>
<p>Yet again, on my desktop computer <a href="https://store.steampowered.com/app/362890/">Black Mesa</a> doesn&rsquo;t run all that good even with medium graphics settings, but on Steam Deck it flies like a butterfly with all settings on maximum, except for anisotropic filtering being at 4x and dynamic lightning being at minimum (<em>otherwise for some reason it makes flashlight to be useless with anything but crowbar</em>):</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/black-mesa-mangohud.jpg" alt="Steam Deck, Black Mesa MangoHud metrics">

<p>With FPS limit set to 40 the power consumption is 8 W, so the battery should last for about 4-5 hours? I find it hard to believe. But it could be that the current scene just isn&rsquo;t very intense, and it will probably draw more power in a more dynamic scene.</p>
<p>You might say, of course I get better performance on Steam Deck - it only needs to render for 1280x800 resolution, while on desktop I have a proper 4K display with 3840x2160 resolution, so the comparison is not fair. Well, I connected it to the same display, and here are the metrics (<em>without FPS limit</em>):</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/black-mesa-mangohud-4k.jpg" alt="Steam Deck, Black Mesa MangoHud metrics in 4K">

<p>Yes, now it will run down the battery in less than 2 hours, but what&rsquo;s important is that it still outperforms my desktop PC. Fucking monster of a device.</p>
<p>Also, that&rsquo;s where I&rsquo;ve realized the power of aiming using gyroscope input - without it you simply don&rsquo;t have a chance to shoot a headcrab mid-air. It still takes some practice to get used to it, but it certainly gives you more precise aiming than with a joystick or trackpad.</p>
<h2 id="doom-3-bfg">DooM 3 BFG</h2>
<p>There are two reasons why I&rsquo;m writing about <a href="https://store.steampowered.com/app/208200/">DooM 3 BFG</a> here.</p>
<p>First one is that it also includes the original DooM and Doom II (<em>with some achievements too</em>), which I of course played again 30 years after their initial release. Very enjoyable experience with Steam Deck controls.</p>
<p>The FPS counter never goes higher than 35 FPS and as far as I know that is by design:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/doom/doom-mangohud.jpg" alt="Steam Deck, DooM, MangoHud metrics">

<p>The DooM 3 runs just fine and should easily live from the battery for about 5 hours:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/doom/doom-3-mangohud.jpg" alt="Steam Deck, DooM 3, MangoHud metrics">

<p>Only issue is that if you set antialiasing, then you&rsquo;ll only get the crosshair on screen in game and the rest will be a black void. The GUI still renders fine, so you can go back to settings and revert it.</p>
<p>Second reason to talk about DooM 3 was that while going through the game settings I got to the 3D tab:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/doom/doom-3d-settings.jpg" alt="DooM 3D settings">

<p>And I&rsquo;ve changed one setting there, thinking it is about graphics performance in 3D, but turns out this is for VR, and after the game restart I got black screen for the graphics. I could still hear the GUI sounds, but nothing rendered, and so there was no way to change that setting back.</p>
<p>So I looked up where <a href="https://pcgamingwiki.com/wiki/Doom_3:_BFG_Edition">DooM 3</a> keeps its configs, and it was this path: <code>/home/deck/.local/share/Steam/steamapps/compatdata/208200/pfx/drive_c/users/steamuser/Saved Games/id Software/DOOM 3 BFG/base/</code>. Switched to Desktop, found the config there, renamed it to a different name, launched the game, it generated a new config, I compared old one and new one with <code>diff</code>, and it turned out that I&rsquo;ve changed the <code>r_vidMode</code>, so I just needed to return it to default value (<em><code>set r_vidMode &quot;0&quot;</code></em>) in the config.</p>
<p>Isn&rsquo;t it great. I have the freedom to break a game and I can fix it myself. Very refreshing experience.</p>
<h2 id="civilization-v">Civilization V</h2>
<p>The <a href="https://store.steampowered.com/app/8930/">Civilization V</a> game seems to have a native GNU/Linux build, because the startup intros are different and also there is no fucking launcher like there is on Windows, which is great.</p>
<p>The game runs with no issues:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-v-mangohud.jpg" alt="Steam Deck, Civilization V, MangoHud metrics">

<p>The text is a bit too small, but it&rsquo;s hard to blame the game for that, as it was released in 2010 when no one thought about how text will look like on a portable device 12 years later.</p>
<p>There is even an official controller layout.</p>
<p>I purchased this before I knew that it has a launcher, a bazillion of DLCs and a <a href="https://store.steampowered.com//eula/8930_eula_0">spying EULA</a>, similar to the one in <a href="#civilization-vi">Civilization VI</a>, so even though it is a great game, I would actually not bought it if I knew all that beforehand.</p>
<h2 id="space-rangers">Space Rangers</h2>
<p>The moment I learned about Steam Deck existence, my first thought was &ldquo;<em>I wonder if I can play <a href="https://store.steampowered.com/app/214730/">Space Rangers</a> on it</em>&rdquo;.</p>
<p>And OH MY GOD it works. It works! Right from the Steam store, no tinkering / fiddling / fucking about required, just install and play. I was the happiest person on the planet at that moment. Да, Космические рейнджеры работают на Steam Deck!</p>
<p>The main picture in the beginning of the article is not an original photo - I cheated and placed a screenshot on top of a photo for better looks. But here&rsquo;s a different one, this time unedited:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-deck-space-rangers.jpg" alt="Space Rangers on Steam Deck / Космические рейнджеры на Steam Deck">

<p>Why it is a semi-miracle that this game runs on Steam Deck: it was released in 2013, the <a href="https://rangers.fandom.com/ru/wiki/%D0%9A%D0%BE%D1%81%D0%BC%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5_%D1%80%D0%B5%D0%B9%D0%BD%D0%B4%D0%B6%D0%B5%D1%80%D1%8B_HD:_%D0%A0%D0%B5%D0%B2%D0%BE%D0%BB%D1%8E%D1%86%D0%B8%D1%8F#%D0%A2%D0%B5%D1%85%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D1%80%D0%B5%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F">development</a> was done in Delphi plus additional components built with Visual C++ 2010 and also MinGW, and the target OS was Windows XP. Yet, it just runs out of the box in 2023 on a custom hardware under GNU/Linux:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/space-rangers-mangohud.jpg" alt="Steam Deck, Space Rangers, MangoHud metrics">

<p>MangoHud says I&rsquo;ll be able to play the best game in the world for more than 6 hours on one battery charge.</p>
<p>СЛЁЗЫ НА ОЧКАХ, СТРАННЫЕ ОЧКИ, А МОЖЕТ СЛЁЗЫ НА ЛИЦЕ.</p>
<p>The screen resolution set to auto in settings, and if you set it to 1280x800 explicitly, then it will tell you that it detected Wine and will force software rendering, and some other issues will probably emerge too. So I reverted that change, and the resolution most probably is set to 1280x800 anyway.</p>
<p>There are some pre-made community controller layouts available, but I&rsquo;ve created <a href="https://github.com/retifrav/steam-deck-controller-layouts/tree/master/214730-space-rangers-2">my own</a> anyway.</p>
<h1 id="installing-non-steam-stuff">Installing non-Steam stuff</h1>
<p>As Steam Deck is a &ldquo;regular&rdquo; PC, can do absolutely anything with it, including installation of whatever games, applications, tools, etc. You can wipe the entire SteamOS and install any other GNU/Linux distribution or even Windows, although I see no point in doing so.</p>
<p>For clarification, everything in this section obviously is done in Desktop mode. Once installed, games/applications can be added to Steam as &ldquo;non-Steam game&rdquo; entities, and then you&rsquo;ll be able to run them in Gaming mode too.</p>
<h2 id="applications">Applications</h2>
<p>While this is mostly about &ldquo;regular&rdquo; applications for Desktop mode, you can of course launch them in Gaming mode too. However, this might not always be a great idea because of a very specific windowing system that is used inside Gamescope.</p>
<p>For instance, you can add a web-browser and run it in Gaming mode. And at first I tried to do that with Firefox, but the resolution/scaling was too small for comfortable browsing, and certain things like <a href="https://github.com/gorhill/uMatrix">uMatrix</a> popups were not showing up at all, giving me just a blinking screen and some other glitches.</p>
<p>But in general, many applications will work without problems. You can just as well add <a href="https://konsole.kde.org">Konsole</a> application, and that will give you a proper shell without the need to switch to Desktop mode. You&rsquo;ll be able to check/kill running processes with <code>htop</code>:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/konsole-in-gaming-mode-htop.jpg" alt="Steam Deck, Konsole in Gaming mode, htop">

<p>work with files in Midnight Commander (<em>once you <a href="#homebrew">install</a> it</em>):</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/konsole-in-gaming-mode-mc.jpg" alt="Steam Deck, Konsole in Gaming mode, Midnight Commander">

<p>and do whatever you&rsquo;d like using any other CLI tool. I&rsquo;d recommend to set the following launch options for it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">LD_PRELOAD</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">%</span>command<span style="color:#f92672">%</span> <span style="color:#f92672">--</span>fullscreen</span></span></code></pre></div>
<p>Setting <code>LD_PRELOAD</code> to an empty string gets rid of numerous &ldquo;<em>cannot be preloaded (wrong ELF class)</em>&rdquo; errors/warnings, and <code>--fullscreen</code> speaks for itself.</p>
<p>Now let&rsquo;s talk about how you can install additional applications yourself.</p>
<p>Usually, additional software on a GNU/Linux OS is installed via a package manager. The SteamOS, being an Arch-based GNU/Linux distribution, uses <a href="https://en.wikipedia.org/wiki/Arch_Linux#Pacman">pacman</a> package manager.</p>
<p>As I mentioned, what&rsquo;s special SteamOS is that parts of it are <a href="#filesystem">read-only</a>, and to be able to install something with pacman you&rsquo;ll need to disable read-only mode (<em>don&rsquo;t do it yet, read some more below first</em>), install what you need and enable read-only mode back:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ sudo steamos<span style="color:#f92672">-</span>readonly disable
</span></span><span style="display:flex;"><span>$ pacman <span style="color:#f92672">-</span>S <span style="color:#a6e22e">PACKAGE</span><span style="color:#f92672">-</span><span style="color:#a6e22e">NAME</span>
</span></span><span style="display:flex;"><span>$ sudo steamos<span style="color:#f92672">-</span>readonly enable</span></span></code></pre></div>
<p>Another peculiarity is that those read-only parts will get overwritten on the next OS update, so the stuff you&rsquo;ll install will not persist and you&rsquo;ll need to install it again.</p>
<p>And actually I would advise against installing anything (<em>with a rare exception</em>) using pacman system-wide. I think it would be better not to &ldquo;pollute&rdquo; the original system environment by getting in front of the default tools in <code>PATH</code>, adding/replacing certain libraries and other things like that. The reason is that Valve engineers (<em>and external developers involved in the process</em>) must have spent a lot of time and effort making a GNU/Linux based gaming system that &ldquo;just works&rdquo; for an average user out-of-the-box. That is a very complex task on its own, and so system environment is unlikely to anticipate what users might do by installing additional system-wide software or/and changing the default environment setup.</p>
<p>I can name two other less/non intrusive ways of installing additional software:</p>
<ol>
<li>Using <a href="https://flatpak.org">Flatpak</a> - a way of distributing &ldquo;self-contained&rdquo; applications on GNU/Linux distributions, where every applications comes as a &ldquo;container&rdquo;, in which it &ldquo;contains&rdquo; the executable itself, application resources and required dependencies;</li>
<li>Using a different package manager - one that can install packages into an &ldquo;isolated&rdquo; path, where they won&rsquo;t &ldquo;contaminate&rdquo; system environment;
<ul>
<li>that also enables a 3rd-way of installing additional software - by first installing the build tools and then compiling that software from sources. Sounds like a lot of fun, doesn&rsquo;t it.</li>
</ul>
</li>
</ol>
<h3 id="flatpak">Flatpak</h3>
<p>The Flatpak way of installing new applications is easy. There is already a <a href="https://apps.kde.org/discover/">Discover</a> application/store pre-installed, in which you can browse for games and applications and install them in one click.</p>
<p>I was sceptical about it at first, as it is not a &ldquo;<em>true way</em>&rdquo; or installing software on GNU/Linux systems. But very soon I started to appreciate the convenience and non-disruptiveness (<em>towards system environment</em>), so perhaps Flatpak isn&rsquo;t the worst thing out there. <del><a href="https://snapcraft.io">Snap</a> definitely is.</del></p>
<p>Flatpak applications get installed into <code>/var/lib/flatpak/app/</code> and user&rsquo;s data/preferences/settings/etc are saved in <code>/home/deck/.var/app/</code>, both of which do not get wiped on system updates.</p>
<p>To start a Flatpak application you can simply launch it from the Application Launcher. To add it to Steam (<em>to be able to launch it in Gaming mode</em>), do the usual <code>Add a game</code> → <code>Add a Non-Steam Game</code> and it will be in the list, no need to browse for the executable.</p>
<p>To start a Flatpak application from CLI, execute the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ flatpak run io<span style="color:#f92672">.</span>mpv<span style="color:#f92672">.</span><span style="color:#a6e22e">Mpv</span> <span style="color:#f92672">--</span>help</span></span></code></pre></div>
<h4 id="ungoogled-chromium">Ungoogled Chromium</h4>
<p>Like I mentioned earlier, running Firefox in Gaming mode wasn&rsquo;t a great experience, but at some point (<em>and probably a couple of updates</em>) later I tried to install <a href="https://flathub.org/apps/com.github.Eloston.UngoogledChromium">Ungoogled Chromium</a>, and that one works much better without any blinking or other glitches.</p>
<p>One minor issue though is that out of the box it doesn&rsquo;t use all the available screen width:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/chromium-wrong-window-size.jpg" alt="Steam Deck, Chromium not using the entire screen" style="border:1px solid black;">

<p>Fortunately, that can be easily fixed by adding the <a href="https://www.reddit.com/r/SteamDeck/comments/u0ke5l/chrome_fullscreen/inohu50/">following launch options</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#f92672">--</span>window<span style="color:#f92672">-</span>size<span style="color:#66d9ef">=</span><span style="color:#ae81ff">1280</span><span style="color:#f92672">,</span><span style="color:#ae81ff">800</span> <span style="color:#f92672">--</span>force<span style="color:#f92672">-</span>device<span style="color:#f92672">-</span>scale<span style="color:#f92672">-</span>factor<span style="color:#66d9ef">=</span><span style="color:#ae81ff">1.0</span> <span style="color:#f92672">--</span>device<span style="color:#f92672">-</span>scale<span style="color:#f92672">-</span>factor<span style="color:#66d9ef">=</span><span style="color:#ae81ff">1.0</span></span></span></code></pre></div>
<p>And then it starts to use the entire screen as it should:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/chromium-correct-window-size.jpg" alt="Steam Deck, Chromium using the entire screen" style="border:1px solid black;">

<h4 id="kodi">Kodi</h4>
<p>Surely enough, very soon I wanted to get a media player to watch TV shows / movies without leaving  the Gaming mode, and the best candidate for that is of course <a href="https://kodi.tv">Kodi</a>. It is designed to run fullscreen and provides a nice GUI, which is very suitable for gamepad controls (<em>it even has Steam Deck controls bindings out of the box</em>).</p>
<p>I haven&rsquo;t even tried building it from sources and installed the <a href="https://flathub.org/apps/details/tv.kodi.Kodi">Flatpak version</a> right away. There is one problem with it though: while it gets hardware acceleration for playback in Desktop mode, once you launch it in Gaming mode you&rsquo;ll notice how videos aren&rsquo;t playing smoothly, and that is because the playback isn&rsquo;t utilizing hardware acceleration there.</p>
<p>From <a href="https://forum.kodi.tv/showthread.php?tid=368032">this helpful thread</a> on Kodi forum, I got to know that it requires <code>--env=LIBVA_DRIVER_NAME=radeonsi</code> to be added to launch options:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>run <span style="color:#f92672">--</span>branch<span style="color:#66d9ef">=</span>stable <span style="color:#f92672">--</span>arch<span style="color:#66d9ef">=</span>x86_64 <span style="color:#f92672">--</span>env<span style="color:#66d9ef">=</span><span style="color:#a6e22e">LIBVA_DRIVER_NAME</span><span style="color:#66d9ef">=</span>radeonsi <span style="color:#f92672">--</span>command<span style="color:#66d9ef">=</span>kodi tv<span style="color:#f92672">.</span>kodi<span style="color:#f92672">.</span><span style="color:#a6e22e">Kodi</span></span></span></code></pre></div>
<p>And then hardware acceleration becomes available:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/kodi/hardware-acceleration-settings.jpg" alt="Steam Deck, Kodi, hardware acceleration in settings">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/kodi/hardware-acceleration-playback.jpg" alt="Steam Deck, Kodi, hardware accelerated playback">

</p>
<p>So far I&rsquo;ve encountered only two problems:</p>
<ul>
<li>there is no UI sounds in the main menu;</li>
<li>it couldn&rsquo;t connect to my FTPS share (<em>SFTP and SMB work fine</em>).</li>
</ul>
<h4 id="mpv">mpv</h4>
<p><a href="#kodi">Kodi</a> is great, but it&rsquo;s not a very lightweight player. For Desktop mode, in my opinion, <a href="https://mpv.io">mpv</a> player is a much better option.</p>
<p>It can be installed with pacman, but like I said, I would like to install as minimum system-wide packages as possible, and mpv has quite a lot of dependencies.</p>
<p><a href="#homebrew">Homebrew</a> offers a <a href="https://formulae.brew.sh/formula/mpv">formula</a> for mpv, so I tried using that one first:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ brew install mpv</span></span></code></pre></div>
<p>It does work playing audio in terminal/CLI mode, but it cannot initialize/create a window:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ mpv https://files.decovar.dev/public/etc/radio.m3u8 --force-window
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Error opening/initializing the VO window.</span></span></code></pre></div>
<p>I checked its capabilities, and looks like it isn&rsquo;t built with all the required features / platform specifics:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ mpv --vo<span style="color:#f92672">=</span>help
</span></span><span style="display:flex;"><span>Available video outputs:
</span></span><span style="display:flex;"><span>  libmpv           render API <span style="color:#66d9ef">for</span> libmpv
</span></span><span style="display:flex;"><span>  gpu              Shader-based GPU Renderer
</span></span><span style="display:flex;"><span>  null             Null video output
</span></span><span style="display:flex;"><span>  image            Write video frames to image files
</span></span><span style="display:flex;"><span>  tct              true-color terminals
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ mpv --gpu-context<span style="color:#f92672">=</span>help
</span></span><span style="display:flex;"><span>GPU contexts <span style="color:#f92672">(</span>APIs<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>    auto <span style="color:#f92672">(</span>autodetect<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ mpv --hwdec<span style="color:#f92672">=</span>help
</span></span><span style="display:flex;"><span>Valid values <span style="color:#f92672">(</span>with alternative full names<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>h263_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>h264_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>hevc_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>mpeg4_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>mpeg1_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>mpeg2_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>vc1_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>vp8_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>vp9_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  auto <span style="color:#f92672">(</span>yes <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  no
</span></span><span style="display:flex;"><span>  auto-safe
</span></span><span style="display:flex;"><span>  auto-copy
</span></span><span style="display:flex;"><span>  auto-copy-safe</span></span></code></pre></div>
<p>So I deleted the Homebrew version and installed the <a href="https://flathub.org/apps/details/io.mpv.Mpv">Flatpack version</a>. That one lists much more capabilities:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ flatpak run io.mpv.Mpv --vo<span style="color:#f92672">=</span>help
</span></span><span style="display:flex;"><span>Available video outputs:
</span></span><span style="display:flex;"><span>  libmpv           render API <span style="color:#66d9ef">for</span> libmpv
</span></span><span style="display:flex;"><span>  gpu              Shader-based GPU Renderer
</span></span><span style="display:flex;"><span>  gpu-next         Video output based on libplacebo
</span></span><span style="display:flex;"><span>  vdpau            VDPAU with X11
</span></span><span style="display:flex;"><span>  wlshm            Wayland SHM video output <span style="color:#f92672">(</span>software scaling<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  xv               X11/Xv
</span></span><span style="display:flex;"><span>  sdl              SDL 2.0 Renderer
</span></span><span style="display:flex;"><span>  dmabuf-wayland   Wayland dmabuf video output
</span></span><span style="display:flex;"><span>  vaapi            VA API with X11
</span></span><span style="display:flex;"><span>  x11              X11 <span style="color:#f92672">(</span>software scaling<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  null             Null video output
</span></span><span style="display:flex;"><span>  image            Write video frames to image files
</span></span><span style="display:flex;"><span>  tct              true-color terminals
</span></span><span style="display:flex;"><span>  drm              Direct Rendering Manager <span style="color:#f92672">(</span>software scaling<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  sixel            terminal graphics using sixels
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ flatpak run io.mpv.Mpv --gpu-context<span style="color:#f92672">=</span>help
</span></span><span style="display:flex;"><span>GPU contexts <span style="color:#f92672">(</span>APIs<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>    auto <span style="color:#f92672">(</span>autodetect<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    wayland <span style="color:#f92672">(</span>opengl<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    x11egl <span style="color:#f92672">(</span>opengl<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    drm <span style="color:#f92672">(</span>opengl<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    waylandvk <span style="color:#f92672">(</span>vulkan<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    x11vk <span style="color:#f92672">(</span>vulkan<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    displayvk <span style="color:#f92672">(</span>vulkan<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ flatpak run io.mpv.Mpv --hwdec<span style="color:#f92672">=</span>help
</span></span><span style="display:flex;"><span>Valid values <span style="color:#f92672">(</span>with alternative full names<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>h263-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>h263p-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>h264-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>hevc-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>mjpeg-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>mpeg1video-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>mpeg2video-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>mpeg4-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>vc1-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>vp8-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>vp9-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>wmv3-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec <span style="color:#f92672">(</span>av1-nvdec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>h263-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>h263p-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>h264-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>hevc-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>mjpeg-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>mpeg2video-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>mpeg4-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>vc1-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>vp8-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>vp9-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>wmv3-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi <span style="color:#f92672">(</span>av1-vaapi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau <span style="color:#f92672">(</span>h263-vdpau<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau <span style="color:#f92672">(</span>h263p-vdpau<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau <span style="color:#f92672">(</span>h264-vdpau<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau <span style="color:#f92672">(</span>hevc-vdpau<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau <span style="color:#f92672">(</span>mpeg1video-vdpau<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau <span style="color:#f92672">(</span>mpeg2video-vdpau<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau <span style="color:#f92672">(</span>mpeg4-vdpau<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau <span style="color:#f92672">(</span>vc1-vdpau<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau <span style="color:#f92672">(</span>vp9-vdpau<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau <span style="color:#f92672">(</span>wmv3-vdpau<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau <span style="color:#f92672">(</span>av1-vdpau<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>h263-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>h263p-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>h264-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>hevc-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>mjpeg-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>mpeg1video-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>mpeg2video-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>mpeg4-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>vc1-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>vp8-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>vp9-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>wmv3-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  nvdec-copy <span style="color:#f92672">(</span>av1-nvdec-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>h263-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>h263p-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>h264-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>hevc-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>mjpeg-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>mpeg2video-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>mpeg4-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>vc1-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>vp8-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>vp9-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>wmv3-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vaapi-copy <span style="color:#f92672">(</span>av1-vaapi-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau-copy <span style="color:#f92672">(</span>h263-vdpau-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau-copy <span style="color:#f92672">(</span>h263p-vdpau-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau-copy <span style="color:#f92672">(</span>h264-vdpau-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau-copy <span style="color:#f92672">(</span>hevc-vdpau-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau-copy <span style="color:#f92672">(</span>mpeg1video-vdpau-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau-copy <span style="color:#f92672">(</span>mpeg2video-vdpau-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau-copy <span style="color:#f92672">(</span>mpeg4-vdpau-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau-copy <span style="color:#f92672">(</span>vc1-vdpau-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau-copy <span style="color:#f92672">(</span>vp9-vdpau-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau-copy <span style="color:#f92672">(</span>wmv3-vdpau-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  vdpau-copy <span style="color:#f92672">(</span>av1-vdpau-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda <span style="color:#f92672">(</span>av1_cuvid-cuda<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda <span style="color:#f92672">(</span>h264_cuvid-cuda<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda <span style="color:#f92672">(</span>hevc_cuvid-cuda<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda <span style="color:#f92672">(</span>mjpeg_cuvid-cuda<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda <span style="color:#f92672">(</span>mpeg1_cuvid-cuda<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda <span style="color:#f92672">(</span>mpeg2_cuvid-cuda<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda <span style="color:#f92672">(</span>mpeg4_cuvid-cuda<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda <span style="color:#f92672">(</span>vc1_cuvid-cuda<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda <span style="color:#f92672">(</span>vp8_cuvid-cuda<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda <span style="color:#f92672">(</span>vp9_cuvid-cuda<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>h263_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>h264_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>hevc_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>mpeg4_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>mpeg1_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>mpeg2_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>vc1_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>vp8_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  v4l2m2m-copy <span style="color:#f92672">(</span>vp9_v4l2m2m-v4l2m2m-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda-copy <span style="color:#f92672">(</span>av1_cuvid-cuda-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda-copy <span style="color:#f92672">(</span>h264_cuvid-cuda-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda-copy <span style="color:#f92672">(</span>hevc_cuvid-cuda-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda-copy <span style="color:#f92672">(</span>mjpeg_cuvid-cuda-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda-copy <span style="color:#f92672">(</span>mpeg1_cuvid-cuda-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda-copy <span style="color:#f92672">(</span>mpeg2_cuvid-cuda-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda-copy <span style="color:#f92672">(</span>mpeg4_cuvid-cuda-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda-copy <span style="color:#f92672">(</span>vc1_cuvid-cuda-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda-copy <span style="color:#f92672">(</span>vp8_cuvid-cuda-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  cuda-copy <span style="color:#f92672">(</span>vp9_cuvid-cuda-copy<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  auto <span style="color:#f92672">(</span>yes <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  no
</span></span><span style="display:flex;"><span>  auto-safe
</span></span><span style="display:flex;"><span>  auto-copy
</span></span><span style="display:flex;"><span>  auto-copy-safe</span></span></code></pre></div>
<p>And it works fine too:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ flatpak run io.mpv.Mpv https://files.decovar.dev/public/etc/radio.m3u8 --force-window</span></span></code></pre></div>
<p>I started to really like Flatpak distributions. I in general like a lot when stuff just works out of the box.</p>
<p>The audio files without a cover art (<em>such as my radio playlist</em>) will have black void in the application window, so one might want to use some default image instead (<em>that will also require setting <code>--vid=1</code> instead of <code>--force-window</code></em>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ flatpak run io.mpv.Mpv https://files.decovar.dev/public/etc/radio.m3u8 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    --external-file<span style="color:#f92672">=</span>https://files.decovar.dev/public/etc/mpv.png <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    --vid<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span></span></span></code></pre></div>
<p>I added it to Steam too, because I wanted to use mpv in Gaming mode for listening to radio playlist as a background music for some games. Steam adds all the launch options for opening mpv application window on its own, and I also added my options for openning my radio playlist and setting a default image:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#e6db74">&#34;run&#34;</span> <span style="color:#e6db74">&#34;--branch=stable&#34;</span> <span style="color:#e6db74">&#34;--arch=x86_64&#34;</span> <span style="color:#e6db74">&#34;--command=mpv&#34;</span> <span style="color:#e6db74">&#34;--file-forwarding&#34;</span> <span style="color:#e6db74">&#34;io.mpv.Mpv&#34;</span> <span style="color:#e6db74">&#34;--player-operation-mode=pseudo-gui&#34;</span> <span style="color:#f92672">~/</span><span style="color:#a6e22e">Music</span><span style="color:#f92672">/</span>radio<span style="color:#f92672">.</span>m3u8 <span style="color:#e6db74">&#34;--external-file=/home/deck/Pictures/mpv.png&#34;</span> <span style="color:#e6db74">&#34;--vid=1&#34;</span> <span style="color:#e6db74">&#34;--&#34;</span> <span style="color:#e6db74">&#34;@@u&#34;</span> <span style="color:#e6db74">&#34;@@&#34;</span></span></span></code></pre></div>
<p>That runs fine in Gaming mode:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/mpv.jpg" alt="Steam Deck, mpv">

<p>While we are on the topic, here are also my mpv configs:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ less <span style="color:#f92672">~/.</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span>app<span style="color:#f92672">/</span>io<span style="color:#f92672">.</span>mpv<span style="color:#f92672">.</span><span style="color:#a6e22e">Mpv</span><span style="color:#f92672">/</span>config<span style="color:#f92672">/</span>mpv<span style="color:#f92672">/</span>mpv<span style="color:#f92672">.</span>conf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>force<span style="color:#f92672">-</span>window<span style="color:#66d9ef">=</span>yes
</span></span><span style="display:flex;"><span>vid<span style="color:#66d9ef">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>keep<span style="color:#f92672">-</span>open<span style="color:#66d9ef">=</span>yes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>osd<span style="color:#f92672">-</span>duration<span style="color:#66d9ef">=</span><span style="color:#ae81ff">3000</span>
</span></span><span style="display:flex;"><span>osd<span style="color:#f92672">-</span>font<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Verdana&#34;</span>
</span></span><span style="display:flex;"><span>osd<span style="color:#f92672">-</span>font<span style="color:#f92672">-</span>size<span style="color:#66d9ef">=</span><span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>osd<span style="color:#f92672">-</span>color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#FFF766&#34;</span>
</span></span><span style="display:flex;"><span>osd<span style="color:#f92672">-</span>border<span style="color:#f92672">-</span>size<span style="color:#66d9ef">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>osd<span style="color:#f92672">-</span>bar<span style="color:#f92672">-</span>align<span style="color:#f92672">-</span>y<span style="color:#66d9ef">=</span><span style="color:#ae81ff">0.9</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sub<span style="color:#f92672">-</span>font<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Verdana&#34;</span>
</span></span><span style="display:flex;"><span>sub<span style="color:#f92672">-</span>font<span style="color:#f92672">-</span>size<span style="color:#66d9ef">=</span><span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>sub<span style="color:#f92672">-</span>color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#FFFF00&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>save<span style="color:#f92672">-</span>position<span style="color:#f92672">-</span>on<span style="color:#f92672">-</span>quit<span style="color:#66d9ef">=</span>yes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>screenshot<span style="color:#f92672">-</span>format<span style="color:#66d9ef">=</span>jpg</span></span></code></pre></div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ less <span style="color:#f92672">~/.</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span>app<span style="color:#f92672">/</span>io<span style="color:#f92672">.</span>mpv<span style="color:#f92672">.</span><span style="color:#a6e22e">Mpv</span><span style="color:#f92672">/</span>config<span style="color:#f92672">/</span>mpv<span style="color:#f92672">/</span>script<span style="color:#f92672">-</span>opts<span style="color:#f92672">/</span>osc<span style="color:#f92672">.</span>conf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>visibility<span style="color:#66d9ef">=</span>auto</span></span></code></pre></div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ less <span style="color:#f92672">~/.</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span>app<span style="color:#f92672">/</span>io<span style="color:#f92672">.</span>mpv<span style="color:#f92672">.</span><span style="color:#a6e22e">Mpv</span><span style="color:#f92672">/</span>config<span style="color:#f92672">/</span>mpv<span style="color:#f92672">/</span>input<span style="color:#f92672">.</span>conf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ENTER</span> cycle fullscreen
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>i show<span style="color:#f92672">-</span>progress
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">TAB</span> script<span style="color:#f92672">-</span>binding stats<span style="color:#f92672">/</span>display<span style="color:#f92672">-</span>stats
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">LEFT</span> seek <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RIGHT</span> seek <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AXIS_UP</span>     add volume  <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AXIS_DOWN</span>   add volume <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">UP</span>          add volume  <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">DOWN</span>        add volume <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ALT</span><span style="color:#f92672">+</span><span style="color:#a6e22e">RIGHT</span> frame<span style="color:#f92672">-</span>step
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ALT</span><span style="color:#f92672">+</span><span style="color:#a6e22e">LEFT</span> frame<span style="color:#f92672">-</span>back<span style="color:#f92672">-</span>step
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p show_text $<span style="color:#f92672">{</span>playlist<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CTRL</span><span style="color:#f92672">+</span><span style="color:#a6e22e">RIGHT</span> playlist<span style="color:#f92672">-</span>next
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CTRL</span><span style="color:#f92672">+</span><span style="color:#a6e22e">LEFT</span> playlist<span style="color:#f92672">-</span>prev
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a show_text $<span style="color:#f92672">{</span>track<span style="color:#f92672">-</span>list<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CTRL</span><span style="color:#f92672">+</span>a cycle audio
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CTRL</span><span style="color:#f92672">+</span>h cycle sub
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ESC</span> quit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CTRL</span><span style="color:#f92672">+</span>r playlist<span style="color:#f92672">-</span>shuffle</span></span></code></pre></div>
<p>And here&rsquo;s a my <a href="https://github.com/retifrav/steam-deck-controller-layouts/tree/master/mpv">controller layout</a> to work with (<em>most of</em>) the keybindings.</p>
<h4 id="obs-studio">OBS Studio</h4>
<p>I wanted to record the screen to demonstrate how virtual menus work in games, so I installed <a href="https://obsproject.com">OBS Studio</a> (<em>also via <a href="https://flathub.org/apps/details/com.obsproject.Studio">Flatpak</a>, as again that was the most convenient way</em>).</p>
<p>Hardware acceleration is available out of the box:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/obs-studio-hardware-acceleration.png" alt="Steam Deck, KU Studio hardware acceleration">

<p>And it works in Desktop mode, you can record either the entire screen or a specific game window. Here&rsquo;s an example:</p>






<video  controls="yes"   class="video">
    <source src="https://files.decovar.dev/public/blog/steam-deck/diablo-ii-resurrected-recording-desktop.mp4" type="video/mp4">
</video>

<p class="video-fallback">If video doesn't play in your browser, you can download it <a href="https://files.decovar.dev/public/blog/steam-deck/diablo-ii-resurrected-recording-desktop.mp4">here</a></p>


<p>It seems to add some performance penalty (<em>in addition to the absence of 40 FPS limit</em>), but in general the recording works fine.</p>
<p>Since it is not Gaming mode, Steam Input isn&rsquo;t fully implemented here (<em>or what&rsquo;s the reason</em>), in particular there are no virtual menus, and to record those one would need to start screen recording in Gaming mode. So I added OBS Studio as a non-Steam game, launched it in Gaming mode and started screen recording. But unfortunately it doesn&rsquo;t support screen recording there, at least current version doesn&rsquo;t. It does capture UI and game sounds, it even captures the game-stylized mouse pointer, but the rest is just black void:</p>






<video  controls="yes"   class="video">
    <source src="https://files.decovar.dev/public/blog/steam-deck/diablo-ii-resurrected-recording-gamescope.mp4" type="video/mp4">
</video>

<p class="video-fallback">If video doesn't play in your browser, you can download it <a href="https://files.decovar.dev/public/blog/steam-deck/diablo-ii-resurrected-recording-gamescope.mp4">here</a></p>


<p>There is a <a href="https://gist.github.com/rondhi/f9163e7649aa734b5421a8f58bd6c49e">workaround instruction</a> how to make screen recording work in Gaming mode, but it involves installing some system-wide packages and from 3rd-party repositories too, so I didn&rsquo;t do it.</p>
<h3 id="homebrew">Homebrew</h3>
<p>Originally there was a section here about installing development tools and libraries via <a href="https://brew.sh">Homebrew</a> package manager, including the process of installing GCC and building stuff from sources. But the final article ended up being way too long, so I decided to move development stuff into a <a href="/blog/2023/05/28/steam-deck-building-stuff-from-sources/">separate article</a> (<em>and also added there a new section about building Qt</em>).</p>
<h2 id="games">Games</h2>
<p>First thing to mention is that non-Steam games will not have these convenience things that I <a href="#games-from-steam-store">listed earlier</a>, and so:</p>
<ul>
<li>you will need to manually set the Proton version (<em>maybe even download a new one</em>);</li>
<li>you will not be geting <a href="#pre-caching-updates">pre-compiled shader cache</a> (<em>oh fuck yes</em>);</li>
<li>you will not have official / <a href="#community-layouts">community layouts</a> (<em>there will be some more details about that</em>);</li>
<li>you will need to set set all the graphical assets (<em>poster, background, logo, icon, etc</em>) manually, otherwise your library entries will be just faceless gray rectangles;</li>
<li>the playtime statistics will not be recorded;</li>
<li>there will be no achievements;</li>
<li>there will be no Steam Cloud savegames syncing;</li>
<li>these games will not be listed among Games on Storage tab in Settings, they will fall into Other category, so you won&rsquo;t be able to see the space they occupy and won&rsquo;t be able to move them to/from SD card in Gaming mode (<em>you will of course be able to do that in Desktop mode or via SSH/Konsole</em>);</li>
<li>your friends will not see the game you are playing.</li>
</ul>
<p>It&rsquo;s all obvious and not very important (<em>at least for me it&rsquo;s not</em>), but I thought I&rsquo;ll post this list anyway.</p>
<p>Second thing to mention is that this article has the <a href="/tags/piracy/">#piracy</a> tag, and some of the games below one indeed might not want to pay for. There will be a reasoning provided for each case, but the most common reasons to pirate a game are:</p>
<ul>
<li>it relies on the <a href="./images/witcher-3-gog.jpg">Defensive Regulatory Magicon</a> too much, especially when these defensive mechanisms actually hurt the game&rsquo;s performance;</li>
<li>it forces to use an additional launcher instead of just directly starting the game;</li>
<li>it requires to accept additional 3rd-party EULAs;</li>
<li>it forces creating accounts in various services (<em>which I never wanted to use and never will be</em>);</li>
<li>it requires internet connection even when it makes no sense and is redundant for the actual gameplay;</li>
<li>it tries to <a href="./images/ear-dlcs.png">suck money</a> from you by introducing more and more (<em>tiny</em>) DLCs, bringing the total price way too high.</li>
</ul>
<p>I mean, what the fuck is <a href="https://store.steampowered.com/app/1328670/">this shit</a>:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/mass-effect-drm.png" alt="Mass Effect as an example of a retarded form of DRM">

<p>Isn&rsquo;t it a little bit too fucking much? That is a great example of a game which I will never pay a single cent for, not even when it gets a 99% discount. By the way, this game is available on RuTracker under ID <code>6065973</code>.</p>
<p>And yes, in vast majority of cases the pirated versions of the same games have no launchers, they are not tied to online services, they don&rsquo;t force creating accounts in all sorts of retarded services, they don&rsquo;t require internet connection for no reason (<em>such as when playing an offline single-player kind of game</em>) and they run with better performance due to the absence of DRM/anti-tamper crap.</p>
<p>Of course, all that isn&rsquo;t related to Steam Deck at all, this is just my thoughts/rant on the subject in general.</p>
<p>And mainly this section is not about how to pirate a game, it is about how one can install/add a non-Steam game having an installer or a &ldquo;portable&rdquo; distribution. This also covers perfectly fine cases of installing a game purchased on <a href="https://gog.com/">GOG</a> or on a physical disk in an &ldquo;offline&rdquo; store.</p>
<h3 id="civilization-vi">Civilization VI</h3>
<p>I&rsquo;ll start with <a href="https://store.steampowered.com/app/289070/">Civilization VI</a> and will describe the process step by step, so this section will be rather long. But thanks to that sections for other games will be shorter, as all these steps remain the same for every game.</p>
<p>Civilization VI game is sold in Steam store, and since I liked the <a href="#civilization-v">Civilization V</a> a lot, I wanted to try this one too. However, I discovered that it contains even more DLCs, making the the total price more than 200 USD. Fuck this, I am not paying that much.</p>
<p>Moreover, instead of buying the game and its DLCs one by one you can buy a bundle, but there are several bundles, and you need to know the difference between them, so you don&rsquo;t waste your money on buying the wrong one, as it will end up being worse than the other. In the particular case of Civilization VI there are two bundles at the moment: <a href="https://store.steampowered.com/bundle/12218/Sid_Meiers_Civilization_VI__Platinum_Edition/">Sid Meier&rsquo;s Civilization VI Platinum Edition</a> and <a href="https://store.steampowered.com/bundle/21432/Sid_Meiers_Civilization_VI_Anthology/">Sid Meier&rsquo;s Civilization VI Anthology</a>. Do they expect me to compary those item by item? The fuck I will, I have a better use for my time.</p>
<p>In addition, it requires accepting a <a href="https://store.steampowered.com//eula/289070_eula_0">EULA</a>, which in turn refers to <a href="https://take2games.com/privacy/en-US#Categories_of_Information_Collected">Take-Two privacy policy</a>, where they say that they can collect a lot of your data, including &ldquo;<em>name, user name, gamertag, postal and email address, phone number, unique IDs, mobile device ID, platform ID, gaming service ID, advertising ID and IP address</em>&rdquo;. Well, Take Two, how about you go fuck yourselves, isn&rsquo;t it a bit too fucking much of data? I just want to play a bloody game, why does it need to spy on me and send all of this back to you?</p>
<p>Also, looking at reviews in Steam, there is a number of problems from performance issues to not being able to save games, which developers do not fix, and yet it is still expected that you pay for the game (<em>and its gazillion of DLCs</em>).</p>
<p>As a last drop, the game has a launcher. So yeah, I am not paying for this. Instead you can find it on RuTracker, the thread ID is <code>5335537</code>: this one contains all the DLCs released at the moment and runs without a launcher (<em>and hopefully also doesn&rsquo;t send your data to Take Two or whomever</em>).</p>
<p>Okay, we got ourselves a Windows installer of a game. Now, how does one install it on SteamOS? You could probably start by watching this <a href="https://youtu.be/_MlHNF-ueXg">video tutorial</a>, it covers the general process very well. And I will provide my instructions below for the particular case of installing Civilization VI.</p>
<p>Switch to Desktop mode, transfer the installer somewhere, for example I&rsquo;ve put mine to <code>~/Downloads/</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ ls <span style="color:#f92672">-</span>L1 <span style="color:#f92672">~/</span><span style="color:#a6e22e">Downloads</span><span style="color:#f92672">/</span>civilization<span style="color:#f92672">-</span>vi<span style="color:#f92672">/</span>installer<span style="color:#f92672">/</span> <span style="color:#f92672">|</span> sort <span style="color:#f92672">-</span>V
</span></span><span style="display:flex;"><span>civ6<span style="color:#f92672">-</span>setup<span style="color:#f92672">.</span>exe
</span></span><span style="display:flex;"><span>civ6<span style="color:#f92672">-</span>setup<span style="color:#f92672">-</span><span style="color:#ae81ff">1.</span>bin
</span></span><span style="display:flex;"><span>civ6<span style="color:#f92672">-</span>setup<span style="color:#f92672">-</span><span style="color:#ae81ff">2.</span>bin
</span></span><span style="display:flex;"><span>civ6<span style="color:#f92672">-</span>setup<span style="color:#f92672">-</span><span style="color:#ae81ff">3.</span>bin
</span></span><span style="display:flex;"><span>civ6<span style="color:#f92672">-</span>setup<span style="color:#f92672">-</span><span style="color:#ae81ff">4.</span>bin
</span></span><span style="display:flex;"><span>civ6<span style="color:#f92672">-</span>setup<span style="color:#f92672">-</span><span style="color:#ae81ff">5.</span>bin
</span></span><span style="display:flex;"><span>civ6<span style="color:#f92672">-</span>setup<span style="color:#f92672">-</span><span style="color:#ae81ff">6.</span>bin
</span></span><span style="display:flex;"><span>civ6<span style="color:#f92672">-</span>setup<span style="color:#f92672">-</span><span style="color:#ae81ff">7.</span>bin
</span></span><span style="display:flex;"><span>civ6<span style="color:#f92672">-</span>setup<span style="color:#f92672">-</span><span style="color:#ae81ff">8.</span>bin
</span></span><span style="display:flex;"><span>civ6<span style="color:#f92672">-</span>setup<span style="color:#f92672">-</span><span style="color:#ae81ff">9.</span>bin
</span></span><span style="display:flex;"><span>civ6<span style="color:#f92672">-</span>setup<span style="color:#f92672">-</span><span style="color:#ae81ff">10.</span>bin</span></span></code></pre></div>
<p>Open Steam, click on <code>Add a game</code>, then <code>Add a Non-Steam Game</code> and <code>Browse</code>. Find the <code>civ6-setup.exe</code> file (<em>choose <code>All files</code> in the file type dropdown</em>):</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-add-game-browsing.png" alt="Steam, Add a game, browsing files">

<p>Open it, and new entry will get added to the list:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-add-game.png" alt="Steam, Add a game">

<p>Click on <code>Add selected programs</code>. It will get added to the list of games in your library. Select it and open <code>Properties</code>:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-game-properties.png" alt="Steam, game properties">

<p>In <code>Shortcut</code> section set the <code>SteamAppId</code> environment variable in the launch options:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-game-properties-shortcut-installer.png" alt="Steam, game properties, shortcut">

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">SteamAppId</span><span style="color:#66d9ef">=</span><span style="color:#ae81ff">289070</span> <span style="color:#f92672">%</span>command<span style="color:#f92672">%</span></span></span></code></pre></div>
<p>That should (<em>but it doesn&rsquo;t</em>) assign this library entry/shortcut the ID of the Steam store version of the game. The most useful thing about this (<em>if it actually worked</em>) is discovering the <a href="#community-layouts">community controller layouts</a> for this game.</p>
<p>The <code>289070</code> value is the Steam App ID of <a href="https://steamdb.info/app/289070/">Civilization VI</a>. The <code>%command%</code> value is a substitute for the <code>TARGET</code> value, so what&rsquo;s happenning here is you are setting an environment variable for a command just like you&rsquo;d do that in shell/terminal.</p>
<p>You might see others saying that you also need to set <code>SteamGameId</code> variable:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">SteamGameId</span><span style="color:#66d9ef">=</span><span style="color:#ae81ff">289070</span> <span style="color:#a6e22e">SteamAppId</span><span style="color:#66d9ef">=</span><span style="color:#ae81ff">289070</span> <span style="color:#f92672">%</span>command<span style="color:#f92672">%</span></span></span></code></pre></div>
<p>But when I did that, the game started running somewhere offscreen, as I could hear the game sounds of the intro playing and then the main menu music, but on the screen I only saw an infinite Steam loading animation:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-deck-infinite-loading-animation.jpg" alt="Steam Deck, infinite loading animation">

<p>So I did not set <code>SteamGameId</code>. And later I also stopped setting <code>SteamAppId</code>, as it doesn&rsquo;t seem to affect anything, but more on that <a href="#community-controller-layout">later</a>.</p>
<p>Next, in <code>Compatibility</code> section check the box and select <code>Proton Experimental</code>:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-game-properties-compatibility.png" alt="Steam, game properties, compatibility">

<p>The installer is ready to launch now:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-game-launch.png" alt="Steam, game launch, compatibility">

<p>First time I saw this, it felt like magic - a Windows game installer launches on a GNU/Linux host:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-launching-windows-installer-language.png" alt="Steam, Windows game installer language">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-launching-windows-installer.png" alt="Steam, Windows game installer">

</p>
<p>By default it wants to install on disk <code>D:</code>, which I&rsquo;ve no idea where that really is, as disk <code>C:</code> is for the system drive and disk <code>E:</code> is for the SD card. I chose to install it on SD card:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-launching-windows-installer-path.png" alt="Steam, Windows game installer, choosing path">

<p>Some manuals tell to set <code>STEAM_COMPAT_MOUNTS</code> variable in launch options:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">STEAM_COMPAT_MOUNTS</span><span style="color:#f92672">=/</span>run<span style="color:#f92672">/</span>media<span style="color:#f92672">/</span>mmcblkOp1<span style="color:#f92672">/</span> <span style="color:#f92672">%</span>command<span style="color:#f92672">%</span></span></span></code></pre></div>
<p>Which is supposed to enable SD card path discovery. But I did not need to do that, all the installers I&rsquo;ve been launching always had the SD card path (<em>disk <code>E:</code></em>) available to choose in the disks tree. It might be that in earlier versions of SteamOS/Proton it was indeed required, but apparently not anymore.</p>
<p>The rest of the installation is trivial:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-launching-windows-installer-in-progress.png" alt="Steam, Windows game installer, installing a game">

<p>It took some time to unpack and on the last step it also suggested to enable some NTFS compression, but it&rsquo;s probably safer not to do that:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/civilization-vi-installer-ntfs-compression.png" alt="Civilization VI installer, NTFS compression">

<p>Once the game is installed, open <code>Properties</code> again and replace the installer&rsquo;s <code>.exe</code> with the <code>.exe</code> of the actual game. To find where it is installed, go to the installation path and try to find what might be looking as a game executable:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ ls <span style="color:#f92672">-</span>L1 <span style="color:#f92672">/</span>run<span style="color:#f92672">/</span>media<span style="color:#f92672">/</span>mmcblk0p1<span style="color:#f92672">/</span>games<span style="color:#f92672">/</span>civilization<span style="color:#f92672">-</span>vi<span style="color:#f92672">/</span><span style="color:#a6e22e">Base</span><span style="color:#f92672">/</span><span style="color:#a6e22e">Binaries</span><span style="color:#f92672">/</span><span style="color:#a6e22e">Win64Steam</span><span style="color:#f92672">/</span> <span style="color:#f92672">|</span> grep <span style="color:#f92672">.</span>exe
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CivilizationVI_DX12</span><span style="color:#f92672">.</span>exe
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CivilizationVI</span><span style="color:#f92672">.</span>exe</span></span></code></pre></div>
<p>Let&rsquo;s try the DirectX 12 version, change the <code>TARGET</code> and <code>START IN</code> values accordingly:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-game-properties-shortcut-installed.png" alt="Steam, game properties, shortcut">

<p>It didn&rsquo;t fit on the screenshot, but the last part of the path in <code>TARGET</code> is <code>CivilizationVI_DX12.exe</code>.</p>
<p>As an intermediate summary, what we did:</p>
<ol>
<li>Added the game&rsquo;s installer as a non-Steam game and installed the game;</li>
<li>After the game was installed, replaced the installer&rsquo;s <code>.exe</code> with the installed game&rsquo;s <code>.exe</code> within the same entry/shortcut properties.</li>
</ol>
<p>Why we did that within the same shortcut? Because when a game is added to Steam, a <a href="#proton-prefixes">Proton prefix</a> is created for it, and that is where the game&rsquo;s Windows environment is located, even though the game files are installed where you told the installer to install them to. And so if you will install a game using one prefix and then will try to launch it by adding its <code>.exe</code> as a new non-Steam game, that will end up having a different Proton prefix created for it and so the game will likely not work, especially if the installer did something else aside from just unpacking the game files (<em>for example, it could&rsquo;ve added some keys to the registry</em>), which you obviously will not have in a different prefix environment.</p>
<p>Now the game can be launched. In most cases it will just work, because, as I understood it, recent Proton versions already contain required <a href="https://microsoft.com/en-us/download/confirmation.aspx?id=8109">DirectX</a> and <a href="https://microsoft.com/en-US/download/confirmation.aspx?id=52685">Visual C++ runtime</a> libraries. If the game doesn&rsquo;t launch, you&rsquo;ll probably get errors about missing DLLs, and then you will need to install DirectX or/and Visual C++ runtime by opening the game <code>Properties</code> again and replacing the <code>TARGET</code> executable with the package installer, installing it and replacing the <code>TARGET</code> back to the game executable - all that still within the same entry/shortcut, so everything is installed inside the same Proton prefix.</p>
<p>Civilization VI did not require any of that, it launched and ran without problems:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/civilization-vi-main-menu.jpg" alt="Steam Deck, Civilization VI main menu">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/civilization-vi-mangohud.jpg" alt="Steam Deck, Civilization VI, MangoHud metrics">

</p>
<h4 id="posters-backgrounds-logos-icons">Posters, backgrounds, logos, icons</h4>
<p>Now when the game is running, you can rename it from the ugly <code>civ6-setup.exe</code> and set posters, backgrounds, logos, icons using images from <a href="https://steamgriddb.com/game/4150">SteamGridDB</a>.</p>
<p>Here&rsquo;s how it looks now in my library in Desktop mode:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/civilization-vi-steam-desktop.png" alt="Civilization VI in Steam game gallery in Desktop mode">

<p>and in Gaming mode:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/civilization-vi-steam-gamescope-1.jpg" alt="Civilization VI in Steam game gallery in Gaming mode on Steam Deck">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/civilization-vi-steam-gamescope-2.jpg" alt="Civilization VI in Steam game gallery in Gaming mode on Steam Deck">

</p>
<p>To set vertical and horizontal posters for the gallery, in Desktop mode go to <code>HOME</code> screen and there you&rsquo;ll be able to set them under <code>Recent games</code> section by running a game that you ran before and then this one again:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-library-recent-games-1.png" alt="Steam library, recent games">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-library-recent-games-2.png" alt="Steam library, recent games">

</p>
<h4 id="community-controller-layout">Community controller layout</h4>
<p>As Civilization VI is available in Steam store, it already has pre-made community controller layouts, but since you installed is as a non-Steam game, you won&rsquo;t get them on Community Layouts tab:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/non-steam-game-no-community-layouts.jpg" alt="Non-Steam game, no community layouts">

<p>But you can &ldquo;fake&rdquo; the Steam App ID for the game, and then Steam will pull up the community layouts based on the provided ID. Like I said earlier, first I tried to do that by setting <code>SteamAppId</code> environment variable in the launch options:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">SteamAppId</span><span style="color:#66d9ef">=</span><span style="color:#ae81ff">289070</span> <span style="color:#f92672">%</span>command<span style="color:#f92672">%</span></span></span></code></pre></div>
<p>But that didn&rsquo;t have any effect. The other way, which actually works, is to rename the game from <code>Civilization VI</code> to <code>289070</code>, like this:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/non-steam-game-rename-steamappid.jpg" alt="Non-Steam game, renaming to SteamAppID">

<p>Or you can also rename the game to how it is titled in Steam store (<em><code>Sid Meier’s Civilization® VI</code></em>), that should also work.</p>
<p>Anyway, after renaming the game community layouts did show up:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/civilization-vi-community-layouts.jpg" alt="Steam Deck, Civilization VI community layouts">

<p>Now the task is to save a selected layout somehow, so it would remain available after the game is renamed back. First I tried to export it as <code>New Template</code>:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-deck-controller-layout-export-as-template.jpg" alt="Steam Deck, exporting community layout as New Template">

<p>And that worked: after I renamed the game back, I still had this layout in my list of templates. But first of all, this is not a clean way to do this, because soon enough you&rsquo;ll &ldquo;spam&rdquo; your templates list with layouts that are not really templates, as they are only suitable for particular games. Secondly, for me this worked only once, I could never succeed doing the same for other games, their layouts never showed up in the list of templates, even though I did everything the same way.</p>
<p>That lead to me a different way, which is actually a cleaner one and probably is the correct/intended way of saving layouts. You still need to export it, but not as <code>New Template</code>, you should choose the <code>New Personal Save</code> option:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-deck-controller-layout-export-as-personal.jpg" alt="Steam Deck, exporting community layout as New Personal Save">

<p>But here comes the tricky part. Do not rename the game back just yet. First go to the <code>Your Layouts</code> tab:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-deck-your-layouts-tab.jpg" alt="Steam Deck, Your Layouts tab">

<p>and select, download and apply this layout. Now you can rename the game back:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/non-steam-game-rename.jpg" alt="Non-Steam game, renaming to original title">

<p>and then this layout will still be available on <code>Your Layouts</code> tab, and you&rsquo;ll be able to select it:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/steam-deck-selected-controller-layout.jpg" alt="Steam Deck, selected controller layout">

<p>Congratulations, you are all set to enjoy a non-Steam game that you have installed and customized yourself. And like I said, these steps are the same for any other game or application, so you have everything you need to grow your game library on your own.</p>
<h4 id="removing-a-non-steam-game">Removing a non-Steam game</h4>
<p>I played Civilization VI for a couple of days and came to a conclusion that I don&rsquo;t like it. The game mechanics and UI are far too overloaded with stuff comparing to Civilization V, plus the graphics are all childish. What a waste of money it would be, if I purchased it.</p>
<p>Before doing anything, find out what <a href="#proton-prefixes">Steam App ID</a> it got, if you don&rsquo;t know it yet.</p>
<p>First remove the game from Steam library (<em><code>Manage</code> → <code>Remove from your library</code></em>):</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/civilization-vi/removing-game-from-steam-library-desktop-mode.png" alt="Removing non-Steam game from library">

<p>Then delete the game files from where you installed them to:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ rm <span style="color:#f92672">-</span>r <span style="color:#f92672">/</span>run<span style="color:#f92672">/</span>media<span style="color:#f92672">/</span>mmcblk0p1<span style="color:#f92672">/</span>games<span style="color:#f92672">/</span>civilization<span style="color:#f92672">-</span>vi </span></span></code></pre></div>
<p>Then, knowing the Steam App ID, delete its Proton prefix (<em>after backing up your savegames/configs/etc</em>) and shader cache. In my case, Civilization VI got the ID <code>3357182463</code>, so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>$ rm <span style="color:#f92672">-</span>r <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>steamapps<span style="color:#f92672">/</span>compatdata<span style="color:#f92672">/</span><span style="color:#ae81ff">3357182463</span>
</span></span><span style="display:flex;"><span>$ rm <span style="color:#f92672">-</span>r <span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>steamapps<span style="color:#f92672">/</span>shadercache<span style="color:#f92672">/</span><span style="color:#ae81ff">3357182463</span></span></span></code></pre></div>
<p>If you would also like to remove the game <a href="#screenshots">screenshots</a>, then the ID that you found for the prefix path won&rsquo;t be of use, as screenshots path uses a different ID of unknown origin. And actually, do not remove screenshots files manually, because <code>/home/deck/.local/share/Steam/userdata/YOUR-ACCOUNT-ID/760/screenshots.vdf</code> will still contain references to them, so your Media gallery will have empty items like this:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/leftovers-from-deleted-screenshots.jpg" alt="Steam Deck, empty items in Media gallery">

<p>So the only way to properly remove screenshots is to remove them one by one (<em>due to the lack of bulk operations</em>) in Media gallery.</p>
<h3 id="batman-arkham-knight">Batman Arkham Knight</h3>
<p>I was never going to play <a href="https://store.steampowered.com/app/208650/">Batman Arkham Knight</a>, as I&rsquo;ve never been fan of the series. But I stumbled upon <a href="https://youtu.be/-7o9VHxXTwg">this video</a> and got curious.</p>
<p>Trying to install and launch it, I&rsquo;ve encountered some problems which I didn&rsquo;t have with Civilization VI, so this section will be a kind of additional set of instructions for cases when non-Steam games/applications don&rsquo;t work out of the box.</p>
<p>The game is also available in Steam, but it has this <a href="https://en.wikipedia.org/wiki/Denuvo">Denuvo</a> shit, requiring you to be online even for a single-player offline gameplay. It also has a lot of DLC which double its price, and of course there is 3rd-party EULA, so I am not paying for this one either. You can find it on RuTracker by the ID <code>5325528</code> (<em>don&rsquo;t download it from there, read first</em>).</p>
<p>The installations steps are the same as with <a href="#civilization-vi">Civilization VI</a>. Unfortunately, The &ldquo;installer&rdquo; turned out to be a wretched crap made by some idiot, because, beside retarded design and logos, it uses a cyrillic encoding <code>Windows-1251</code>, which results in unreadable garbage in the UI (<em>look at the buttons and text labels</em>):</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/batman-arkham-knight/installer-windows-1251-1.png" alt="Installer with Windows-1251 encoding">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/batman-arkham-knight/installer-windows-1251-2.png" alt="Installer with Windows-1251 encoding">

</p>
<p>Fortunately, you can set the encoding via <code>LANG</code> environment variable in the launch options:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">LANG</span><span style="color:#66d9ef">=</span>ru_RU<span style="color:#f92672">.</span><span style="color:#a6e22e">CP1251</span> <span style="color:#f92672">%</span>command<span style="color:#f92672">%</span></span></span></code></pre></div>
<p>And then UI labels get normal russian letters which one can actually read/translate:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/batman-arkham-knight/installer-1.png" alt="Windows installer for a pirated game">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/batman-arkham-knight/installer-2.png" alt="Windows installer for a pirated game">

</p>
<p>After the installation is done, I changed the <code>TARGET</code> from the installer <code>.exe</code> to the installed game <code>.exe</code> and tried to launch the game, but it didn&rsquo;t launch and didn&rsquo;t show any error dialogs.</p>
<h4 id="figuring-out-why-a-game-does-not-launch">Figuring out why a game does not launch</h4>
<p>That&rsquo;s how I got familiar with various techniques of figuring out why a game does not launch. None of these actually helped in this particular case, as you&rsquo;ll see later, but they are useful nonetheless, and you should at least know how you can try to find out possible launch problems.</p>
<p>The first thing you should check is the game&rsquo;s own logs, which might be written to a file in the game installation folder or somewhere inside the prefix. I didn&rsquo;t find any for this game, though.</p>
<p>Secondly, you can check Proton logs. They are disabled by default, so go to <code>/home/deck/.local/share/Steam/steamapps/common/Proton - Experimental/</code> (<em>or whichever version is used to run the game</em>) and rename <code>user_settings.sample.py</code> to <code>user_settings.py</code>. Or set <code>PROTON_LOG=1</code> environment variable in the game launch options (<em>by the way, here are some more <a href="https://github.com/ValveSoftware/Proton#runtime-config-options">Proton options</a></em>).</p>
<p>Having enabled the logs, you will get them written to <code>/home/deck/steam-SOME-ID.log</code>. Sadly, I didn&rsquo;t find any useful output there relevant to my problem.</p>
<p>Another thing one can try is redirect the game output to file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#f92672">%</span>command<span style="color:#f92672">%</span> <span style="color:#f92672">&gt;</span> <span style="color:#f92672">/</span>tmp<span style="color:#f92672">/</span>batman<span style="color:#f92672">.</span>log</span></span></code></pre></div>
<p>If the file will be empty, then it is likely because errors are printed to <code>stderr</code> and not <code>stdout</code>, so you will need to redirect it too:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#f92672">%</span>command<span style="color:#f92672">%</span> <span style="color:#f92672">&gt;</span> <span style="color:#f92672">/</span>tmp<span style="color:#f92672">/</span>batman<span style="color:#f92672">.</span>log <span style="color:#ae81ff">2</span><span style="color:#f92672">&gt;&amp;</span><span style="color:#ae81ff">1</span></span></span></code></pre></div>
<p>After that I got some information written to file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ less /tmp/batman.log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ERROR: ld.so: object <span style="color:#e6db74">&#39;/home/deck/.local/share/Steam/ubuntu12_64/gameoverlayrenderer.so&#39;</span> from LD_PRELOAD cannot be preloaded <span style="color:#f92672">(</span>wrong ELF class: ELFCLASS64<span style="color:#f92672">)</span>: ignored.
</span></span><span style="display:flex;"><span>ERROR: ld.so: object <span style="color:#e6db74">&#39;/home/deck/.local/share/Steam/ubuntu12_32/gameoverlayrenderer.so&#39;</span> from LD_PRELOAD cannot be preloaded <span style="color:#f92672">(</span>wrong ELF class: ELFCLASS32<span style="color:#f92672">)</span>: ignored.
</span></span><span style="display:flex;"><span>ERROR: ld.so: object <span style="color:#e6db74">&#39;/home/deck/.local/share/Steam/ubuntu12_32/gameoverlayrenderer.so&#39;</span> from LD_PRELOAD cannot be preloaded <span style="color:#f92672">(</span>wrong ELF class: ELFCLASS32<span style="color:#f92672">)</span>: ignored.
</span></span><span style="display:flex;"><span>ERROR: ld.so: object <span style="color:#e6db74">&#39;/home/deck/.local/share/Steam/ubuntu12_32/gameoverlayrenderer.so&#39;</span> from LD_PRELOAD cannot be preloaded <span style="color:#f92672">(</span>wrong ELF class: ELFCLASS32<span style="color:#f92672">)</span>: ignored.
</span></span><span style="display:flex;"><span>fsync: up and running.
</span></span><span style="display:flex;"><span>wine: RLIMIT_NICE is &lt;<span style="color:#f92672">=</span> 20, unable to use setpriority safely</span></span></code></pre></div>
<p>I thought these are actual errors, so I started googling them. Found <a href="https://bbs.archlinux.org/viewtopic.php?id=211591">this thread</a> where they recommend to add <code>LD_PRELOAD=&quot;libpthread.so.0 libGL.so.1&quot;</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">LD_PRELOAD</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;libpthread.so.0 libGL.so.1&#34;</span> <span style="color:#f92672">%</span>command<span style="color:#f92672">%</span> <span style="color:#f92672">&gt;</span> <span style="color:#f92672">/</span>tmp<span style="color:#f92672">/</span>batman<span style="color:#f92672">.</span>log <span style="color:#ae81ff">2</span><span style="color:#f92672">&gt;&amp;</span><span style="color:#ae81ff">1</span></span></span></code></pre></div>
<p>But actually I noticed that just setting <code>LD_PRELOAD</code> to an empty string gives the same effect (<em>if not a better one</em>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">LD_PRELOAD</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">%</span>command<span style="color:#f92672">%</span> <span style="color:#f92672">&gt;</span> <span style="color:#f92672">/</span>tmp<span style="color:#f92672">/</span>batman<span style="color:#f92672">.</span>log <span style="color:#ae81ff">2</span><span style="color:#f92672">&gt;&amp;</span><span style="color:#ae81ff">1</span></span></span></code></pre></div>
<p>That got rid of most of the errors, as the output got shorter:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>fsync: up and running.
</span></span><span style="display:flex;"><span>wine: RLIMIT_NICE is &lt;<span style="color:#f92672">=</span> 20, unable to use setpriority safely
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>S_API FAIL<span style="color:#f92672">]</span> SteamAPI_Init<span style="color:#f92672">()</span> failed; connect to global user failed.</span></span></code></pre></div>
<p>But the game still wasn&rsquo;t launching. Then just in case I checked the Civilization VI output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ERROR: ld.so: object <span style="color:#e6db74">&#39;/home/deck/.local/share/Steam/ubuntu12_64/gameoverlayrenderer.so&#39;</span> from LD_PRELOAD cannot be preloaded <span style="color:#f92672">(</span>wrong ELF class: ELFCLASS64<span style="color:#f92672">)</span>: ignored.
</span></span><span style="display:flex;"><span>ERROR: ld.so: object <span style="color:#e6db74">&#39;/home/deck/.local/share/Steam/ubuntu12_32/gameoverlayrenderer.so&#39;</span> from LD_PRELOAD cannot be preloaded <span style="color:#f92672">(</span>wrong ELF class: ELFCLASS32<span style="color:#f92672">)</span>: ignored.
</span></span><span style="display:flex;"><span>ERROR: ld.so: object <span style="color:#e6db74">&#39;/home/deck/.local/share/Steam/ubuntu12_32/gameoverlayrenderer.so&#39;</span> from LD_PRELOAD cannot be preloaded <span style="color:#f92672">(</span>wrong ELF class: ELFCLASS32<span style="color:#f92672">)</span>: ignored.
</span></span><span style="display:flex;"><span>ERROR: ld.so: object <span style="color:#e6db74">&#39;/home/deck/.local/share/Steam/ubuntu12_32/gameoverlayrenderer.so&#39;</span> from LD_PRELOAD cannot be preloaded <span style="color:#f92672">(</span>wrong ELF class: ELFCLASS32<span style="color:#f92672">)</span>: ignored.
</span></span><span style="display:flex;"><span>fsync: up and running.
</span></span><span style="display:flex;"><span>wine: RLIMIT_NICE is &lt;<span style="color:#f92672">=</span> 20, unable to use setpriority safely
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>S_API FAIL<span style="color:#f92672">]</span> SteamAPI_Init<span style="color:#f92672">()</span> failed; connect to global user failed.Fossilize INFO: Overriding serialization path: <span style="color:#e6db74">&#34;/home/deck/.local/share/Steam/steamapps/shadercache/3357182463/fozpipelinesv6/steamapprun_pipeline_cache&#34;</span>.
</span></span><span style="display:flex;"><span>pid <span style="color:#ae81ff">40728</span> !<span style="color:#f92672">=</span> 40727, skipping destruction <span style="color:#f92672">(</span>fork without exec?<span style="color:#f92672">)</span></span></span></code></pre></div>
<p>Same errors, but the game works fine. So apparently these are not actual errors, and there is probably no need to set <code>LD_PRELOAD</code>.</p>
<p>By that moment I was out of ideas where else I can find logs / error messages, so scientific approach came to an end, and it was time for shamanic rituals.</p>
<p>I tried explicitly installing DirectX, Visual C++ runtime and .NET Framework, having downloaded them from Microsoft&rsquo;s website, and I tried the versions that were available around 2015 too. I also tried installing <a href="https://en.wikipedia.org/wiki/PhysX">PhysX</a>, but none of that helped.</p>
<p>I tried using different Proton versions, and even <a href="https://github.com/GloriousEggroll/proton-ge-custom#native">installed Proton GE</a> (<em>speaking of which, there is no need to involve 3rd-party installers/helpers like <a href="https://davidotek.github.io/protonup-qt/">ProtonUp-Qt</a>, as many recommend to</em>), but that didn&rsquo;t help either.</p>
<p>And yet people <a href="https://protondb.com/app/208650">are reporting</a> that the game runs on Steam Deck, so the only remaining reason why mine doesn&rsquo;t is that I&rsquo;ve downloaded a crap of a version. Which wouldn&rsquo;t be a big surprise, given its horrendous &ldquo;installer&rdquo;.</p>
<p>And only then I discovered that this game is actually <a href="https://gog.com/en/game/batman_arkham_knight_premium_edition">available on GOG</a>! I searched on RuTracker some more and found that version under the ID <code>5976829</code>. That one installs and runs just fine, zero fucking about required.</p>
<p>Of course, now that I know that the game is available on GOG without Denuvo crap, I have no arguments against paying for it. And so if I&rsquo;ll like it, I will certainly purchase it.</p>
<h3 id="heroes-of-might-and-magic-3">Heroes of Might and Magic 3</h3>
<p>Soon after Steam Deck was first announced, some meme-channel published this video:</p>






<video  controls="yes"   class="video">
    <source src="https://files.decovar.dev/public/blog/steam-deck/heroes-3-at-party.mp4" type="video/mp4">
</video>

<p class="video-fallback">If video doesn't play in your browser, you can download it <a href="https://files.decovar.dev/public/blog/steam-deck/heroes-3-at-party.mp4">here</a></p>


<p>I strongly suspect that a lot of people found this video especially funny because it is so true - who wouldn&rsquo;t like to play HoMM 3 on a portable device no matter where you are.</p>
<p>And then after Steam Deck was released, this turned out to be no joke at all, as HoMM 3 runs on it even better than how it was shown on the video:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/homm-3/homm-3-mangohud.jpg" alt="Steam Deck, Heroes of Might and Magic 3, MangoHud metrics">

<p>Steam store has a <a href="https://store.steampowered.com/app/297000/Heroes_of_Might__Magic_III__HD_Edition/">version of HoMM 3</a>, but it&rsquo;s a cripple of a game comparing to a <a href="https://gog.com/en/game/heroes_of_might_and_magic_3_complete_edition">proper complete edition</a> on GOG, which is the one I bought. I also installed the <a href="https://sites.google.com/site/heroes3hd/">HD mod</a> on top.</p>
<p>The steps are all the same as I described in <a href="#civilization-vi">Civilization VI</a> section. One additional step is that after running the game installer I also ran the HD mod installer (<em>within the same shortcut/prefix, of course</em>) and only after that changed the <code>TARGET</code> to the game executable.</p>
<p>Here it is in my library:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/homm-3/homm3-steam-gamescope-1.jpg" alt="HoMM 3 in Steam game gallery in Gaming mode">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/homm-3/homm3-steam-gamescope-2.jpg" alt="HoMM 3 in Steam game gallery in Gaming mode">

</p>
<p>I didn&rsquo;t find a better background on <a href="https://steamgriddb.com/game/5247456">SteamGridDB</a> and was too lazy to make my own.</p>
<h3 id="diablo-ii-resurrected">Diablo II Resurrected</h3>
<p>The next game in line was <a href="https://diablo2.blizzard.com/">Diablo II Resurrected</a>.</p>
<p>I wanted to get that one for a long time, and I would <strong>gladly</strong> pay the full price for it, but luckily I read the reviews before buying. As it turned out, you cannot play the game without internet, even if you want to play alone, not on <a href="https://diablo.fandom.com/wiki/Ladder">Ladder</a>, offline. That is an outrageous limitation. By the way, there is no local multiplayer either.</p>
<p>I also remembered all the retarted shit that Blizzard has been pulling over the past years with firing people, renaming characters in games, censoring nice-looking characters into ugly crocodiles (<em>in some cases <a href="./images/hearthstone-succubus.png">quite literally</a></em>), blocking access for players from certain countries and so on. Thus, it is not soon when Blizzard will see any money from me.</p>
<p>Needless to say, I went to RuTracker and found the game there under the ID <code>6239713</code>.</p>
<p>When you will be downloading it, make sure that you also download the dot-files, because some SFTP/FTPS clients might skip downloading these files (<em>as it happened in my case</em>):</p>
<ul>
<li><code>.product.db</code> - probably not needed, but just in case;</li>
<li><code>.build.info</code> - this one certainly is required, the game won&rsquo;t launch without it.</li>
</ul>
<p>This version of the game doesn&rsquo;t require installation (<em>why aren&rsquo;t all the games are distributed like that</em>) and does not need Battle.net launcher. It is ready to be added to Steam as usual and run right away. But there is one peculiarity: you need to import the <code>Offline.reg</code> <a href="https://en.wikipedia.org/wiki/Windows_Registry">registry</a> file that disables the online stuff (<em>sets Blizzard hosts to <code>0.0.0.0</code>, by the looks of it</em>).</p>
<p>One way to do that is to launch the RegEdit application and import the registry file there. For that you need to browse for <code>regedit.exe</code> in <code>/home/deck/.local/share/Steam/steamapps/compatdata/THE-GAME-PREFIX-ID-HERE/pfx/drive_c/windows/</code> and set it as the <code>TARGET</code> executable in the Steam shortcut properties. Although once you do that, it will be changed to a common path inside the Proton folder, which also means that launching it like this will open the default registry and not the one set for the game in its prefix. So you also need to set <code>STEAM_COMPAT_DATA_PATH</code> in the launch options:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#a6e22e">STEAM_COMPAT_DATA_PATH</span><span style="color:#f92672">=/</span>home<span style="color:#f92672">/</span>deck<span style="color:#f92672">/.</span>local<span style="color:#f92672">/</span>share<span style="color:#f92672">/</span><span style="color:#a6e22e">Steam</span><span style="color:#f92672">/</span>steamapps<span style="color:#f92672">/</span>compatdata<span style="color:#f92672">/</span><span style="color:#a6e22e">THE</span><span style="color:#f92672">-</span><span style="color:#a6e22e">GAME</span><span style="color:#f92672">-</span><span style="color:#a6e22e">PREFIX</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ID</span><span style="color:#f92672">-</span><span style="color:#a6e22e">HERE</span><span style="color:#f92672">/</span> <span style="color:#f92672">%</span>command<span style="color:#f92672">%</span></span></span></code></pre></div>
<p>Be careful to set the path to <code>/.../compatdata/THE-GAME-PREFIX-ID-HERE/</code> and not to <code>/.../compatdata/THE-GAME-PREFIX-ID-HERE/pfx/</code> or any other.</p>
<p>Here&rsquo;s how it looks:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/diablo-2-resurrected/steam-proton-launching-regedit.png" alt="Steam, Proton, launching RegEdit">

<p>As I understand it, the <code>STEAM_COMPAT_DATA_PATH</code> is the Proton&rsquo;s equivalent for <code>WINEPREFIX</code>.</p>
<p>Now you can launch it and import the registry file:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/diablo-2-resurrected/proton-regedit-importing.png" alt="Steam, Proton, importing a registry key with RegEdit">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/diablo-2-resurrected/proton-regedit-imported.png" alt="Steam, Proton, imported a registry key with RegEdit">

</p>
<p>Doing so adds values from that registry file to <code>/home/deck/.local/share/Steam/steamapps/compatdata/THE-GAME-PREFIX-ID-HERE/pfx/user.reg</code> (<em>and probably also something to <code>/.../pfx/system.reg</code>, because that file also got some changes, as it seems</em>). And I imported the values from <code>en_lang.reg</code> file too, just in case.</p>
<p>It will probably also work if you just set the path to a <code>*.reg</code> in launch options instead of <code>%command%</code>. I suspect that based on the file extension you will get a RegEdit import prompt, and it will get imported into the game prefix registry, but I haven&rsquo;t actually tested that.</p>
<p>Or one can probably just edit the prefix registry in <code>/.../pfx/user.reg</code> directly, for it&rsquo;s merely a plain-text file.</p>
<p>Anyway, I have successfully imported the registry keys, but the game didn&rsquo;t launch:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/diablo-2-resurrected/launch-error.png" alt="Diablo II Resurrected, launch error">

<p>I tried redirecting <code>stdout</code>/<code>stderr</code> outputs to a file, like I did with <a href="#figuring-out-why-a-game-does-not-launch">Batman Arkham Knight</a>, but there were no errors there. Fortunately, there is a log file inside the game folder - <code>blz-log.txt</code> - which is how I found out that my SFTP client did not download <code>.build.info</code> file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>3/5 15:01:17.041  <span style="color:#f92672">[</span>tact/4<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>&lt;&gt;:0<span style="color:#f92672">]</span>: Unable to stat install path: <span style="color:#e6db74">&#39;e:/games/diablo-2-resurrected/.build.info&#39;</span>. Error <span style="color:#f92672">(</span>2<span style="color:#f92672">)</span>: File not found</span></span></code></pre></div>
<p>I&rsquo;ve downloaded it, and then the game launched and ran fine.</p>
<p>There are some nice pictures on <a href="https://steamgriddb.com/game/5278139">SteamGridDB</a> to make the game look nice in your gallery:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/diablo-2-resurrected/diablo-ii-steam-gamescope-1.jpg" alt="Diablo II Resurrected in Steam game gallery in Gaming mode on Steam Deck">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/diablo-2-resurrected/diablo-ii-steam-gamescope-2.jpg" alt="Diablo II Resurrected in Steam game gallery in Gaming mode on Steam Deck">

</p>
<p>Another great news is that you can import your heroes from the original Diablo II. Although, despite what <a href="https://us.battle.net/support/en/article/286060">official documentation</a> says, the actual path is <code>C:\Users\YOUR-USERNAME\Documents\Diablo II Resurrected\Save</code>, so the full path with prefix is <code>/home/deck/.local/share/Steam/steamapps/compatdata/THE-GAME-PREFIX-ID-HERE/pfx/drive_c/users/steamuser/Documents/Diablo\ II\ Resurrected/Save/</code>.</p>
<p>Since the game has never been on Steam, there are no community controller layouts for it, so I&rsquo;ve created my own. It is used as an example in <a href="#steam-input">Steam Input</a> section, and you can download it <a href="https://github.com/retifrav/steam-deck-controller-layouts/tree/master/diablo-ii-resurrected">here</a>.</p>
<h4 id="savegame-path-change-after-proton-update">Savegame path change after Proton update</h4>
<p>I have Proton Experimental set for all my games: that way I always get the latest Proton without manually changing the version on the Compatibility tab. It was working fine until <a href="https://github.com/ValveSoftware/Proton/releases/tag/proton-8.0-1c">Proton 8</a>. I launched the game, and suddenly it walked me through quick display settings tutorial again, like this was the very first time I launched it, and all my characters were gone.</p>
<p>I thought that when Proton changed from 7 to 8 behind the scenes in Proton Experimental, a new <a href="#proton-prefixes">prefix</a> was created for the game. So I set Proton 7 explicitly and launched the game again - this time all my characters were back (<em>and settings too</em>). Then I ran <code>ls -ltr</code> to find the new prefix, but there were no new prefixes.</p>
<p>What actually happened, as I found out, is that when run with Proton 7 the game uses one path to find the savegames (<em>and settings</em>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#f92672">.../</span>compatdata<span style="color:#f92672">/</span><span style="color:#a6e22e">THE</span><span style="color:#f92672">-</span><span style="color:#a6e22e">GAME</span><span style="color:#f92672">-</span><span style="color:#a6e22e">PREFIX</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ID</span><span style="color:#f92672">-</span><span style="color:#a6e22e">HERE</span><span style="color:#f92672">/</span>pfx<span style="color:#f92672">/</span>drive_c<span style="color:#f92672">/</span>users<span style="color:#f92672">/</span>steamuser<span style="color:#f92672">/</span><span style="color:#a6e22e">Documents</span><span style="color:#f92672">/</span><span style="color:#a6e22e">Diablo</span> <span style="color:#a6e22e">II</span> <span style="color:#a6e22e">Resurrected</span><span style="color:#f92672">/</span><span style="color:#a6e22e">Save</span><span style="color:#f92672">/</span></span></span></code></pre></div>
<p>and when ran with Proton 8 the absolutely same game uses a different path within the same prefix:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span><span style="color:#f92672">.../</span>compatdata<span style="color:#f92672">/</span><span style="color:#a6e22e">THE</span><span style="color:#f92672">-</span><span style="color:#a6e22e">GAME</span><span style="color:#f92672">-</span><span style="color:#a6e22e">PREFIX</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ID</span><span style="color:#f92672">-</span><span style="color:#a6e22e">HERE</span><span style="color:#f92672">/</span>pfx<span style="color:#f92672">/</span>drive_c<span style="color:#f92672">/</span>users<span style="color:#f92672">/</span>steamuser<span style="color:#f92672">/</span><span style="color:#a6e22e">Saved</span> <span style="color:#a6e22e">Games</span><span style="color:#f92672">/</span><span style="color:#a6e22e">Diablo</span> <span style="color:#a6e22e">II</span> <span style="color:#a6e22e">Resurrected</span><span style="color:#f92672">/</span></span></span></code></pre></div>
<p>That new path is actually where <a href="https://us.battle.net/support/en/article/286060">Blizzard&rsquo;s documentation</a> points to as well. But how come with Proton 7 this path is different? This is probably because the game sets this path based on an environment variable, and that variable has changed in Proton 8. That would also mean that other games might be affected by this too.</p>
<p>Anyway, to be able to use Proton Experimental (<em>Proton 8, at the moment</em>), the &ldquo;fix&rdquo; is to move the contents of <code>.../steamuser/Documents/Diablo II Resurrected/Save/</code> to <code>.../steamuser/Saved Games/Diablo II Resurrected/</code>. Of course, if I would like to use Proton 7 again, I&rsquo;d need to move these files back.</p>
<p>One last thing to mention here is that when I wanted to choose a different Proton version on Compatibility tab, there was no dropdown list with Proton version and the checkbox control was disabled. I switched to Desktop mode, and there it was enabled and dropdown list was present. But at some point later the same happened in Desktop mode too (<em>no dropdown list and disabled checkbox control</em>), so I needed to switch to Gaming mode, and there it was all good. Never had this issue before.</p>
<h3 id="other-games">Other games</h3>
<p>Once I got comfortable with the process of installing non-Steam games, there was no stopping me. The installation was trivial in each case, without any new problems or anything worth mentioning. Here are just some comments and other smaller notes.</p>
<p><a href="https://store.steampowered.com/app/389730/">Tekken 7</a> forces 3rd-party EULA and has a trillion of DLCs, entire collection of which brings the full price to the level of a space ship. So RuTracker it is, you can find it there by the ID <code>5955725</code> (<em>another example of a great distribution, as there is no installation required</em>). The game runs well, but eats the battery very fast:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/tekken-7-mangohud.jpg" alt="Steam Deck, Tekken 7, MangoHud metrics">

<p><a href="https://store.steampowered.com/app/976310/">Mortal Kombat 11</a> also forces 3rd-party EULA, also has a lot of DLCs, plus some of the game content is only available online, so RuTracker ID is <code>6194626</code> (<em>once again, no installer</em>). It seems to be considerably better optimized than Tekken 7, as it is draws much less power:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/mortal-kombat-11-mangohud.jpg" alt="Steam Deck, Tekken 7, MangoHud metrics">

<p>Even without 40 FPS limit it renders at 60 FPS with 22 W consumption, while Tekken devours 25 W already on 40 FPS.</p>
<p>What&rsquo;s interesting though is that I suddenly discovered that I also have a library entry for the Steam store version of the game:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-deck-mortal-kombat-11-library-entry.jpg" alt="Steam Deck, library entry for pirated Mortal Kombat 11">

<p>It even counts my playtime and shows screenshots in the post-game summary. Of course, I still need to launch it from a non-Steam shortcut that I created. It also got the &ldquo;official&rdquo; Steam App ID assigned, as I can found the screenshots files and other stuff under the ID <a href="https://steamdb.info/app/976310/">976310</a>. Did this happen because of the shortcut name/title match with the game title in store? If so, then apparently one can just rename one&rsquo;s non-Steam games to their &ldquo;official&rdquo; Steam App IDs and still get some of the Steam benefits even for pirated games. And if <code>SteamAppId</code> environment variable was working as it should(<em>?</em>), then the whole thing would be even easier.</p>
<p>One last game to mention is <a href="https://store.steampowered.com/app/1174180/">Red Dead Redemption 2</a>. It forces a launcher, requires you to create a fucking Rockstar account, requires accepting 3rd-party EULA and worst of all it requires you to be connected to the internet even for an offline story playthrough. So fuck Rockstar, the RuTracker ID is <code>5958348</code> (<em>yet again, no installer</em>). Runs without problems and with a good performance too (<em>and without bloody launcher and completely offline</em>):</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/red-dead-redemption-2-mangohud.jpg" alt="Steam Deck, Red Dead Redemption 2, MangoHud metrics">

<p>I tried several other (<em>Windows-only</em>) games, and they all install and run with no problems whatsoever, absolutely nothing worth mentioning. Long live Wine, Proton, Valve and all the contributors.</p>
<h4 id="emulators">Emulators</h4>
<p>That&rsquo;s something I myself have almost zero interest in, but for many people this is a very big deal, so I have to at least mention it.</p>
<p>So, Steam Deck seems to be a very good fit for running emulators of various gaming consoles (<em>including Nintendo Switch, hehe</em>). It has more than enough computing power for it, controls ergonomics are simply the best, and the installation procedure can be as simple as downloading an <a href="https://flathub.org/apps/search/emulator">emulator</a> from Discover catalog.</p>
<p>Here&rsquo;s a photo of someone&rsquo;s collection:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-deck-emulators.jpg" alt="Steam Deck, emulators collection">

<p>Quite impressive.</p>
<h1 id="problems">Problems</h1>
<p>Steam Deck surely has problems, because who doesn&rsquo;t. Almost all of those that I saw myself were software-related (<em>so they can be fixed in later updates</em>), and none of them were serious enough.</p>
<h2 id="gui-issues">GUI issues</h2>
<p>With the GUI being web-based, it&rsquo;s only natural to expect various issues here and there.</p>
<p>For example, here the price label overlaps the country:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/problems/price-overlaps-country.jpg" alt="Steam Deck, web-based GUI, price overlaps country">

<p>Or here the Friends tab has some problems:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/problems/friends-tab-error.jpg" alt="Steam Deck, web-based GUI, Friends tab error, mobx invariant failed">

<p>Here&rsquo;s another error, which I think I got by trying to click on a friend avatar/profile:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/problems/bissubmenu-error.jpg" alt="Steam Deck, web-based GUI, bissubmenu error">

<p>Seemingly related to that, here someone&rsquo;s video about a <a href="https://store.steampowered.com/remoteplay#together">Remote Play Together</a> issue:</p>






<video  controls="yes"   class="video">
    <source src="https://files.decovar.dev/public/blog/steam-deck/remote-play-together-error.mp4" type="video/mp4">
</video>

<p class="video-fallback">If video doesn't play in your browser, you can download it <a href="https://files.decovar.dev/public/blog/steam-deck/remote-play-together-error.mp4">here</a></p>


<p>The Media gallery, where you can view your screenshots, becomes very slow/unresponsive as you scroll it. It slows down and never keeps up, until you exit it and open again. Some really heavy computations are required to scroll a list of pictures, eh.</p>
<p>And there are other minor issues like that.</p>
<h3 id="crash-on-keyboard-shortcut">Crash on keyboard shortcut</h3>
<p>Pressing <code>Ctrl + C</code> keyboard combination can crash the Gamescope:</p>






<video  controls="yes"   class="video">
    <source src="https://files.decovar.dev/public/blog/steam-deck/gamescope-ctrl-c-crash.mp4" type="video/mp4">
</video>

<p class="video-fallback">If video doesn't play in your browser, you can download it <a href="https://files.decovar.dev/public/blog/steam-deck/gamescope-ctrl-c-crash.mp4">here</a></p>


<p>In fact, this happens if you invoke this combination anywhere, it doesn&rsquo;t have to be a focused launch options input field or any other input field, it happens even on the Home screen.</p>
<p>However, after it crashes and boots back, pressing this combination won&rsquo;t cause it to crash anymore:</p>






<video  controls="yes"   class="video">
    <source src="https://files.decovar.dev/public/blog/steam-deck/gamescope-ctrl-c-no-crash.mp4" type="video/mp4">
</video>

<p class="video-fallback">If video doesn't play in your browser, you can download it <a href="https://files.decovar.dev/public/blog/steam-deck/gamescope-ctrl-c-no-crash.mp4">here</a></p>


<p>&hellip;untill you switch to Desktop and back. Then it will happen again.</p>
<p>If you are curious about the keyboard on these videos, it&rsquo;s the <a href="https://amazon.com/Microsoft-Universal-Foldable-Keyboard-Android/dp/B00ZR7POQQ">Microsoft Wireless Universal Foldable Keyboard</a>. Can&rsquo;t say that I would recommend it for using with Steam Deck specifically: it&rsquo;s not a great typing experience, plus I didn&rsquo;t find a way to input F1-F12 keys on it. But it is certainly more convenient for typing than the on-screen virtual keyboard, and it is very mobile/portable.</p>
<h2 id="pin-lock-screen-doesnt-appear-immediately">Pin-lock screen doesn&rsquo;t appear immediately</h2>
<p>The pin-lock screen does not show up immediately after waking up or booting. You have some moments to press/click on stuff before the screen is blocked by the pin prompt.</p>
<p>It is not a very serious issue, because the &ldquo;window of opportunity&rdquo; is rather short, but still, it&rsquo;s not a proper lock-screen then, is it. Plus one might have some a certain type of content being open, which one might not want others to be able to see, but they will be able to, although for a short period of time. Moreover, the sounds from that kind of content will be still heard behind the pin-locking screen, which lowers its usefulness even further.</p>
<h2 id="sd-card-formatting">SD card formatting</h2>
<p>Regularly people are posting about their problems with formatting SD cards on Steam Deck. Sometimes, as owners claim, cards get &ldquo;bricked&rdquo; and are no longer recognized on any other device/OS.</p>
<p>I mean, I believe that SD card can stop working, but I don&rsquo;t know how much Steam Deck&rsquo;s fault is to that. It could be a faulty/fake SD card to begin with, especially looking at how people are hunting for 9000 TB cards on AliExpress for the price of 1.99 USD per kilogram.</p>
<p>With that being said, Valve did ship one or two SteamOS updates that had some fixes exactly related to SD cards formatting.</p>
<p>And I personally have witnessed one issue, although nothing got bricked. When I inserted my brand-new-just-out-of-the-box SD card into my brand-new-just-out-of-the-box Steam Deck and tried to format it in Gaming mode, I got this error:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/problems/sd-card-format-error.jpg" alt="Steam Deck SD card format error">

<p>I tried several times, but result was the same. I then switched to Desktop mode and tried formatting it in <a href="https://apps.kde.org/partitionmanager/">KDE Partition Manager</a>, but that failed too: couldn&rsquo;t re-partition, couldn&rsquo;t do anything. So I got really worried, and was about to try on a different computer, but just in case I rebooted the system and tried again in Gaming mode, and this time it suddenly succeeded, and the card has been working with no issues ever since.</p>
<p>If you do get your SD card messed up, it wouldn&rsquo;t hurt to try to remove all the partitions, create a new one and try to format the card again. Also I often saw people suggesting to try formatting it with <a href="https://sdcard.org/downloads/formatter/">this tool</a>, which might bring it back to life even though every other software failed to recognize it before.</p>
<h2 id="moving-a-game-tofrom-sd-card">Moving a game to/from SD card</h2>
<h3 id="losing-savegames">Losing savegames</h3>
<p>At some point I moved <a href="#doom-3-bfg">DooM 3</a> game to SD card (<em>on Storage tab in Gaming mode</em>), and when I launched it I saw that my savegames were gone. Turns out, due to a bug or something, the moved games can sometimes still expect their prefixes to be on system disk, even though everything (<em>both the game files and its prefix</em>) has been moved to SD card.</p>
<p>It is probably a matter of changing just one line in some of the Steam configs for the game, but I haven&rsquo;t found which one exactly, and so to resolve this problem I had to move the savegames from prefix folder on SD card to prefix folder on system disk. So I manually moved <code>/run/media/mmcblk0p1/steamapps/compatdata/208200/pfx/drive_c/users/steamuser/Saved Games/id Software/DOOM 3 BFG/base</code> to <code>/home/deck/.local/share/Steam/steamapps/compatdata/208200/pfx/drive_c/users/steamuser/Saved Games/id Software/DOOM 3 BFG/base</code>.</p>
<p>I saw people advising to make a symlink for prefix path instead, but some games do use files from prefixes stored on SD cards. Also, I read somewhere about other negative consequences of symlinking prefixes, but I don&rsquo;t remember the details.</p>
<h3 id="content-file-locked">Content file locked</h3>
<p>Sometimes when moving a game to/from SD card in Gaming mode you might get an error saying that &ldquo;<em>content file locked</em>&rdquo;.</p>
<p>I got this problem when I first moved a game (<em>GTA IV</em>) from system disk to SD card and then some weeks later I wanted to play it but discovered that Rockstar launcher (<em>motherfucking piece of shit, I would never buy this game if I knew about it</em>) no longer has my Rockstar (<em>let this awful crap burn in hell</em>) account saved, from which I also concluded that the savegames are gone as well. So I figured it&rsquo;s the same issue as it was with <a href="#losing-savegames">DooM</a>. However, this time instead of moving just the prefix stuff I decided to move the entire game back to system disk, because by then I had more space there.</p>
<p>But the moving operation failed with this &ldquo;<em>content file locked</em>&rdquo; error, and I got curious, how does one move a game manually then, as it should be a trivial file moving operation. And indeed it is, but you need to know what exactly is to be moved. Here are the steps for my case of moving GTA IV (<em>Steam App ID <a href="https://steamdb.info/app/12210/">12210</a></em>) from SD card to system disk:</p>
<ol>
<li>Go to Desktop mode and exit Steam (<em>you can&rsquo;t exit Steam in Gaming mode</em>). This step might not be actually required;</li>
<li>Using any file manager or just bare <code>mv</code> move <code>/run/media/mmcblk0p1/steamapps/common/Grand Theft Auto IV</code> to <code>~/.local/share/Steam/steamapps/common/Grand Theft Auto IV</code>;</li>
<li>Move <code>/run/media/mmcblk0p1/steamapps/compatdata/12210</code> to <code>~/.local/share/Steam/steamapps/compatdata/12210</code>. If there are some files in that folder already, then probably those are what caused the &ldquo;<em>content file locked</em>&rdquo; error in the first place, so remove them (<em>but first back them up somewhere just in case</em>) and then move the folder;</li>
<li>Finally, move <code>/run/media/mmcblk0p1/steamapps/appmanifest_12210.acf</code> to <code>~/.local/share/Steam/steamapps/appmanifest_12210.acf</code>;</li>
<li>Start (<em>restart, if you haven&rsquo;t exited it</em>) Steam.</li>
</ol>
<p>These are probably the same steps that Steam itself performs when you execute this operation in Gaming mode.</p>
<h2 id="on-screen-keyboard-issues">On-screen keyboard issues</h2>
<p>While I haven&rsquo;t experienced any problems with on-screen keyboard in Gaming mode, it does have some problems in Desktop mode.</p>
<p>One problem is that sometimes it doesn&rsquo;t react to trackpads input. I don&rsquo;t remember if it didn&rsquo;t react to other input methods too, I only remember the trackpads and that at least touchscreen input still worked. First time it happened the fix was to switch to Gaming mode, change the keyboard skin to a different one and back, then switch back to Desktop mode, and then it was working. But when this happenned again at some point later, only rebooting the device helped.</p>
<p>Another problem I got is that from time to time it starts to show up on me focusing an input field, which shouldn&rsquo;t happen in Desktop mode. And not just that, it is showing/hiding several times a second, preventing me from doing anything. Fortunately, it calms down after a couple of seconds of this crazy blinking, so I can finally enter some text.</p>
<p>The same behaviour (<em>popping-up on focusing an input field</em>) can also happen in games, and then this would be an overlook by game developers, but <a href="https://steamcommunity.com/app/1675200/discussions/0/3791506319068092908/">here&rsquo;s a post</a> about this happening in Dota (<em>made by the very same Valve</em>), which makes it rather hilarious.</p>
<h2 id="content-servers-unreachable">Content servers unreachable</h2>
<p>Sometimes it can fail to download games or other content from Steam servers:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/problems/not-downloading.jpg" alt="Steam not downloading">

<p>I do have internet connection at that moment: I can browse websites, ping servers, but games downloads in Steam UI fail to start. Tried wired connection, tried Wi-Fi connection, tried rebooting - same result.</p>
<p>After some time the issue goes away on its own and games start downloading, but you cannot influence that in any way. It could&rsquo;ve been related to Steam servers maintenance, but I got this problem on different days of the week, not only on Tuesdays (<em>when Steam has its scheduled maintenance, apparently</em>).</p>
<h2 id="charging-issues">Charging issues</h2>
<h3 id="slow-charger">Slow charger</h3>
<p>One time I connected Steam Deck to a charger and suddenly got this warning about &ldquo;slow charger&rdquo;:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/problems/slow-charger.jpg" alt="Steam Deck, slow charger warning">

<p>I do not remember for sure whether it was an official charger, <a href="#steam-dock">Steam Dock</a>, or some other charger, but it was most certainly a charger that could output enough power, as I simply don&rsquo;t have &ldquo;weak&rdquo; chargers in the house. Either way, the issue went away after I connected it to my <a href="#using-a-powerbank">powerbank</a> for a minute and then connecting back to that charger which it complained about being &ldquo;slow&rdquo;. This time it didn&rsquo;t complain and started charging as usual.</p>
<h3 id="doesnt-start-charging">Doesn&rsquo;t start charging</h3>
<p>Once I plugged it in on <a href="#steam-dock">Steam Dock</a> to charge, and when I returned back an hour later to pick it up and play, I saw that it hasn&rsquo;t charged for a single percent.</p>
<p>I tried re-plugging it, but charging still didn&rsquo;t start, and the charging indicator didn&rsquo;t turn on either. I rebooted the device and replugged again, but it still was not charging, so I got scared quite a bit.</p>
<p>The next thing I was going to try is to put it into a <a href="#battery-storage-mode">battery storage mode</a> for some time, but then I connected it to <a href="#using-a-powerbank">powerbank</a> instead, and then it started charging. I waited for a couple of minutes and re-plugged it back to the dock, and this time it started charging there too.</p>
<p>Don&rsquo;t know what it was and what kind of reviving sorcery does my magic powerbank possess.</p>
<h2 id="low-powered-200400-mhz-mode">Low-powered 200/400 MHz mode</h2>
<p>Apparently, under certain conditions Steam Deck can go into a kind of &ldquo;low-powered&rdquo; mode by limitting the performance of CPU/GPU to 200/400 MHz respectively. Here&rsquo;s a <a href="https://steamcommunity.com/app/1675200/discussions/0/3789254716332237852/">post</a> about that with more links to several other posts on the matter.</p>
<p>Fortunately, I did not get this problem, but it does sound like a very serious one. There (<em>allegedly</em>) was a <a href="https://reddit.com/r/SteamDeck/comments/xvy9fw/rma_outcome_for_decks_with_cpugpu_200mhz400mhz/iur7ncu/">response from Valve</a> in one of the user support tickets where they said that it is because of a &ldquo;<em>bad thermal module</em>&rdquo;, so the problem seems to be of hardware origin, which means that the only solution would be to <a href="https://help.steampowered.com/en/faqs/view/307F-A625-1F33-3247">send the device back to Valve</a> and get a replacement (<em>that would suck total ass in my case, as I live <a href="#how-did-i-get-it">outside</a> of the officially supported regions</em>).</p>
<h2 id="things-you-can-do-to-cause-more-problems">Things you can do to cause more problems</h2>
<p>A list of things I&rsquo;ve seen people doing with their Steam Decks, which you probably shouldn&rsquo;t do with yours.</p>
<p>Software-wise:</p>
<ul>
<li>install <a href="https://github.com/SteamDeckHomebrew/decky-loader">Decky Loader</a>. As if default web-GUI wasn&rsquo;t fragile enough, why not throw-in some more web-based stuff into it and wait until it all break on the next update. Installing even more 3rd/4th-party plugins of unknown origin sounds like a grand idea too;</li>
<li>use <a href="https://github.com/CryoByte33/steam-deck-utilities">CryoUtilities</a> or some other awesome set of optimization tweaks to get that 1% of performance boost in expense of laying a foundation for potential problems that will backfire at some point later. Certainly, some random blokes on the internet know better than Valve and OS maintainers how to optimize the system environment;
<ul>
<li>also, don&rsquo;t forget to report the problems you get because of this to Valve support, they&rsquo;ll be happy to guess what could have caused those;</li>
</ul>
</li>
<li>install a launcher like <a href="https://heroicgameslauncher.com">Heroic</a>, <a href="https://lutris.net">Lutris</a> or some other. Yo dawg, I heard you like launchers, so I put a launcher inside your launcher, so you can launch more launchers while launching a launcher. Even though they don&rsquo;t bring anything actually useful on top of what Steam already provides out of the box. But who wouldn&rsquo;t want to have more web-browsers in their system and to convolute a simple process of launching games even more.</li>
</ul>
<p>And regarding the device itself:</p>
<ul>
<li>replacing default SSD with a different one of higher capacity I&rsquo;ve already <a href="#thermals-and-cooling">talked about</a>. But don&rsquo;t let it stop you;</li>
<li>installing a fancy colorful backplate will highlight how unique you are and as a bonus will probably hurt the thermals of the device;</li>
<li>speaking about thermals, why not follow a brilliant advice from a random expert on the internet and try to optimize the airflow one way or another. Valve engineers for sure must have missed something;</li>
<li>you can also try to use some magnet-based accessories - your fan will be a big fan of that idea.</li>
</ul>
<p>Finally, you can apply skins/stickers on the device body - that will immediately make your Steam Deck look like a cheap whore from the corner. Adding a protection screen will complete the image of a proud owner from rural suburbs, who also keeps his TV remote in a plastic bag. While any of this is unlikely to cause an actual technical problem (<em>unless you&rsquo;ll be smart enough to put a sticker on top of vent-holes</em>), doing stuff like this probably indicates that you might have certain problems in other departments.</p>
<h1 id="steam-dock">Steam Dock</h1>
<p>Steam Deck has just one port - USB-C - and that is absolutely not enough for anything aside from charging, so you will likely want to get a USB hub/dock. Any would work, and Valve itself says so, but there is also an official dock - <a href="https://store.steampowered.com/steamdeckdock">Steam Dock</a>.</p>
<p>I saw some saying that it&rsquo;s a luxury addon or that it is even useless, but I do not think so. It is rather expensive (<em>whooping 89 USD (plus tax)</em>), that much is true, but first of all it includes yet another (<em>the same as the one that comes included with Steam Deck</em>) charger capable of outputting 45 W (<em>check the prices on those</em>), and secondly aside from other ports it has HDMI and Display-Port, while many other docking hubs only have HDMI.</p>
<p>It looks rather simple and has no fixed position for the Steam Deck (<em>and I am not sure if I want it to</em>). The cable going over to top is a bit weird but might be convenient at times when you want to pick it up without disconnecting from charger.</p>
<p>Here are some photos:</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/photos/steam-dock-ports.jpg" alt="Steam Dock ports">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/photos/steam-dock-size.jpg" alt="Steam Dock size">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/photos/steam-dock-top.jpg" alt="Steam Dock top view">

</p>
<p>
    
    
        <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/photos/steam-dock-side.jpg" alt="Steam Dock side view">

</p>
<h2 id="connecting-to-external-display-or-tv">Connecting to external display or TV</h2>
<p>I tried connecting it to a PC display and using Steam Deck as a desktop computer, and that works well:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/steam-deck-docked.jpg" alt="Steam Deck, Steam Dock, external display, keyboard and mouse">

<p>On this photo the Steam Deck is docked with its own mouse/keyboard set and external display, while I am also editing some files on it from my desktop PC via SSH.</p>
<p>The only inconvenience is that I don&rsquo;t have a spare display, so I would need to switch the cables between Steam Dock and my actual desktop PC (<em>when I need it for work</em>). I could probably invest into a <a href="https://en.wikipedia.org/wiki/KVM_switch">KVM switch</a>, but I haven&rsquo;t yet.</p>
<p>I also tried using it on a TV, by my TV isn&rsquo;t very modern, which probably explains why the picture quality was not great: mostly the colors weren&rsquo;t as nice as they are on the Steam Deck&rsquo;s own screen or on my PC display.</p>
<p>Moreover, even though I have a <a href="https://playstation.com/en-us/accessories/dualsense-wireless-controller/">DualSense gamepad</a>, it is so much inferior comparing to Steam Deck in terms of available controls (<em>and the touchpad area is just a fucking disgrace</em>), so I don&rsquo;t see myself playing my games on TV. In particular, <a href="#diablo-ii-resurrected">Diablo II</a> gameplay instantly drops to a handicapped level, and <a href="#heroes-of-might-and-magic-3">HoMM 3</a> and <a href="#space-rangers">Space Rangers</a> I don&rsquo;t even want to talk about. Majestic <a href="#steam-input">Steam Input</a> and fantastic Steam Deck <a href="#controls">controls</a> have spoiled me way too fast, I can&rsquo;t settle for anything even a tiny bit worse.</p>
<p>But for gamepad-supported / console-oriented games, where I don&rsquo;t really need such advanced controls, the DualSense gamepad should be enough to enjoy playing on TV. I only need to get a better TV.</p>
<h1 id="showcasing-steam-deck-on-your-steam-profile">Showcasing Steam Deck on your Steam profile</h1>
<p>If you&rsquo;d like to showcase Steam Deck as a favorite game on your Steam profile page, you&rsquo;ll be frustrated to discover that you can&rsquo;t to select it from the list of games in the showcase widget. But Valve has left a little loophole (<em>might be unintentionally</em>) by not verifying client input on the backend, so it is still possible to do.</p>
<p>All the credits go to <a href="https://steamcommunity.com/app/1675200/discussions/0/3823032344633204186/">this thread</a>, I&rsquo;m only re-posting the recipe here.</p>
<p>Open your Steam profile page, go to Edit Profile and there to Featured Showcase tab. Add a Favorite Game showcase. Open Web Developer Tools or equivalent in your web-browser, go to Debugger tab, open <code>global.js</code> script and set a breakpoint on the line <code>CGameSelectorOwnedGames.NormalizeGameNames</code> in <code>onSuccess</code> handler of <code>Ajax.Request('https://steamcommunity.com/actions/GetOwnedApps/'</code>.</p>
<p>Click on the showcase widget to select a game for showcasing:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/profile-favorite-game/edit-showcase-favorite-game.png" alt="Steam profile, selecting a game for showcasing">

<p>The script execution should stop on that breakpoint:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/profile-favorite-game/firefox-debugger-steam-profile.png" alt="Firefox debugger breakpoint on Steam profile page script" style="border:1px solid black;">

<p>Now go to Console tab and execute:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">CGameSelectorOwnedGames</span>.<span style="color:#a6e22e">s_rgOwnedGames</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;appid&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1675200</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Steam Deck&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;icon&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://cdn.akamai.steamstatic.com/steamcommunity/public/images/apps/1675200/21a29a1fa319b6f186ff91a647bea354a09fe51e.jpg&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;logo&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://cdn.akamai.steamstatic.com/steam/apps/1675200/capsule_184x69.jpg&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>];</span></span></code></pre></div>
<p>That operation will replace the contents of <code>s_rgOwnedGames</code> list with just one item - <code>Steam Deck</code>. If anything, setting a different picture for <code>logo</code> (<em>such as <a href="https://store.cloudflare.steamstatic.com/public/images/steamdeck/steamdeck_promo_01.png">this one</a></em>) won&rsquo;t persist, as it seems that no properties actually matter except for the <code>appid</code>.</p>
<p>Go back to Debugger tab and resume the script execution. Click on search input field in the showcase and start typing <code>Steam Deck</code> (<em>it will be the only item to find in the list</em>). Select it and save your profile. The result will look like this:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/profile-favorite-game/steam-deck-favorite-game.png" alt="Steam Deck as a favorite game on Steam profile page">

<h1 id="overall">Overall</h1>
<p>Never have I ever been so happy about getting something. It&rsquo;s a pure joy every single day.</p>
<p>For the last several years I&rsquo;ve been playing on my desktop gaming PC about 1.5 hours a day, and it was mostly Dota and only occasionally some other games. Since I got Steam Deck, I haven&rsquo;t played on my PC at all, my average gaming time per day is now about 3-4 hours (<em>that&rsquo;s actually not a good thing</em>), and the variety of games I&rsquo;m playing got much wider (<em>my Steam wishlist got longer too</em>).</p>
<!--My neighbours started to say hello to me, I got a promotion at work, and Elizabeth Olsen wrote me a love letter.-->
<p>All my favorite games launch and run on Steam Deck with no problems, while 95% of them are Windows-only games. What sorcery is this. And modern games that I&rsquo;ve tried out so far run with better performance than on my desktop PC.</p>
<p>The feeling of freedom is incredible. You can install Steam games, you can install games that you purchased in other stores, you can pirate games and still launch them without problems. You can download and install whatever applications you&rsquo;d like and you can fucking build stuff from sources right on the device. It&rsquo;s a proper PC that is actually yours. To quote <a href="https://techspot.com/article/2620-steam-deck-pc-gaming-moment/#Open_Ecosystem_Massive_Game">one article</a>:</p>
<blockquote>In a time when closed gardens are being built all around us, it's so refreshing to see a large company pushing for an open approach to its ecosystem.</blockquote>
<p>Amen and hallelujah.</p>
<p>So money can in fact buy happiness! And it&rsquo;s not very expensive either - just 649/399 USD (<em>plus taxes (plus SD-card (and plus docking station (and probably plus powerbank)))</em>).</p>
<p>But Valve should really try to cover more countries/regions. Of course, they have all the sales numbers, so they like no one else know about the actual demand (<em>in supported countries</em>), but I still think they might be underestimating how badly people want to buy it:</p>


    <img class="image-post" loading="lazy" src="/blog/2023/04/10/steam-deck/images/fry-money.png" alt="Fry, shut up and take my money">
      </div>
    </article>
    <div><div id="tags">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line>
</svg>
          <a class="tag" href="https://retifrav.github.io/tags/steam-deck/">steam-deck</a><a class="tag" href="https://retifrav.github.io/tags/review/">review</a><a class="tag" href="https://retifrav.github.io/tags/games/">games</a><a class="tag" href="https://retifrav.github.io/tags/linux/">linux</a><a class="tag" href="https://retifrav.github.io/tags/piracy/">piracy</a></div><hr class="comments-divider"/>
      <div id="comments">
      
          <div style="border:2px orange solid; background-color: floralwhite; border-radius:0.5rem; padding: 10px 14px; font-style:italic; font-size:0.9em;">
              If you'd like to comment the article, you can do it on the
              <a href="https://decovar.dev/blog/2023/04/10/steam-deck/#remark42" style="font-weight:bold;">
                  original website</a>. This one is just a mirror without comments.
          </div>
      
      </div>
    </div>
  </div>

        <div id="footer">
          <div>
              2014 - 2023,
              <a href="/about/">retif</a>
          </div>
          <div><a href="/about/#licenses">CC BY-SA 4.0 / GPLv3</a></div>
        </div>
      </main>
      <div class="app-header">
        <div style="margin:0 0 20px;">
            <input id="search-query" placeholder="Search in titles and summaries" />
        </div>
        <div id="search-results" style="display:none;"></div>
        <div id="sidebars">
            <a id="avatar" href="/about"><img class="app-header-avatar" src="/images/avatar.png" /></a>
            <iframe src="https://github.com/sponsors/retifrav/button"
                height="35" style="border:0;"
                title="You can sponsor me">
            </iframe>
            
            <div class="sidebar-section">
              <h3>Feeds</h3>
              <a href="/index.xml" title="Subscribe to RSS"><img src="/images/rss.png" width="50px"></a>
              <a style="margin-left: 5px;" href="https://t.me/decovar" title="Telegram channel"><img src="/images/telegram.png" width="50px"></a>
            </div>
            <div id="telegramWidgetBlock" class="sidebar-section"></div>
            <div class="sidebar-section">
                <h3>Stuff</h3>
                <ul class="sidebar-list">
                    <li><a href="/stuff/kakoi-jvotne-vi-kysaiti/index.html">КАКОИ ЖВОТНЕ ВЫ КУСАИТИ?</a></li>
                </ul>
            </div>
            <div id="social-networks" class="sidebar-section">
              <h3>Social networks</h3>
              <div style="font-family:Courier New;">
                  Zuck: <i>Yeah so if you ever need info about anyone at Harvard</i><br/>
                  Zuck: <i>Just ask</i><br/>
                  Zuck: <i>I have over 4,000 emails, pictures, addresses, SNS</i><br/>
                  smb: <i>What? How'd you manage that one?</i><br/>
                  Zuck: <i>People just submitted it.</i><br/>
                  Zuck: <i>I don't know why.</i><br/>
                  Zuck: <i>They "trust me"</i><br/>
                  Zuck: <i>Dumb fucks</i>
              </div>
            </div>
            <div class="sidebar-section">
              <h3>Tags</h3>
              <ul style="list-style-type:none; padding:0; margin:0;">
                  
                  <li><a href="/tags/web">web (65)</a></li>
                  
                  <li><a href="/tags/fail">fail (39)</a></li>
                  
                  <li><a href="/tags/dotnet">dotnet (36)</a></li>
                  
                  <li><a href="/tags/qt">qt (35)</a></li>
                  
                  <li><a href="/tags/review">review (28)</a></li>
                  
                  <li><a href="/tags/linux">linux (27)</a></li>
                  
                  <li><a href="/tags/devops">devops (23)</a></li>
                  
                  <li><a href="/tags/macos">macos (23)</a></li>
                  
                  <li><a href="/tags/windows">windows (19)</a></li>
                  
                  <li><a href="/tags/mestuff">mestuff (17)</a></li>
                  
                  <li><a href="/tags/movies">movies (15)</a></li>
                  
                  <li><a href="/tags/tractor">tractor (15)</a></li>
                  
                  <li><a href="/tags/norway">norway (14)</a></li>
                  
                  <li><a href="/tags/irl">irl (12)</a></li>
                  
                  <li><a href="/tags/python">python (12)</a></li>
                  
                  <li><a href="/tags/telegram">telegram (12)</a></li>
                  
                  <li><a href="/tags/embedded">embedded (11)</a></li>
                  
                  <li><a href="/tags/cpp">cpp (10)</a></li>
                  
                  <li><a href="/tags/soft">soft (10)</a></li>
                  
                  <li><a href="/tags/travel">travel (10)</a></li>
                  
                  <li><a href="/tags/applescript">applescript (9)</a></li>
                  
                  <li><a href="/tags/cmake">cmake (9)</a></li>
                  
                  <li><a href="/tags/piracy">piracy (9)</a></li>
                  
                  <li><a href="/tags/octopress">octopress (8)</a></li>
                  
                  <li><a href="/tags/banks">banks (7)</a></li>
                  
                  <li><a href="/tags/games">games (7)</a></li>
                  
                  <li><a href="/tags/ios">ios (7)</a></li>
                  
                  <li><a href="/tags/apple">apple (6)</a></li>
                  
                  <li><a href="/tags/javascript">javascript (6)</a></li>
                  
                  <li><a href="/tags/photo">photo (6)</a></li>
                  
                  <li><a href="/tags/sql">sql (6)</a></li>
                  
                  <li><a href="/tags/russia">russia (5)</a></li>
                  
                  <li><a href="/tags/hugo">hugo (4)</a></li>
                  
                  <li><a href="/tags/usa">usa (4)</a></li>
                  
                  <li><a href="/tags/wordpress">wordpress (4)</a></li>
                  
                  <li><a href="/tags/android">android (3)</a></li>
                  
                  <li><a href="/tags/azure">azure (3)</a></li>
                  
                  <li><a href="/tags/tv">tv (3)</a></li>
                  
                  <li><a href="/tags/privacy">privacy (2)</a></li>
                  
                  <li><a href="/tags/steam-deck">steam-deck (2)</a></li>
                  
                  <li><a href="/tags/tvos">tvos (2)</a></li>
                  
                  <li><a href="/tags/unsolved">unsolved (2)</a></li>
                  
                  <li><a href="/tags/books">books (1)</a></li>
                  
                  <li><a href="/tags/ffmpeg">ffmpeg (1)</a></li>
                  
                  <li><a href="/tags/ldap">ldap (1)</a></li>
                  
                  <li><a href="/tags/music">music (1)</a></li>
                  
                  <li><a href="/tags/science">science (1)</a></li>
                  
                  <li><a href="/tags/vr">vr (1)</a></li>
                  
              </ul>
            </div>
        </div>
      </header>
    </div>

    <script src="/js/search.js"></script>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-53340325-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag("js", new Date());
      gtag("config", "UA-53340325-1");
    </script>

    <script>
        const telegramBlock = document.getElementById("telegramWidgetBlock");
        window.onload = () =>
        {
            const pinnedTelegramPosts = [277,279,306,312,319]
            const randomedPostID = pinnedTelegramPosts[
                Math.floor(Math.random() * pinnedTelegramPosts.length)
            ];
            const telegramWidgetScript = document.createElement("script");
            telegramWidgetScript.src = "https://telegram.org/js/telegram-widget.js?21";
            telegramWidgetScript.dataset["telegramPost"] = `decovar/${randomedPostID}`;
            telegramWidgetScript.dataset["color"] = "1E8448";
            telegramWidgetScript.dataset["width"] = "100%";
            telegramWidgetScript.dataset["userpic"] = "false";
            telegramBlock.appendChild(telegramWidgetScript);
        }
    </script>

    
    
  </body>
</html>
